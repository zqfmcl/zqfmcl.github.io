<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Fey's blog" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="Fey&#39;s blog">
<meta property="og:url" content="https://zqfmcl.github.io/dialy/page/12/index.html">
<meta property="og:site_name" content="Fey&#39;s blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fey&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zqfmcl.github.io/dialy/page/12/">





  <title>Fey's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fey's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Module-NodeJs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Module-NodeJs/" itemprop="url">Module-NodeJs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

<ul>
<li><a href="#module">module</a><ul>
<li><a href="#模块简介">模块简介</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1 id="module"><a href="#module" class="headerlink" title="module"></a>module</h1><h2 id="模块简介"><a href="#模块简介" class="headerlink" title="模块简介"></a>模块简介</h2><ul>
<li>1.首先按照加载的模块的文件名称进行查找</li>
<li>2.如果没有找到，则会在模块文件名称后加上.js的后缀，进行查找</li>
<li>3.如果还没有找到，则会在文件名称后加上.json的后缀，进行查找</li>
<li>4.如果还没有，则会在文件名称后加上.node的后缀，进行查找</li>
</ul>
<blockquote>
<p>文件名称 -&gt; .js -&gt; .json -&gt; .node</p>
</blockquote>
<p>所有的exports收集到的属性和方法，都赋值给了<code>module.exports</code>。当然，这有个前提，就是<code>module.exports</code>本身不具备<strong>相同</strong>属性和方法。如果，<code>module.exports</code>已经具备一些属性和方法，那么exports收集来的<strong>相同</strong>信息将被忽略。</p>
<p>Nodejs加载模块</p>
<pre><code class="js">//导出函数
exports.a = function() {
    console.log();
};

//导出变量
exports.b=10;
</code></pre>
<ul>
<li>在模块中定义的变量，其作用域范围是当前模块，外部不能够直接的访问</li>
<li>如果我们想一个模块能够访问另外一个模块中定义的变量，可以：<ul>
<li>1.把变量作为global对象的一个属性，但是这样的做法是推荐</li>
<li>2.使用模块对象 module</li>
</ul>
</li>
</ul>
<pre><code class="js">//使用`global`定义的是全局模块，
global.a = 200;</code></pre>
<p><code>exports</code>是<code>module.exports</code>的引用。</p>
<p>可以使用<code>exports.xxx</code>或者<code>module.exports.xxx</code>写入变量或者函数方法等。</p>
<p>不能有<code>module.exports=xxx</code>，这样<code>module.exports</code>与<code>exports</code>的关系就会断开。</p>
<p><code>exports</code>错误引用</p>
<pre><code class="js">//bar.js
console.log( module.exports === exports );
var bar = function(){
    console.log(‘it is bar’);
};
console.log( module.exports === exports );
exports = bar;
console.log( module.exports === exports );
//output
//true
//true
//false


//use-bar.js
var bar = require(‘./bar.js’);
bar();  //这个会报错：TypeError: object is not a function
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Merge-Two-Sorted-Lists/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Merge-Two-Sorted-Lists/" itemprop="url">Merge Two Sorted Lists</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>Merge Two Sorted Lists  </li>
</ol>
<hr>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>Merge two sorted linked lists and return it as a new list. </p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>这个题目很简单也有几个可以考虑的思路，一个是比较直接的方式，重新构造链表，一种是利用递归</p>
<h1 id="思路1-：用新的链表"><a href="#思路1-：用新的链表" class="headerlink" title="思路1 ：用新的链表"></a>思路1 ：用新的链表</h1><p>这里用了一个新的节点了保存结果的链表，这里为了方便链表的扩充，增加一个临时的节点变量（否则每次加入都要遍历到尾部）</p>
<pre><code class="java">public class Solution {
    public ListNode mergeTwoLists(ListNode l1, ListNode l2) {
        ListNode result = new ListNode(0);
        ListNode tmp = result;
        while(l1 != null || l2 != null)
        {
            if(l2 == null || (l1 != null &amp;&amp; l1.val &lt;= l2.val))
            {
                tmp.next = l1;
                l1 = l1.next;
            }
            else 
            {
                tmp.next = l2;
                l2 = l2.next;
            }
            tmp = tmp.next;
        }
        return result.next;
    }
}
</code></pre>
<h1 id="思路2：递归方案"><a href="#思路2：递归方案" class="headerlink" title="思路2：递归方案"></a>思路2：递归方案</h1><p>在很多时候，递归的方案可以提供一种清晰简单的解决方案，代码也更精炼。但是递归有个问题就是容易出现堆栈溢出的问题。</p>
<pre><code class="java">public:
    ListNode *mergeTwoLists(ListNode *l1, ListNode *l2) {
        if(l1 == NULL) return l2;
        if(l2 == NULL) return l1;

        if(l1-&gt;val &lt; l2-&gt;val) {
            l1-&gt;next = mergeTwoLists(l1-&gt;next, l2);
            return l1;
        } else {
            l2-&gt;next = mergeTwoLists(l2-&gt;next, l1);
            return l2;
        }
    }
};
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Merge-k-Sorted-Lists-[H]/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Merge-k-Sorted-Lists-[H]/" itemprop="url">Merge k Sorted Lists [H]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>Merge k Sorted Lists [H]</li>
</ol>
<hr>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>Merge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p>
<p>Subscribe to see which companies asked this question</p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>这题明显就是Merge two sorted list的升级版，我们知道，那题我们可以用2个指针完成，但是这题，难道要用K个指针？</p>
<p>思路1：每次循环K下，找到每个链表的头，然后把最小的插入新链表中，把这个链表头弃掉，然后重复这个操作。这个最多需要循环K<em>K</em>n次</p>
<p>思路2：二路归并，每次合并两个链表最多合并$log_2N$次</p>
<p>流程：</p>
<ul>
<li>先每隔2个合并，结果放到合并的第一个链表处</li>
<li>再每隔4个合并，结果放到合并的第一个链表处<br>……</li>
<li>每隔K/2个合并，结果放到合并的第一个链表处</li>
<li>返回第一个链表</li>
</ul>
<pre><code class="java">//控制每隔多少
 for(int step = 1;step &lt; lists.length;step*=2)
//遍历所有可以合并的选项
    for(int i = 0;i &lt; lists.length;i+=step*2)</code></pre>
<p>假设K= 4：（偶数相对好处理）</p>
<ul>
<li>先合并L[0],L[1]放到L[0]</li>
<li>然后合并L[2],L[3]放到L[2]</li>
<li>最后合并L[0],L[2]放到L[0]</li>
<li>返回L[0]就好了<br><img src="C:/Users/Administrator/Desktop/leetbook-master/%E9%93%BE%E8%A1%A8/023.%20Merge%20k%20Sorted%20Lists%20%5BH%5D/1463149197129.png" alt="Alt text"></li>
</ul>
<p>假设K=5：(麻烦点，当运行到L[4]的时候它没有下个可以和它合并的元素了，所以应该跳出循环)<br><img src="C:/Users/Administrator/Desktop/leetbook-master/%E9%93%BE%E8%A1%A8/023.%20Merge%20k%20Sorted%20Lists%20%5BH%5D/1463149101056.png" alt="Alt text"></p>
<pre><code class="java">//控制每隔多少
 for(int step = 1;step &lt; lists.length;step*=2)
//遍历所有可以合并的选项
    for(int i = 0;i &lt; lists.length;i+=step*2)
    {
        //如果某个元素没有下一个元素就退出循环
         if(i+step &gt;= lists.length) break;
         lists[i] = mergeTwoLists(lists[i],lists[i+step]);
    }</code></pre>
<p>所以代码涉及2层循环，外面是控制每隔多少合并一次，里面是遍历所有可以合并的链表，进行合并操作。</p>
<pre><code class="java"> public ListNode mergeKLists(ListNode[] lists) {
        if(lists.length == 0)
            return null;
        //控制每隔多少
        for(int step = 1;step &lt; lists.length;step*=2)
            //遍历所有可以合并的选项
            for(int i = 0;i &lt; lists.length;i+=step*2)
            {
                //如果某个元素没有下一个元素就退出循环
                if(i+step &gt;= lists.length) break;
                lists[i] = mergeTwoLists(lists[i],lists[i+step]);
            }
        return lists[0];
    }
    //完全是之前的代码
    public ListNode mergeTwoLists(ListNode l1, ListNode l2) {
        ListNode result = new ListNode(0);
        ListNode tmp = result;
        while(l1 != null || l2 != null)
        {
            if(l2 == null || (l1 != null &amp;&amp; l1.val &lt;= l2.val))
            {
                tmp.next = l1;
                l1 = l1.next;
            }
            else 
            {
                tmp.next = l2;
                l2 = l2.next;
            }
            tmp = tmp.next;
        }
        return result.next;
    }
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Mongoose/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Mongoose/" itemprop="url">Mongoose</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

<ul>
<li><a href="#mongoose">Mongoose</a><ul>
<li><a href="#使用mongoose连接数据库">使用mongoose连接数据库</a></li>
<li><a href="#schema">Schema</a></li>
<li><a href="#model">model</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1 id="Mongoose"><a href="#Mongoose" class="headerlink" title="Mongoose"></a>Mongoose</h1><p>关系型数据库使用<code>表</code>来存储数据，使用<code>行</code>来组织，一个表内有多个行。想获取数据，要使用SQL语言查询。<br>MongoDB是非关系型(NOSQL)数据库，也叫文档数据库，没有关系型数据库中<code>表</code>与<code>行</code>的概念，类似的只有<code>集合</code>与<code>文档</code>的概念。<br><code>集合</code>与<code>表</code>、<code>文档</code>与<code>行</code>有点类似。</p>
<h2 id="使用mongoose连接数据库"><a href="#使用mongoose连接数据库" class="headerlink" title="使用mongoose连接数据库"></a>使用mongoose连接数据库</h2><pre><code class="js">var mongoose=require(&#39;mongoose&#39;),
db_url=&#39;mongodb://localhost:12345/dbCol&#39;;
//dbCol是一个数据库名称

mongoose.connect(db_url);

mongoose.connection.on(&#39;connected&#39;,function(){
    console.log(&#39;mongoose connection open to &#39;+ db_url);
});
//除了connected事件，还有error、disconnected
</code></pre>
<h2 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h2><p>一种以文件形式存储的数据库模型骨架，无法直接通往数据库端，也就是说它不具备对数据库的操作能力.<br>每一个<code>schema</code>会映射到<code>mongodb</code>当中的<code>collection</code>。</p>
<pre><code class="js">//定义一个Schema

SchemaGo=mongoose.Schema;
//新建一个schema实例对象
var UserSchema=new SchemaGo({
    username:{type:String},
    userpwd:{type:String},
    userage:{type:Number},
    logindate:{type:Date},
});</code></pre>
<p>schema中的数据类型</p>
<ul>
<li>String</li>
<li>Number</li>
<li>Date</li>
<li>Boolean</li>
<li>Buffer</li>
<li>ObjectId</li>
<li>Mixed</li>
<li>Array</li>
</ul>
<h2 id="model"><a href="#model" class="headerlink" title="model"></a>model</h2><p><code>model</code>是由<code>schema</code>生成的模型，可以对数据库的操作。</p>
<pre><code class="js">//model

var UserDo= mongoose.model(&#39;UserBo&#39;,UserSchema);
//UserBo为Model的名字，也是数据库中collection的名字，UserSchema为生成Model所需要的schema,Model就像是schema所编译而成的一样。

var user = new UserDo({
    username : &#39;niefee&#39;,
    userpwd:&#39;adsf&#39;,
    userage:24,
    logindate : new Date()
});

//保存数据
user.save(function(err,res){
    if(err){
        console.log(&#39;err&gt;&gt;&gt;&#39;,err);
    }else{
        console.log(&#39;res&gt;&gt;&#39;,res);
    }
});
</code></pre>
<blockquote>
<p><a href="http://www.cnblogs.com/zhongweiv/p/mongoose.html" target="_blank" rel="noopener">参考</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-MongoDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-MongoDB/" itemprop="url">MongoDB</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

<ul>
<li><a href="#mongodb">MongoDB</a><ul>
<li><a href="#mongodb安装">MongoDB安装</a><ul>
<li><a href="#1-下载最新版本">1. 下载最新版本</a></li>
<li><a href="#2-将mongodb添加到环境变量中">2. 将MongoDB添加到环境变量中</a></li>
<li><a href="#3-启动数据库服务器">3. 启动数据库服务器</a><ul>
<li><a href="#命令行启动">命令行启动</a></li>
<li><a href="#配置文件启动">配置文件启动</a></li>
</ul>
</li>
<li><a href="#4-连接到mongodb服务器">4. 连接到mongoDB服务器</a></li>
<li><a href="#5-关闭服务器">5. 关闭服务器</a></li>
</ul>
</li>
<li><a href="#使用数据库">使用数据库</a></li>
<li><a href="#更新操作数据">更新操作数据</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h1><h2 id="MongoDB安装"><a href="#MongoDB安装" class="headerlink" title="MongoDB安装"></a>MongoDB安装</h2><p><strong>MAC平台下：</strong></p>
<h3 id="1-下载最新版本"><a href="#1-下载最新版本" class="headerlink" title="1. 下载最新版本"></a>1. 下载最新版本</h3><p>地址：<a href="https://www.mongodb.com/download-center" target="_blank" rel="noopener">https://www.mongodb.com/download-center</a></p>
<h3 id="2-将MongoDB添加到环境变量中"><a href="#2-将MongoDB添加到环境变量中" class="headerlink" title="2. 将MongoDB添加到环境变量中"></a>2. 将MongoDB添加到环境变量中</h3><pre><code class="bash">##mongod config
#vim ~/.bash_profile

export PATH=/Users/**/mongodb/bin:$PATH

## 然后使命令生效

source ~/.bash_profile。</code></pre>
<p>添加了系统环境变量，以后就不用使用<code>./bin/mongod</code>调用文件了，直接使用<code>mongo</code>就行了。</p>
<h3 id="3-启动数据库服务器"><a href="#3-启动数据库服务器" class="headerlink" title="3. 启动数据库服务器"></a>3. 启动数据库服务器</h3><h4 id="命令行启动"><a href="#命令行启动" class="headerlink" title="命令行启动"></a>命令行启动</h4><p>先要给目录设置权限</p>
<pre><code class="bash">cd ~/**/data
sudo chown -R  userName data</code></pre>
<pre><code class="bash">mongod --dbpath=db --port=27018 --logpath=log/mongod.log

--dbpath=data
##数据库文件路径

--logpath=log/mongod.log
##日志文件的路径

--logappend
##以追加啊的方式打开文件

--fork=true
##将数据库文件放到后台运行

--port=1234
##启动的端口</code></pre>
<h4 id="配置文件启动"><a href="#配置文件启动" class="headerlink" title="配置文件启动"></a>配置文件启动</h4><ul>
<li>在mongoDB文件夹里新建了三个文件夹data、log、conf</li>
<li>在conf新建配置文件mongod.conf：</li>
</ul>
<pre><code class="bash">##启动的端口
port =12345

##存放数据文件的文件夹
dbpath =data

##存放打印日志文件的文件夹
logpath =log/mongod.log

##Linux为后台进程
fork =true</code></pre>
<ul>
<li>启动服务</li>
</ul>
<pre><code class="bash">##启动mongodb服务端
##mongod.conf 为配置文件
./bin/mongod -f conf/mongod.conf</code></pre>
<blockquote>
<p>mongod是用来启动服务器</p>
</blockquote>
<h3 id="4-连接到mongoDB服务器"><a href="#4-连接到mongoDB服务器" class="headerlink" title="4. 连接到mongoDB服务器"></a>4. 连接到mongoDB服务器</h3><pre><code class="bash">##连接到mongoDB服务器
./bin/mongo 127.0.0.1:12345/test</code></pre>
<blockquote>
<p>mongo编译后是客户端</p>
</blockquote>
<h3 id="5-关闭服务器"><a href="#5-关闭服务器" class="headerlink" title="5. 关闭服务器"></a>5. 关闭服务器</h3><pre><code class="bash">use admin

db.shutdownServer();
</code></pre>
<blockquote>
<p><a href="http://www.cnblogs.com/wx1993/p/5187530.html" target="_blank" rel="noopener">参考</a></p>
</blockquote>
<h2 id="使用数据库"><a href="#使用数据库" class="headerlink" title="使用数据库"></a>使用数据库</h2><pre><code class="bash"># 查看数据库
&gt; show dbs
admin   0.000GB
local   0.000GB

# 查看表（集合）
&gt; show tables

# 删除集合
&gt; db.userDB.drop()

# 选择数据库
## 如果没有这个数据库，会自动创建
&gt;use userDB
switched to db userDB

# 删除数据库
&gt; db.dropDatabase()
{&quot;dropped&quot; : &quot;userDB&quot;,&quot;ok&quot; : 1}

# 在一个集合中插入数据，没有这个集合的话会自动创建
&gt; db.useDB.insert({x:1})

# 查看集合
&gt;show collections

# 查看信息
&gt; db.userDB.find()
&gt; db.userDB.find({x:1})

# 集合中数据数量
&gt; db.userDB.find().count()

# 跳过数据、返回一定数量的数据
&gt; db.userDB.find().skip(1).limit(2)

# 排序

升序：
&gt; db.userInfo.find().sort({age: 1});

降序：
&gt; db.userInfo.find().sort({age: -1});</code></pre>
<h2 id="更新操作数据"><a href="#更新操作数据" class="headerlink" title="更新操作数据"></a>更新操作数据</h2><pre><code class="bash"># 更新数据，默认是查找到的第一条
&gt; db.userDB.update({BB:&#39;hei boy&#39;},{BB:&#39;gogo&#39;})
## 如果要更新所有，要用set更新
&gt; db.userDB.update({BB:&#39;hei boy&#39;},{$set:{BB:&#39;gogo&#39;}},false,true)
# 第一个参数是如果不存在，是否插入objNew,true为插入，默认是false，不插入。

# 第二个参数是是否操作所有数据，默认是false，非全部。

# 部分更新
{ &quot;_id&quot; : ObjectId(&quot;5897240d591dd248739bea53&quot;), &quot;x&quot; : 100, &quot;y&quot; : 100, &quot;z&quot; : 100 }

# {z:100}是查找这条数据的索引，后面是要更新的数据
&gt; db.userDB.update({z:100},{$set:{y:999}})

# 更新不存在的数据时，第三个参数为true时会自动创建一条数据
&gt; db.userDB.update({z:100},{z:99},true)

# 删除数据
## 会删除所有，不止第一条
&gt; db.userDB.remove({z:100})
</code></pre>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Mysql2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Mysql2/" itemprop="url">Mysql</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

<ul>
<li><a href="#深入浅出mysql">深入浅出MySQL</a><ul>
<li><a href="#数据库相关操作">数据库相关操作</a></li>
<li><a href="#数据表">数据表</a></li>
<li><a href="#数据操作">数据操作</a></li>
<li><a href="#事物处理">事物处理</a><ul>
<li><a href="#事务条件">事务条件</a></li>
<li><a href="#事务控制语句">事务控制语句</a></li>
<li><a href="#事务顺序">事务顺序</a></li>
<li><a href="#事务隔离级别">事务隔离级别</a></li>
<li><a href="#脏读-幻读-不可重复读">脏读、幻读、不可重复读</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /code_chunk_output -->

<h1 id="深入浅出MySQL"><a href="#深入浅出MySQL" class="headerlink" title="深入浅出MySQL"></a>深入浅出MySQL</h1><h2 id="数据库相关操作"><a href="#数据库相关操作" class="headerlink" title="数据库相关操作"></a>数据库相关操作</h2><p>使用MySQL关键字，要使用反引号.</p>
<pre><code class="sql">CREATE DATABASE `database`;</code></pre>
<p>查看已有数据库</p>
<pre><code class="sql">SHOW SCHEMAS;
-- 或
SHOW DATABASE;</code></pre>
<p>查看警告</p>
<pre><code class="sql">SHOW WARNINGS;</code></pre>
<p>指定数据库编码方式</p>
<pre><code class="sql">CREATE DATABASE IF NOT EXISTS db1 DEFAULT CHARACTER SET = &#39;UTF8&#39;;</code></pre>
<p>查看数据库详细信息</p>
<pre><code class="sql">SHOW CREATE DATABASE db1;</code></pre>
<h2 id="数据表"><a href="#数据表" class="headerlink" title="数据表"></a>数据表</h2><p>查看表结构</p>
<pre><code class="sql">DESC tbl_name;

DESCRIBE tbl_name;

SHOW COLUMNS FROM tbl_name;</code></pre>
<p>修改数据编码方式</p>
<pre><code class="sql">ALTER DATABASE db1 [DEFAULT] CHARACTERS SET [=] charset;</code></pre>
<p>添加字段</p>
<pre><code class="sql">ALTER TABLE tbl_name 
ADD 字段名称 字段属性 [完整性约束条件] [FIRST|AFTER 字段名称]

-- eg
ALTER TABLE user1
ADD username VARCHAR(20);</code></pre>
<p>删除字段</p>
<pre><code class="sql">ALTER TABLE tbl_name
DROP 字段名称

-- eg
ALTER TABLE user1
DROP test;</code></pre>
<p>添加默认值</p>
<pre><code class="sql">ALTER TABLE tbl_name
ALTER 字段名称 SET DEFAULT 默认值;

-- eg
ALTER TABLE user2
ALTER email SET DEFAULT &#39;aa@qq.com&#39;;</code></pre>
<p>删除默认值</p>
<pre><code class="sql">ALTER TABLE tbl_name
ALTER 字段名称 DROP DEFAULT

-- eg
ALTER TABLE user ALTER age DROP DEFAULT;</code></pre>
<p>修改字段名、字段类型、字段属性</p>
<pre><code class="sql">ALTER TABLE tbl_name
MODIFY 字段名称 字段类型 [字段属性] [FIRST | AFTER 字段名称]

-- 或者
ALTER TABLE tbl_name
CHANGE 原字段名称 新字段名称 字段类型 字段属性 [FIRST | AFTER 字段名称]</code></pre>
<p>添加主键</p>
<pre><code class="sql">ALTER TABLE tbl_name
ADD PRIMARY KEY(字段名称)

-- eg
ALTER TABLE user ADD PRIMARY KEY(id);</code></pre>
<p>删除主键</p>
<pre><code class="sql">ALTER TABLE tbl_name
DROP PRIMARY KEY;</code></pre>
<p>添加唯一主键</p>
<pre><code class="sql">ALTER TABLE tbl_name
ADD UNIQUE KEY|INDEX [index_name] (字段名称)</code></pre>
<p>删除唯一主键</p>
<pre><code class="sql">ALTER TABLE tbl DROP index_name;

-- eg
ALTER TABLE user DROP INDEX username;</code></pre>
<p>修改表名</p>
<pre><code class="sql">ALTER TABLE tbl_name 
RENAME [TO|AS] new_tbl_name
-- 或
RENAME TABLE tbl_name TO new_tbl_name;</code></pre>
<p>重置自动增长的初始值</p>
<pre><code class="sql">-- 要清空数据才会发挥作用
ALTER TABLE tbl_name AUTO_INCREMENT=值</code></pre>
<h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><p>查询数据</p>
<pre><code class="sql">SELECT select_expr,... FROM tbl_name
[WHERE 条件]
[GROUP BY {col_name|position} HAVING 二次筛选]
[ORDER BY {col_name|position|expr} [ASC|DESC]]
[LIMIT 限制结果集的显示条数]</code></pre>
<h2 id="事物处理"><a href="#事物处理" class="headerlink" title="事物处理"></a>事物处理</h2><h3 id="事务条件"><a href="#事务条件" class="headerlink" title="事务条件"></a>事务条件</h3><ul>
<li><strong>原子性：</strong> 一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。</li>
<li><strong>一致性：</strong>在事务开始之前和事务结束以后，数据库的完整性没有被破坏。</li>
<li><strong>隔离性：</strong>数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。</li>
<li><strong>持久性：</strong>事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。</li>
</ul>
<blockquote>
<p>可以接受事务的引擎中，都有<code>autocommit</code>选项，默认我们的操作都是自动提交，但可以设置<code>set autocommit = 0</code>取消。</p>
</blockquote>
<h3 id="事务控制语句"><a href="#事务控制语句" class="headerlink" title="事务控制语句"></a>事务控制语句</h3><p><code>BEGIN</code>或<code>START TRANSACTION</code>：显式地开启一个事务；</p>
<p><code>COMMIT</code>：也可以使用COMMIT WORK，不过二者是等价的。COMMIT会提交事务，并使已对数据库进行的所有修改称为永久性的；</p>
<p><code>ROLLBACK</code>：有可以使用ROLLBACK WORK，不过二者是等价的。回滚会结束用户的事务，并撤销正在进行的所有未提交的修改；</p>
<p><code>SAVEPOINT identifier</code>：SAVEPOINT允许在事务中创建一个保存点，一个事务中可以有多个SAVEPOINT；</p>
<p><code>RELEASE SAVEPOINT identifier</code>：删除一个事务的保存点，当没有指定的保存点时，执行该语句会抛出一个异常；</p>
<p><code>ROLLBACK TO identifier</code>：把事务回滚到标记点；</p>
<p><code>SET TRANSACTION</code>：用来设置事务的隔离级别。InnoDB存储引擎提供事务的隔离级别有READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ和SERIALIZABLE。</p>
<h3 id="事务顺序"><a href="#事务顺序" class="headerlink" title="事务顺序"></a>事务顺序</h3><p><code>BEGIN</code> 开始一个事务<br><code>ROLLBACK</code> 事务回滚<br><code>COMMIT</code> 事务确认</p>
<blockquote>
<p><a href="http://www.runoob.com/mysql/mysql-transaction.html" target="_blank" rel="noopener">http://www.runoob.com/mysql/mysql-transaction.html</a></p>
</blockquote>
<h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><ul>
<li><strong>Read Uncommitted（读取未提交内容）</strong>：允许读取未提交的数据。</li>
<li><strong>Read Committed（读取提交内容）</strong>：一个事务只能看见已经提交事务所做的改变。这种隔离级别会导致 – <strong>不可重复读（Nonrepeatable Read）</strong>，因为同一事务的其他实例在该实例处理其间可能会有新的commit，所以同一select，前后可能返回不同结果。</li>
<li><strong>Repeatable Read（可重读）</strong>： 同一事务的多个实例在并发读取数据时，会看到同样的数据行。期间插入数据可能导致<strong>幻读</strong>。</li>
<li><strong>Serializable（可串行化）</strong>：sql中最高的隔离性级别，能够避免脏读，幻读，不可重复读。</li>
</ul>
<h3 id="脏读、幻读、不可重复读"><a href="#脏读、幻读、不可重复读" class="headerlink" title="脏读、幻读、不可重复读"></a>脏读、幻读、不可重复读</h3><ul>
<li>脏读是指，当一个事务在访问某一数据，并且修改了这一数据，但是在commit之前，另外一个事务也访问了同一数据，然后做了修改。</li>
<li>不可重复读：在同一个事务生命周期内，也就是这个事务还未提交之前。如果另外一个事务，对数据进行了编辑(update)或者删除(delete)操作。那么A事务就会读取到。</li>
<li>幻读：它的结果其实和不可重复读是一样的表现，差异就在于，不可重复读，主要是针对其他事务进行了编辑(update)和删除(delete)操作。而幻读主要是针对插入(insert)操作。也就是在一个事务生命周期内，会查询到另外一个事务新插入的数据。</li>
</ul>
<blockquote>
<p><a href="http://www.cnblogs.com/zhoujinyi/p/3437475.html" target="_blank" rel="noopener">http://www.cnblogs.com/zhoujinyi/p/3437475.html</a></p>
</blockquote>
<blockquote>
<p><a href="https://www.jianshu.com/p/4ba118333a19" target="_blank" rel="noopener">https://www.jianshu.com/p/4ba118333a19</a></p>
</blockquote>
<blockquote>
<p><a href="http://xstarcd.github.io/wiki/MySQL/mysql_isolation_level.html" target="_blank" rel="noopener">http://xstarcd.github.io/wiki/MySQL/mysql_isolation_level.html</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zqfmcl</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">193</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zqfmcl</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>

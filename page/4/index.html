<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Fey's blog" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="Fey&#39;s blog">
<meta property="og:url" content="https://zqfmcl.github.io/dialy/page/4/index.html">
<meta property="og:site_name" content="Fey&#39;s blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fey&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zqfmcl.github.io/dialy/page/4/">





  <title>Fey's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fey's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解重用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解重用/" itemprop="url">Java题解重用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第七章-重用"><a href="#第七章-重用" class="headerlink" title="第七章  重用"></a>第七章  重用</h2><p>class Engine {</p>
<p>​       private String s;</p>
<p>​       Engine() {</p>
<p>​              println(“Engine()”);</p>
<p>​              s = “Constructed”;</p>
<p>​       }</p>
<p>​       public String toString() { return s; }</p>
<p>}</p>
<p>public class Airplane {</p>
<p>​       private String fuselage, wings, tail;</p>
<p>​       private Engine e;</p>
<p>​       public Airplane() {</p>
<p>​              println(“Inside Airplane()”);</p>
<p>​              fuselage = “Body”;</p>
<p>​              wings = “Airfoils”;</p>
<p>​              tail = “Empennage”;                          </p>
<p>​       }</p>
<p>​       public String toString() { </p>
<p>​              if(e == null)                       e = new Engine();</p>
<p>​              return “fuselage = “ + fuselage + “, “ +</p>
<p>​                     “wings = “ + wings + “, “ +</p>
<p>​                     “tail = “ + tail + “, “ +</p>
<p>​                     “Engine = “ + e;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Airplane N1234 = new Airplane();</p>
<p>​              print(N1234);</p>
<p>​       }</p>
<p>}</p>
<p>public class Sterilizer extends Detergent {</p>
<p>​       public void scrub() { append(“ Sterilizer.scrub()”); }</p>
<p>​       public void sterilize() { append(“ sterilize()”); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Sterilizer x = new Sterilizer();</p>
<p>​              x.dilute();</p>
<p>​              x.apply(); </p>
<p>​              x.scrub();</p>
<p>​              x.foam();</p>
<p>​              x.sterilize();</p>
<p>​              println(x);</p>
<p>​              println(“Testing base class:”);</p>
<p>​              Detergent.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Art {</p>
<p>​       Art() { println(“Art constructor”); }</p>
<p>}</p>
<p>class Drawing extends Art {</p>
<p>​       Drawing() { println(“Drawing constructor”); }</p>
<p>}</p>
<p>public class Cartoon2 extends Drawing {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Cartoon2 x = new Cartoon2();</p>
<p>​       }</p>
<p>}</p>
<p>class A { A(){ println(“A()”);} }</p>
<p>class B extends A { B(){ println(“B()”);} }</p>
<p>class C extends B { C(){ println(“C()”);} }</p>
<p>class D extends C {</p>
<p>​       D() { println(“D()”); }</p>
<p>​       public static D makeD() { return new D(); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              D d = new D();</p>
<p>​              D d2 = makeD();</p>
<p>​       }</p>
<p>}</p>
<p>public class E extends D {</p>
<p>​       E() { println(“E()”); } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              E e = new E();</p>
<p>​                           D.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class A { A(){ println(“A()”);} }</p>
<p>class B extends A { B(){ println(“B()”);} }</p>
<p>class C extends A { </p>
<p>​       B b = new B();      public static void main(String[] args) {</p>
<p>​              C c = new C();      }</p>
<p>}</p>
<p>class Game {</p>
<p>​       Game(int i) {</p>
<p>​              print(“Game constructor”);</p>
<p>​       }      </p>
<p>}</p>
<p>class BoardGame extends Game {</p>
<p>​       BoardGame(int i) {</p>
<p>​                                               super(i);               print(“BoardGame constructor”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Chess extends BoardGame {</p>
<p>​       Chess() {</p>
<p>​              super(11);</p>
<p>​              print(“Chess constructor”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Chess x = new Chess();</p>
<p>​       }</p>
<p>}</p>
<p>class A { </p>
<p>​       A(char c, int i) { println(“A(char, int)”);} </p>
<p>}</p>
<p>class B extends A {       </p>
<p>​       B(String s, float f){</p>
<p>​              super(‘ ‘, 0); </p>
<p>​              println(“B(String, float)”);</p>
<p>​       } </p>
<p>}</p>
<p>class C7 extends A { </p>
<p>​       private char c;</p>
<p>​       private int i;</p>
<p>​       C7(char a, int j) {   </p>
<p>​              super(a, j); </p>
<p>​              c = a;</p>
<p>​              i = j;</p>
<p>​       }</p>
<p>​       B b = new B(“hi”, 1f);   public static void main(String[] args) {</p>
<p>​              C7 c = new C7(‘b’, 2);         }</p>
<p>}</p>
<p>class A { </p>
<p>​       A(char c, int i) { println(“A(char, int)”);} </p>
<p>}</p>
<p>class Ex8 extends A { </p>
<p>​       private char c;</p>
<p>​       private int i;</p>
<p>​       Ex8() { </p>
<p>​              super(‘z’, 3);</p>
<p>​              println(“Ex8()”); </p>
<p>​       } </p>
<p>​       Ex8(char a, int j) {  </p>
<p>​              super(a, j); </p>
<p>​              c = a;</p>
<p>​              i = j;</p>
<p>​              println(“Ex8(char,int)”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Ex8 ex1 = new Ex8();</p>
<p>​              Ex8 ex2 = new Ex8(‘b’, 2); </p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1() { println(“Component1()”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2() { println(“Component2()”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3() { println(“Component3()”); }</p>
<p>}</p>
<p>class Root { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root() { println(“Root()”); } </p>
<p>}</p>
<p>class Stem extends Root { </p>
<p>​       Component1 c1stem;</p>
<p>​       Component2 c2stem;</p>
<p>​       Component3 c3stem;</p>
<p>​       Stem() { println(“Stem()”); } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem s = new Stem();</p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1(byte b) { println(“Component1(byte)”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2(short s) { println(“Component2(short)”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3(int i) { println(“Component3(int)”); }</p>
<p>}</p>
<p>class Root { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root(float f) { </p>
<p>​              c1root = new Component1((byte)0);</p>
<p>​              c2root = new Component2((short)0);</p>
<p>​              c3root = new Component3(0);</p>
<p>​              println(“Root(foat)”); </p>
<p>​       } </p>
<p>}</p>
<p>class Stem10 extends Root { </p>
<p>​       Component1 c1stem10;</p>
<p>​       Component2 c2stem10;</p>
<p>​       Component3 c3stem10;</p>
<p>​       Stem10(double d) { </p>
<p>​              super(2.78f);</p>
<p>​              c1stem10 = new Component1((byte)1);</p>
<p>​              c2stem10 = new Component2((short)1);</p>
<p>​              c3stem10 = new Component3(1);</p>
<p>​              println(“Stem10(double)”); </p>
<p>​       } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem10 x = new Stem10(2.78);</p>
<p>​       }</p>
<p>}</p>
<p>class Cleanser {</p>
<p>​       private String s = “Cleanser”;</p>
<p>​       public void append(String a) { s += a; }</p>
<p>​       public void dilute() { append(“ dilute()”); }</p>
<p>​       public void apply() { append(“ apply()”); }</p>
<p>​       public void scrub() { append(“ scrub()”); }</p>
<p>​       public String toString() { return s; }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Cleanser x = new Cleanser();</p>
<p>​              print(x);</p>
<p>​       }</p>
<p>}</p>
<p>public class DetergentDelegation {</p>
<p>​       private String s = “DetergentDelegation”;</p>
<p>​       Cleanser c = new Cleanser();</p>
<p>​       public void append(String a) { s += a; }</p>
<p>​             public void dilute() { </p>
<p>​              c.dilute(); </p>
<p>​       }</p>
<p>​       public void apply() {</p>
<p>​              c.apply(); </p>
<p>​              }</p>
<p>​             public void scrub() {</p>
<p>​              append(“ DetergentDelegation.scrub()”);</p>
<p>​              c.scrub(); </p>
<p>​       }</p>
<p>​       public void foam() { append(“ foam()”); } </p>
<p>​       public String toString() { return s + “ “ + c; }     </p>
<p>​       public static void main(String[] args) {</p>
<p>​              DetergentDelegation x = new DetergentDelegation();</p>
<p>​              x.dilute();</p>
<p>​              x.apply();</p>
<p>​              x.scrub();</p>
<p>​              x.foam();</p>
<p>​              print(x);</p>
<p>​              print(“Testing base class:”);</p>
<p>​              Cleanser.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1() { println(“Component1()”); }</p>
<p>​       void dispose() { println(“Component1.dispose()”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2() { println(“Component2()”); }</p>
<p>​       void dispose() { println(“Component2.dispose()”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3() { println(“Component3()”); }</p>
<p>​       void dispose() { println(“Component3.dispose()”); }</p>
<p>}</p>
<p>class Root2 { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root2() { </p>
<p>​              println(“Root()”);</p>
<p>​              c1root = new Component1();</p>
<p>​              c2root = new Component2();</p>
<p>​              c3root = new Component3();</p>
<p>​       }</p>
<p>​       void dispose() {</p>
<p>​              c3root.dispose();</p>
<p>​              c2root.dispose();</p>
<p>​              c1root.dispose();</p>
<p>​              println(“Root2.dispose()”);</p>
<p>​       } </p>
<p>}</p>
<p>class Stem2 extends Root2 { </p>
<p>​       Component1 c1stem;</p>
<p>​       Component2 c2stem;</p>
<p>​       Component3 c3stem;</p>
<p>​       Stem2() { </p>
<p>​              super();</p>
<p>​              println(“Stem2()”); </p>
<p>​              c1stem = new Component1();</p>
<p>​              c2stem = new Component2();</p>
<p>​              c3stem = new Component3();</p>
<p>​       }</p>
<p>​       void dispose() {</p>
<p>​              c3stem.dispose();</p>
<p>​              c2stem.dispose();</p>
<p>​              c1stem.dispose();</p>
<p>​              super.dispose();</p>
<p>​              println(“Stem2.dispose()”);</p>
<p>​       } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem2 s = new Stem2();</p>
<p>​              try {</p>
<p>​                                  } finally {</p>
<p>​                     s.dispose();</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class ThreeWay {</p>
<p>​       void number(byte b) { println(b); }</p>
<p>​       void number(short s) { println(s); }</p>
<p>​       void number(int i) { println(i); }</p>
<p>}</p>
<p>class Overload extends ThreeWay {</p>
<p>​       void number(float f) { println(f); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Overload ov = new Overload();</p>
<p>​              ov.number((byte)0);</p>
<p>​              ov.number((short)1);</p>
<p>​              ov.number(2);</p>
<p>​              ov.number(3.0f);</p>
<p>​       }</p>
<p>}</p>
<p> class Engine {</p>
<p>​       public void start() {}</p>
<p>​       public void rev() {}</p>
<p>​       public void stop() {}</p>
<p>​       public void service() { System.out.println(“service engine”); }</p>
<p>}</p>
<p>class Wheel {</p>
<p>​       public void inflate(int psi) {}</p>
<p>}</p>
<p>class Window {</p>
<p>​       public void rollup() {}</p>
<p>​       public void rolldown() {}</p>
<p>}</p>
<p>class Door {</p>
<p>​       public Window window = new Window();</p>
<p>​       public void open() {}</p>
<p>​       public void close() {}</p>
<p>}</p>
<p>public class Car {</p>
<p>​       public Engine engine = new Engine();</p>
<p>​       public Wheel[] wheel = new Wheel[4];</p>
<p>​       public Door</p>
<p>​              left = new Door(),</p>
<p>​              right = new Door();     public Car() {</p>
<p>​              for(int i = 0; i &lt; 4; i++)</p>
<p>​                     wheel[i] = new Wheel();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Car car = new Car();</p>
<p>​              car.left.window.rollup();</p>
<p>​              car.wheel[0].inflate(72);</p>
<p>​              car.engine.service();</p>
<p>​       }      </p>
<p>}</p>
<p>class DeviceFail {   </p>
<p>​       public static void main(String[] s) {</p>
<p>​              BasicDevice fail = new BasicDevice();</p>
<p>​              fail.showS();</p>
<p>​                    }</p>
<p>}</p>
<p>public class Device extends BasicDevice {</p>
<p>​       void changeBasic(String t) {</p>
<p>​              super.changeS(t);        }      </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Device d = new Device();</p>
<p>​              d.showS();</p>
<p>​              d.changeBasic(“Changed”);              d.showS();</p>
<p>​              DeviceFail.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Amphibian {</p>
<p>​       protected void swim() {</p>
<p>​              println(“Amphibian swim”);         </p>
<p>​       }</p>
<p>​       protected void speak() {</p>
<p>​              println(“Amphibian speak”);</p>
<p>​       }</p>
<p>​       void eat() {</p>
<p>​              println(“Amphibian eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Amphibian grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>}</p>
<p>public class Frog extends Amphibian {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Frog f = new Frog();</p>
<p>​                           f.swim();</p>
<p>​              f.speak();</p>
<p>​              f.eat();</p>
<p>​                           Amphibian.grow(f);</p>
<p>​       }</p>
<p>}</p>
<p>class Amphibian {</p>
<p>​       protected void swim() {</p>
<p>​              println(“Amphibian swim”);         </p>
<p>​       }</p>
<p>​       protected void speak() {</p>
<p>​              println(“Amphibian speak”);</p>
<p>​       }</p>
<p>​       void eat() {</p>
<p>​              println(“Amphibian eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Amphibian grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>}</p>
<p>public class Frog17 extends Amphibian {</p>
<p>​       @Override protected void swim() {</p>
<p>​              println(“Frog swim”);            </p>
<p>​       }</p>
<p>​       @Override protected void speak() {</p>
<p>​              println(“Frog speak”);</p>
<p>​       }</p>
<p>​       @Override void eat() {</p>
<p>​              println(“Frog eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Frog grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Frog17 f = new Frog17();</p>
<p>​                           f.swim();</p>
<p>​              f.speak();</p>
<p>​              f.eat();</p>
<p>​                           f.grow(f);</p>
<p>​                           Amphibian.grow(f);</p>
<p>​       }</p>
<p>}</p>
<p>class Test {</p>
<p>​       Test() { println(“Test()”); }</p>
<p>}</p>
<p>public class Difference {</p>
<p>​       private String name;</p>
<p>​       public Difference(String s) { name = s;  } </p>
<p>​       static final Test sft = new Test();        private final Test ft = new Test();</p>
<p>​       static final String SFS = “static final”;        private final String fs = “final”;</p>
<p>​       private static Random rand = new Random();</p>
<p>​       static final int SFI = rand.nextInt();    private final int fi = rand.nextInt();</p>
<p>​       public String toString() {</p>
<p>​              return (name + “: “ + sft + “, “ + ft + “, “ + SFS + “, “ + fs + “, “ + SFI + “, “ + fi);        }            </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Difference d1 = new Difference(“d1”);</p>
<p>​              Difference d2 = new Difference(“d2”);</p>
<p>​              Difference d3 = new Difference(“d3”);</p>
<p>​              println(d1);</p>
<p>​              println(d2);</p>
<p>​              println(d3);</p>
<p>​       }</p>
<p>}</p>
<p>class Poppet {</p>
<p>​       private int i;</p>
<p>​       Poppet(int k) { i = k; }</p>
<p>​       public String toString() { </p>
<p>​              return (“Poppet “ + i); </p>
<p>​       }</p>
<p>}</p>
<p>public class BlankFinalEx {</p>
<p>​       private final Poppet p;             public BlankFinalEx() {</p>
<p>​              p = new Poppet(1);     }</p>
<p>​       public BlankFinalEx(int x) {</p>
<p>​              p = new Poppet(x);     }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              BlankFinalEx b1 = new BlankFinalEx();</p>
<p>​              BlankFinalEx b2 = new BlankFinalEx(47);</p>
<p>​                                        System.out.println(“b1.p: “ + b1.p);</p>
<p>​              System.out.println(“b2.p: “ + b2.p);</p>
<p>​       }</p>
<p>}</p>
<p>class WithFinals {</p>
<p>​             private final void f() { print(“WithFinals.f()”); }</p>
<p>​             private void g() { print(“WithFinals.g()”); }</p>
<p>} </p>
<p>class OverridingPrivate extends WithFinals {</p>
<p>​             private final void f() { print(“OverridingPrivate.f()”); }</p>
<p>​       private void g() { print(“OverridingPrivate.g()”); }</p>
<p>​                    }</p>
<p>class OverridingPrivate2 extends OverridingPrivate {</p>
<p>​             public final void f() { print(“OverridingPrivate2.f()”); }</p>
<p>​       public void g() { print(“OverridingPrivate2.g()”); }</p>
<p>​                    }</p>
<p>public class FinalOverridingIllusionEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              OverridingPrivate2 op2 = new OverridingPrivate2();</p>
<p>​              op2.f();</p>
<p>​              op2.g();</p>
<p>​                           OverridingPrivate op = op2;</p>
<p>​                                                                  WithFinals wf = op2;</p>
<p>​                                 }</p>
<p>}</p>
<p>class WithFinal {</p>
<p>​       final void f() { print(“WithFinal.f()”); }</p>
<p>​       void g() { print(“WithFinal.g()”); }</p>
<p>​       final void h() { print(“WitFinal.h()”); }</p>
<p>} </p>
<p>class OverrideFinal extends WithFinal {</p>
<p>​                   @Override public void g() { print(“OverrideFinal.g()”); }          }</p>
<p>public class FinalOverrideEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              OverrideFinal of = new OverrideFinal();</p>
<p>​              of.f();</p>
<p>​              of.g();</p>
<p>​              of.h();</p>
<p>​                           WithFinal wf = of;</p>
<p>​              wf.f(); </p>
<p>​              wf.g();</p>
<p>​              wf.h(); </p>
<p>​       }</p>
<p>}</p>
<p> class SmallBrain {} </p>
<p>final class Dinosaur {</p>
<p>​       SmallBrain x = new SmallBrain();</p>
<p>}</p>
<p>public class JurassicEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Dinosaur d = new Dinosaur();</p>
<p>​       }</p>
<p>}</p>
<p>class A {</p>
<p>​       static int j = printInit(“A.j initialized”);</p>
<p>​       static int printInit(String s) {</p>
<p>​              println(s);</p>
<p>​              return 1;</p>
<p>​       }</p>
<p>​       A() { println(“A() constructor”); }   </p>
<p>} </p>
<p>class B extends A {</p>
<p>​       static int k = printInit(“B.k initialized”);</p>
<p>​       B() { println(“B() constructor”); }   </p>
<p>}</p>
<p>class C {</p>
<p>​       static int n = printInitC(“C.n initialized”);</p>
<p>​       static A a = new A();     </p>
<p>​       C() { println(“C() constructor”); }</p>
<p>​       static int printInitC(String s) {</p>
<p>​              println(s);</p>
<p>​              return 1;</p>
<p>​       }</p>
<p>}</p>
<p>class D {</p>
<p>​       D() { println(“D() constructor”); }</p>
<p>}</p>
<p>public class LoadClass extends B {</p>
<p>​       static int i = printInit(“LoadClass.i initialized”);</p>
<p>​       LoadClass() { println(“LoadClass() constructor”); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​                                        println(“hi”);</p>
<p>​                           LoadClass lc = new LoadClass();</p>
<p>​                           println(C.a);</p>
<p>​                           D d = new D();</p>
<p>​       }</p>
<p>}</p>
<p>class Insect {</p>
<p>​       private int i = 9;</p>
<p>​       protected int j;</p>
<p>​       Insect() {</p>
<p>​              print(“i = “ + i + “, j = “ + j);</p>
<p>​              j = 39;</p>
<p>​       }</p>
<p>​       private static int x1 = printInit(“static Insect.x1 initialized”);</p>
<p>​       static int printInit(String s) {</p>
<p>​              print(s);</p>
<p>​              return 47;</p>
<p>​       }</p>
<p>}</p>
<p>class Beetle extends Insect {</p>
<p>​       private int k = printInit(“Beetle.k initialized”);</p>
<p>​       public Beetle() {</p>
<p>​              print(“k = “ + k);</p>
<p>​              print(“j = “ + j);</p>
<p>​       }</p>
<p>​       private static int x2 = printInit(“static Beetle.x2 initialized”);     </p>
<p>}</p>
<p>public class Scarab extends Beetle {</p>
<p>​       private int n = printInit(“Scarab.n initialized”);</p>
<p>​       public Scarab() {</p>
<p>​              print(“n = “ + n);</p>
<p>​              print(“j = “ + j);</p>
<p>​       }</p>
<p>​       private static int x3 = printInit(“static Scarab.x3 initialized”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              print(“Scarab constructor”);</p>
<p>​              Scarab sc = new Scarab();                  </p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解类型信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解类型信息/" itemprop="url">Java题解类型信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第十四章-类型信息"><a href="#第十四章-类型信息" class="headerlink" title="第十四章 类型信息"></a>第十四章 类型信息</h2><p>class Toy {</p>
<p>​                         Toy(int i) {}</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest1 {</p>
<p>​       static void printInfo(Class cc) {</p>
<p>​              print(“Class name: “ + cc.getName() +</p>
<p>​                     “ is interface? [“ + cc.isInterface() + “]”);</p>
<p>​              print(“Simple name: “ + cc.getSimpleName());</p>
<p>​              print(“Canonical name: “ + cc.getCanonicalName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(“typeinfo.toys.FancyToy”);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Can’t find FancyToy”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(c);</p>
<p>​              for(Class face : c.getInterfaces())</p>
<p>​                     printInfo(face);</p>
<p>​              Class up = c.getSuperclass();</p>
<p>​              Object obj = null;</p>
<p>​              try {</p>
<p>​                                                             obj = up.newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Cannot instantiate”);</p>
<p>​                     System.exit(1);</p>
<p>​              } catch(IllegalAccessException i) {</p>
<p>​                     print(“Cannot access”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(obj.getClass());</p>
<p>​       }</p>
<p>}</p>
<p>interface HasBatteries {}</p>
<p>interface Waterproof {}</p>
<p>interface Shoots {}</p>
<p>interface Flies {}</p>
<p>class Toy {</p>
<p>​                   Toy() {}</p>
<p>​       Toy(int i) {}</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots, Flies {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest2 {</p>
<p>​       static void printInfo(Class cc) {</p>
<p>​              print(“Class name: “ + cc.getName() +</p>
<p>​                     “ is interface? [“ + cc.isInterface() + “]”);</p>
<p>​              print(“Simple name: “ + cc.getSimpleName());</p>
<p>​              print(“Canonical name: “ + cc.getCanonicalName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(“typeinfo.toys.FancyToy”);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Can’t find FancyToy”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(c);</p>
<p>​              for(Class face : c.getInterfaces())</p>
<p>​                     printInfo(face);</p>
<p>​              Class up = c.getSuperclass();</p>
<p>​              Object obj = null;</p>
<p>​              try {</p>
<p>​                                         obj = up.newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Cannot instantiate”);</p>
<p>​                     System.exit(1);</p>
<p>​              } catch(IllegalAccessException i) {</p>
<p>​                     print(“Cannot access”);</p>
<p>​                     System.exit(1);</p>
<p>​              }      </p>
<p>​              printInfo(obj.getClass());</p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>class Rhomboid extends Shape {</p>
<p>​       public String toString() { return “Rhomboid”; }</p>
<p>}</p>
<p>public class Shapes3 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw();</p>
<p>​              Rhomboid r = new Rhomboid();</p>
<p>​              ((Shape)r).draw();</p>
<p>​                                 }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>class Rhomboid extends Shape {</p>
<p>​       public String toString() { return “Rhomboid”; }</p>
<p>}</p>
<p>public class Shapes4 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw();</p>
<p>​              Rhomboid r = new Rhomboid();</p>
<p>​                           Shape s = (Shape)r;</p>
<p>​              s.draw();</p>
<p>​                           if(s instanceof Circle) </p>
<p>​                     ((Circle)s).draw();</p>
<p>​              else if(!(s instanceof Circle))</p>
<p>​                     System.out.println(“(Shape)r is not a Circle”);           </p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>public class Shapes5 {</p>
<p>​       public static void rotate(Shape s) {</p>
<p>​                     if(!(s instanceof Circle))</p>
<p>​                            System.out.println(s + “ rotate”);</p>
<p>​              }                    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw(); </p>
<p>​              System.out.println();     </p>
<p>​              for(Shape shape : shapeList)</p>
<p>​                     rotate(shape);</p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Circle”; </p>
<p>​       }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Square”; </p>
<p>​       }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Triangle”; </p>
<p>​       }</p>
<p>}</p>
<p>public class Shapes6 {</p>
<p>​       public static void setFlag(Shape s) {</p>
<p>​                     if(s instanceof Triangle)</p>
<p>​                            ((Triangle)s).flag = true; </p>
<p>​              }                    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle()</p>
<p>​              );</p>
<p>​              for(Shape shape : shapeList) {</p>
<p>​                     setFlag(shape);</p>
<p>​                     System.out.println(shape);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Candy {</p>
<p>​       static { print(“Loading Candy”); }</p>
<p>}</p>
<p>class Gum {</p>
<p>​       static { print(“Loading Gum”); } </p>
<p>}</p>
<p>class Cookie {</p>
<p>​       static { print(“Loading Cookie”); }</p>
<p>}</p>
<p>public class SweetShop7 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     System.out.println(“Usage: sweetName”);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(args[0]);</p>
<p>​                     print(“Enjoy your “ + args[0]);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Couldn’t find “ + args[0]);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>  class A {}</p>
<p>class B extends A {}</p>
<p>class C extends B {}</p>
<p>public class Ex8 {</p>
<p>​       public static void Hierarchy(Object o) {</p>
<p>​              if(o.getClass().getSuperclass() != null) {             </p>
<p>​                     System.out.println(o.getClass() + “ is a subclass of “ + </p>
<p>​                            o.getClass().getSuperclass()); </p>
<p>​                     try {</p>
<p>​                            Hierarchy(o.getClass().getSuperclass().newInstance());</p>
<p>​                     } catch(InstantiationException e) {</p>
<p>​                            System.out.println(“Unable to instantiate obj”);</p>
<p>​                     } catch(IllegalAccessException e) {</p>
<p>​                            System.out.println(“Unable to access”);</p>
<p>​                     }</p>
<p>​              } </p>
<p>​       }             </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Hierarchy(new C());</p>
<p>​       }</p>
<p>}</p>
<p>  class A { int i; String s; }</p>
<p>class B extends A { int j; float f; }</p>
<p>class C extends B { int k; B b;}</p>
<p>public class Ex9 {</p>
<p>​       public static void Hierarchy(Object o) {</p>
<p>​              Object[] fields = o.getClass().getDeclaredFields();</p>
<p>​              if(fields.length == 0)</p>
<p>​                     System.out.println(o.getClass() + “ has no fields”);</p>
<p>​              if(fields.length &gt; 0) {</p>
<p>​                     System.out.println(“Field(s) of “ + o.getClass() + “:”);</p>
<p>​                     for(Object obj : fields) </p>
<p>​                            System.out.println(“ “ + obj);</p>
<p>​              }</p>
<p>​              if(o.getClass().getSuperclass() != null) {                    </p>
<p>​                     System.out.println(o.getClass() + “ is a subclass of “ + </p>
<p>​                            o.getClass().getSuperclass()); </p>
<p>​                     try {</p>
<p>​                            Hierarchy(o.getClass().getSuperclass().newInstance());</p>
<p>​                     } catch(InstantiationException e) {</p>
<p>​                            System.out.println(“Unabloe to instantiate obj”);</p>
<p>​                     } catch(IllegalAccessException e) {</p>
<p>​                            System.out.println(“Unable to access”);</p>
<p>​                     }</p>
<p>​              } </p>
<p>​       }             </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Hierarchy(new C());</p>
<p>​       }</p>
<p>}</p>
<p>  public class Ex10 {     </p>
<p>​       public static void main(String[] args) {</p>
<p>​              char[] c = new char[10];</p>
<p>​                           System.out.println(“Superclass of char[] c: “ + </p>
<p>​                     c.getClass().getSuperclass());</p>
<p>​              System.out.println(“char[] c instanceof Object: “ + </p>
<p>​                     (c instanceof Object));</p>
<p>​       }</p>
<p>}</p>
<p>​             package typeinfo.pets;</p>
<p>​       public class Gerbil extends Rodent {</p>
<p>​              public Gerbil(String name) { super(name); }</p>
<p>​              public Gerbil() { super(); }</p>
<p>​       } </p>
<p>​             “typeinfo.pets.Gerbil” </p>
<p>​             if(pet instanceof Gerbil) counter.count(“Gerbil”); </p>
<p>​             Gerbil.class </p>
<p>public class Ex11 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Pet.class);</p>
<p>​              for(Pet pet : Pets.createArray(20)) {</p>
<p>​                     printnb(pet.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(pet);</p>
<p>​              }      </p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex12 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Coffee.class);</p>
<p>​              for(Coffee coffee : new CoffeeGenerator(20)) {</p>
<p>​                     printnb(coffee.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(coffee);</p>
<p>​              }</p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex13 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Part.class);</p>
<p>​              List<part> partList = new ArrayList<part>();</part></part></p>
<p>​              for(int i = 0; i &lt; 20; i++)              </p>
<p>​                     partList.add(Part.createRandom());</p>
<p>​              for(Part part : partList) {</p>
<p>​                     printnb(part.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(part);</p>
<p>​              }</p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>class Part {</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName();</p>
<p>​       }</p>
<p>​       static List&lt;Class&lt;? extends Part&gt;&gt; partClasses = </p>
<p>​              new ArrayList&lt;Class&lt;? extends Part&gt;&gt;();</p>
<p>​       static {</p>
<p>​                                        partClasses.add(FuelFilter.class);</p>
<p>​              partClasses.add(AirFilter.class);</p>
<p>​              partClasses.add(CabinAirFilter.class);</p>
<p>​              partClasses.add(OilFilter.class);</p>
<p>​              partClasses.add(FanBelt.class);</p>
<p>​              partClasses.add(PowerSteeringBelt.class);</p>
<p>​              partClasses.add(GeneratorBelt.class);</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Part createRandom() {</p>
<p>​              int n = rand.nextInt(partClasses.size());</p>
<p>​              try {</p>
<p>​                     return partClasses.get(n).newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              } catch(IllegalAccessException e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       } </p>
<p>}</p>
<p>class Filter extends Part {}</p>
<p>class FuelFilter extends Filter {</p>
<p>​             public static class Factory implements typeinfo.factory.Factory<fuelfilter> {</fuelfilter></p>
<p>​              public FuelFilter create() { return new FuelFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class AirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<airfilter> {</airfilter></p>
<p>​              public AirFilter create() { return new AirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class CabinAirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cabinairfilter> {</cabinairfilter></p>
<p>​              public CabinAirFilter create() { return new CabinAirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class OilFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<oilfilter> {</oilfilter></p>
<p>​              public OilFilter create() { return new OilFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Belt extends Part {}</p>
<p>class FanBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<fanbelt> {</fanbelt></p>
<p>​              public FanBelt create() { return new FanBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class GeneratorBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<generatorbelt> {</generatorbelt></p>
<p>​              public GeneratorBelt create() { return new GeneratorBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class PowerSteeringBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<powersteeringbelt> {</powersteeringbelt></p>
<p>​              public PowerSteeringBelt create() { return new PowerSteeringBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredClasses14 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(Part.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredPetFactories15 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(PetFactory.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>class Coffee {</p>
<p>​       private static long counter = 0;</p>
<p>​       private final long id = counter++;</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName() + “ “ + id;</p>
<p>​       }</p>
<p>​       static List&lt;Factory&lt;? extends Coffee&gt;&gt; coffeeFactories =</p>
<p>​              new ArrayList&lt;Factory&lt;? extends Coffee&gt;&gt;();</p>
<p>​       static {</p>
<p>​              coffeeFactories.add(new Latte.Factory());</p>
<p>​              coffeeFactories.add(new Mocha.Factory());</p>
<p>​              coffeeFactories.add(new Cappuccino.Factory());</p>
<p>​              coffeeFactories.add(new Americano.Factory());</p>
<p>​              coffeeFactories.add(new Breve.Factory());</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Coffee createRandom() {</p>
<p>​              int n = rand.nextInt(coffeeFactories.size());</p>
<p>​              return coffeeFactories.get(n).create();</p>
<p>​       }</p>
<p>}</p>
<p>class Latte extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<latte> {</latte></p>
<p>​              public Latte create() { return new Latte(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Mocha extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<mocha> {</mocha></p>
<p>​              public Mocha create() { return new Mocha(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Cappuccino extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cappuccino> {</cappuccino></p>
<p>​              public Cappuccino create() { return new Cappuccino(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Americano extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<americano> {</americano></p>
<p>​              public Americano create() { return new Americano(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Breve extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<breve> {</breve></p>
<p>​              public Breve create() { return new Breve(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredCoffeeFactories16 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 15; i++)</p>
<p>​                     System.out.println(Coffee.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class ShowMethods17 {</p>
<p>​       private static String usage =</p>
<p>​              “usage:\n” +</p>
<p>​              “ShowMethods qualified.class.name\n” +</p>
<p>​              “To show all methods in class or:\n” +</p>
<p>​              “ShowMethods qualified.class.name word\n” +</p>
<p>​              “To search for methods involving ‘word’”;</p>
<p>​       private static Pattern p = Pattern.compile(“(\w+\.)|\s<em>final|\s</em>native”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     print(usage);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              int lines = 0;</p>
<p>​              try {</p>
<p>​                     Class&lt;?&gt; c = Class.forName(args[0]);</p>
<p>​                     Method[] methods = c.getMethods();</p>
<p>​                     Constructor[] ctors = c.getConstructors();</p>
<p>​                     if(args.length == 1) {</p>
<p>​                            for(Method method : methods) {</p>
<p>​                                   print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                            }</p>
<p>​                            for(Constructor ctor : ctors)</p>
<p>​                                   print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                            lines = methods.length + ctors.length;</p>
<p>​                     } else {</p>
<p>​                            for(Method method : methods)</p>
<p>​                                   if(method.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                                   }</p>
<p>​                            for(Constructor ctor : ctors) </p>
<p>​                                   if(ctor.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“No such class: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class ShowMethods18 {</p>
<p>​       private static String usage =</p>
<p>​              “usage:\n” +</p>
<p>​              “ShowMethods qualified.class.name\n” +</p>
<p>​              “To show all methods in class or:\n” +</p>
<p>​              “ShowMethods qualified.class.name word\n” +</p>
<p>​              “To search for methods involving ‘word’”;</p>
<p>​       private static Pattern p = Pattern.compile(“\w+\.”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     print(usage);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              int lines = 0;</p>
<p>​              try {</p>
<p>​                     Class&lt;?&gt; c = Class.forName(args[0]);</p>
<p>​                     Method[] methods = c.getMethods();</p>
<p>​                     Constructor[] ctors = c.getConstructors();</p>
<p>​                     if(args.length == 1) {</p>
<p>​                            for(Method method : methods) {</p>
<p>​                                   print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                            }</p>
<p>​                            for(Constructor ctor : ctors)</p>
<p>​                                   print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                            lines = methods.length + ctors.length;</p>
<p>​                     } else {</p>
<p>​                            for(Method method : methods)</p>
<p>​                                   if(method.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                                   }</p>
<p>​                            for(Constructor ctor : ctors) </p>
<p>​                                   if(ctor.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“No such class: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>interface HasBatteries {}</p>
<p>interface Waterproof {}</p>
<p>interface Shoots {}</p>
<p>class Toy {</p>
<p>​       Toy() {</p>
<p>​              print(“Creating Toy() object”);      </p>
<p>​       }</p>
<p>​       Toy(int i) {</p>
<p>​              print(“Creating Toy(“ + i + “) object”);</p>
<p>​       }</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest19 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           try {</p>
<p>​                     Toy.class.getDeclaredConstructor(int.class).newInstance(1);</p>
<p>​                           } catch(NoSuchMethodException e) {</p>
<p>​                     print(“No such method: “ + e);</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Unable make Toy: “ + e);</p>
<p>​              } catch(IllegalAccessException e) {</p>
<p>​                     print(“Unable access: “ + e);</p>
<p>​              } catch(InvocationTargetException e) {</p>
<p>​                     print(“Target invocation problem: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class ClassInfo {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     println(“Usage: name of class”);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              Class&lt;?&gt; c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(args[0]);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     println(“No such class: “ + e);</p>
<p>​              }</p>
<p>​              println(“c: “ + c);</p>
<p>​              println(“c.getAnnotations(): “);</p>
<p>​              if(c.getAnnotations().length == 0) println(“none”);</p>
<p>​              for(Annotation a : c.getAnnotations())</p>
<p>​                     println(a);</p>
<p>​              println(“c.getCanonicalName(): “ + c.getCanonicalName());</p>
<p>​              println(“c.getClasses(): “);</p>
<p>​              if(c.getClasses().length == 0) println(“none”);</p>
<p>​              for(Class cl : c.getClasses())</p>
<p>​                     println(cl);</p>
<p>​              println(“c.getClassLoader(): “ + c.getClassLoader());</p>
<p>​              println(“c.getConstructors(): “);</p>
<p>​              if(c.getConstructors().length == 0) println(“none”);</p>
<p>​              for(Constructor ctor : c.getConstructors())</p>
<p>​                     println(ctor);</p>
<p>​              println(“c.getDeclaredAnnotations(): “);</p>
<p>​              if(c.getDeclaredAnnotations().length == 0) println(“none”);</p>
<p>​              for(Annotation a : c.getDeclaredAnnotations())</p>
<p>​                     println(a);</p>
<p>​              println(“c.getDeclaredClasses(): “);</p>
<p>​              if(c.getDeclaredClasses().length == 0) println(“none”);</p>
<p>​              for(Class cl : c.getDeclaredClasses())</p>
<p>​                     println(cl);</p>
<p>​              println(“c.getDeclaredConstructors(): “);</p>
<p>​              if(c.getDeclaredConstructors().length == 0) println(“none”);</p>
<p>​              for(Constructor ctor : c.getDeclaredConstructors())</p>
<p>​                     println(ctor);</p>
<p>​              println(“c.getDeclaredFields(): “);</p>
<p>​              if(c.getDeclaredFields().length == 0) println(“none”);</p>
<p>​              for(Field f : c.getDeclaredFields())</p>
<p>​                     println(f);</p>
<p>​              println(“c.getDeclaredMethods(): “);</p>
<p>​              if(c.getDeclaredMethods().length == 0) println(“none”);</p>
<p>​              for(Method m : c.getDeclaredMethods())</p>
<p>​                     println(m);</p>
<p>​              println(“c.getDeclaringClass(): “ + c.getDeclaringClass());</p>
<p>​              println(“c.getEnclosingConstructor(): “ + c.getEnclosingConstructor());</p>
<p>​              println(“c.getEnclosingMethod(): “ + c.getEnclosingMethod());</p>
<p>​              println(“c.getEnumConstants(): “ + c.getEnumConstants());</p>
<p>​              println(“c.getDeclaredFields(): “);</p>
<p>​              if(c.getFields().length == 0) println(“none”);</p>
<p>​              for(Field f : c.getFields())</p>
<p>​                     println(f);</p>
<p>​              println(“c.getGenericInterfaces(): “);</p>
<p>​              if(c.getGenericInterfaces().length == 0) println(“none”);</p>
<p>​              for(Type t : c.getGenericInterfaces())</p>
<p>​                     println(t);</p>
<p>​              println(“c.getGenericSuperclass(): “ + c.getGenericSuperclass());</p>
<p>​              println(“c.getInterfaces(): “);</p>
<p>​              if(c.getInterfaces().length == 0) println(“none”);</p>
<p>​              for(Class i : c.getInterfaces())</p>
<p>​                     println(i);</p>
<p>​              println(“c.getMethods(): “);</p>
<p>​              if(c.getMethods().length == 0) println(“none”);</p>
<p>​              for(Method m : c.getMethods())</p>
<p>​                     println(m);</p>
<p>​              println(“c.getModifiers(): “ + c.getModifiers());</p>
<p>​              println(“c.getName(): “ + c.getName());</p>
<p>​              println(“c.getPackage(): “ + c.getPackage());</p>
<p>​              println(“c.getProtectionDomain(): “ + c.getProtectionDomain());</p>
<p>​              print(“c.getSigners(): “);</p>
<p>​              if(c.getSigners() == null)</p>
<p>​                     println(c.getSigners());</p>
<p>​              if(c.getSigners() != null) {</p>
<p>​                     println();</p>
<p>​                     if(c.getSigners().length == 0) println(“none”);</p>
<p>​                     if(c.getSigners().length &gt; 0) {</p>
<p>​                            for(Object s : c.getSigners()) </p>
<p>​                                   println(s);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​              println(“c.getSimpleName(): “ + c.getSimpleName());</p>
<p>​              println(“c.getSuperclass(): “ + c.getSuperclass());</p>
<p>​              println(“c.getTypeParameters(): “ + c.getTypeParameters());</p>
<p>​              println(“c.isAnnotation(): “ + c.isAnnotation());</p>
<p>​              println(“c.isAnnotationPresent(Documented.class): “ + c.isAnnotationPresent(Documented.class));</p>
<p>​              println(“c.isAnonymousClass(): “ + c.isAnonymousClass());</p>
<p>​              println(“c.isArray(): “ + c.isArray());</p>
<p>​              println(“c.isAssignableFrom(ClassInfo.class): “ + c.isAssignableFrom(ClassInfo.class));</p>
<p>​              println(“c.isAssignableFrom(Object.class): “ + c.isAssignableFrom(Object.class));</p>
<p>​              println(“c.isEnum(): “ + c.isEnum());</p>
<p>​              println(“c.isInstance(Object.class): “ + c.isInstance(Object.class));</p>
<p>​              println(“c.isInterface(): “ + c.isInterface());</p>
<p>​              println(“c.isLocalClass(): “ + c.isLocalClass());</p>
<p>​              println(“c.isMemberClass(): “ + c.isMemberClass());</p>
<p>​              println(“c.isPrimitive(): “ + c.isPrimitive());</p>
<p>​              println(“c.isSynthetic(): “ + c.isSynthetic());         </p>
<p>​       }</p>
<p>}</p>
<p>interface Interface {</p>
<p>​       void doSomething();</p>
<p>​       void somethingElse(String arg);</p>
<p>}</p>
<p>class RealObject implements Interface {</p>
<p>​       public void doSomething() { print(“doSomething”); }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              print(“somethingElse “ + arg);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxy implements Interface {</p>
<p>​       private Interface proxied;</p>
<p>​       private static int doCount = 0;</p>
<p>​       private static int sECount = 0;</p>
<p>​       public SimpleProxy(Interface proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public void doSomething() { </p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called doSomething() “ + doCount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              doCount++;</p>
<p>​              proxied.doSomething();</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called somethingElse() “ + sECount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              sECount++;</p>
<p>​              proxied.somethingElse(arg);</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxyDemo21 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              consumer(new RealObject());</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));                                   </p>
<p>​       }</p>
<p>}</p>
<p>interface Interface {</p>
<p>​       void doSomething();</p>
<p>​       void somethingElse(String arg);</p>
<p>}</p>
<p>class RealObject implements Interface {</p>
<p>​       public void doSomething() { print(“doSomething”); }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              print(“somethingElse “ + arg);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxy implements Interface {</p>
<p>​       private Interface proxied;</p>
<p>​       private static int doCount = 0;</p>
<p>​       private static int sECount = 0;</p>
<p>​       public SimpleProxy(Interface proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public void doSomething() { </p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called doSomething() “ + doCount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              doCount++;</p>
<p>​              proxied.doSomething();</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called somethingElse() “ + sECount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              sECount++;</p>
<p>​              proxied.somethingElse(arg);</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxyDemo21 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              consumer(new RealObject());</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));                                   </p>
<p>​       }</p>
<p>}</p>
<p>class DynamicProxyHandler implements InvocationHandler {</p>
<p>​       private Object proxied;</p>
<p>​       public DynamicProxyHandler(Object proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</p>
<p>System.out.println(“**** proxy: “ + proxy.getClass() +</p>
<p>​                     “, method: “ + method + “, args: “ + args);</p>
<p>​              if(args != null)</p>
<p>​                     for(Object arg : args)</p>
<p>​                            System.out.println(“  “ + args);</p>
<p>​              return method.invoke(proxied, args);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleDynamicProxy23 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              RealObject real = new RealObject();</p>
<p>​              consumer(real);</p>
<p>​                           Interface proxy = (Interface)Proxy.newProxyInstance(</p>
<p>​                     Interface.class.getClassLoader(),</p>
<p>​                     new Class[]{ Interface.class },</p>
<p>​                     new DynamicProxyHandler(real));</p>
<p>​              consumer(proxy);         </p>
<p>​       }</p>
<p>}</p>
<p>class Part {</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName();</p>
<p>​       }</p>
<p>​       static List&lt;Factory&lt;? extends Part&gt;&gt; partFactories = </p>
<p>​              new ArrayList&lt;Factory&lt;? extends Part&gt;&gt;();</p>
<p>​       static {</p>
<p>​                                        partFactories.add(new FuelFilter.Factory());</p>
<p>​              partFactories.add(new AirFilter.Factory());</p>
<p>​              partFactories.add(new CabinAirFilter.Factory());</p>
<p>​              partFactories.add(new OilFilter.Factory());</p>
<p>​              partFactories.add(new FanBelt.Factory());</p>
<p>​              partFactories.add(new PowerSteeringBelt.Factory());</p>
<p>​              partFactories.add(new GeneratorBelt.Factory());</p>
<p>​              partFactories.add(new NullPart.Factory());</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Part createRandom() {</p>
<p>​              int n = rand.nextInt(partFactories.size());</p>
<p>​              return partFactories.get(n).create();            </p>
<p>​       } </p>
<p>​       </p>
<p>​       </p>
<p>}</p>
<p>class NullPart extends Part implements Null {</p>
<p>​       private NullPart() { super(); } </p>
<p>​       public static final Part NULL = new NullPart();</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<nullpart> {</nullpart></p>
<p>​              public NullPart create() { return (NullPart)NULL; }</p>
<p>​       }</p>
<p>​       public String toString() { return “NULL”; }</p>
<p>}</p>
<p>class Filter extends Part {}</p>
<p>class FuelFilter extends Filter {</p>
<p>​             public static class Factory implements typeinfo.factory.Factory<fuelfilter> {</fuelfilter></p>
<p>​              public FuelFilter create() { return new FuelFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class AirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<airfilter> {</airfilter></p>
<p>​              public AirFilter create() { return new AirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class CabinAirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cabinairfilter> {</cabinairfilter></p>
<p>​              public CabinAirFilter create() { return new CabinAirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class OilFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<oilfilter> {</oilfilter></p>
<p>​              public OilFilter create() { return new OilFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Belt extends Part {}</p>
<p>class FanBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<fanbelt> {</fanbelt></p>
<p>​              public FanBelt create() { return new FanBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class GeneratorBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<generatorbelt> {</generatorbelt></p>
<p>​              public GeneratorBelt create() { return new GeneratorBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class PowerSteeringBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<powersteeringbelt> {</powersteeringbelt></p>
<p>​              public PowerSteeringBelt create() { return new PowerSteeringBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredFactories24 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(Part.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class Finder25 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              A a = SecretMaker.makeSecret();</p>
<p>​              println(“a is of class type: “ + a.getClass().getName());</p>
<p>​              for(Method m : a.getClass().getDeclaredMethods()) {</p>
<p>​                     m.setAccessible(true);</p>
<p>​                     m.invoke(a);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Instrument {</p>
<p>​       void play(Note n) { print(“Instrument.play() “ + n); }</p>
<p>​       public String toString() { return “Instrument”; }</p>
<p>​       void adjust() { print(“Adjusting Instrument”); }</p>
<p>}</p>
<p>class Wind extends Instrument {</p>
<p>​       void play(Note n) { print(“Wind.play() “ + n); }</p>
<p>​       public String toString() { return “Wind”; }</p>
<p>​       void adjust() { print(“Adjusting Wind”); }</p>
<p>​       void clearSpitValve() { print(“Wind clearing spit valve”); }</p>
<p>}</p>
<p>class Percussion extends Instrument {</p>
<p>​       void play(Note n) { print(“Percussion.play() “ + n); }</p>
<p>​       public String toString() { return “Percussion”; }</p>
<p>​       void adjust() { print(“Adjusting Percussion”); } </p>
<p>}</p>
<p>class Stringed extends Instrument {</p>
<p>​       void play(Note n) { print(“Stringed.play() “ + n); }</p>
<p>​       public String toString() { return “Stringed”; }</p>
<p>​       void adjust() { print(“Adjusting Stringed”); } </p>
<p>}</p>
<p>class Keyboard extends Instrument {</p>
<p>​       void play(Note n) { print(“Keyboard.play() “ + n); }</p>
<p>​       public String toString() { return “Keyboard”; }</p>
<p>​       void adjust() { print(“Adjusting Keyboard”); } </p>
<p>}</p>
<p>class Brass extends Wind {</p>
<p>​       void play(Note n) { print(“Brass.play() “ + n); }</p>
<p>​       public String toString() { return “Brass”; }</p>
<p>​       void adjust() { print(“Adjusting Brass”); }</p>
<p>​       void clearSpitValve() { print(“Brass clearing spit valve”); }</p>
<p>}</p>
<p>class Woodwind extends Wind {</p>
<p>​       void play(Note n) { print(“Woodwind.play() “ + n); }</p>
<p>​       public String toString() { return “Woodwind”; }</p>
<p>​       void clearSpitValve() { print(“Woodwind clearing spit valve”); }</p>
<p>}</p>
<p>class Piano extends Keyboard {</p>
<p>​       void play(Note n) { print(“Piano.play() “ + n); }</p>
<p>​       public String toString() { return “Piano”; }</p>
<p>}</p>
<p>public class Music26 {</p>
<p>​                   public static void tune(Instrument i) {</p>
<p>​                           i.play(Note.MIDDLE_C);</p>
<p>​       }</p>
<p>​       public static void tuneAll(Instrument[] e) {</p>
<p>​              for(Instrument i : e)</p>
<p>​                     tune(i);</p>
<p>​       }</p>
<p>​       private static RandomInstrumentGenerator gen = new RandomInstrumentGenerator();    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           Instrument[] orchestra = new Instrument[20];</p>
<p>​                           for(int i = 0; i &lt; orchestra.length; i++)</p>
<p>​                     orchestra[i] = gen.next();</p>
<p>​              for(Instrument i : orchestra) {</p>
<p>​                     if(i instanceof Wind)                         ((Wind)i).clearSpitValve();</p>
<p>​                     i.adjust();</p>
<p>​              }</p>
<p>​              tuneAll(orchestra);</p>
<p>​       }</p>
<p>}</p>
<p>class Instrument {</p>
<p>​       void play(Note n) { print(“Instrument.play() “ + n); }</p>
<p>​       public String toString() { return “Instrument”; }</p>
<p>​       void adjust() { print(“Adjusting Instrument”); }</p>
<p>}</p>
<p>class Wind extends Instrument {</p>
<p>​       void play(Note n) { print(“Wind.play() “ + n); }</p>
<p>​       public String toString() { return “Wind”; }</p>
<p>​       void adjust() { print(“Adjusting Wind”); }</p>
<p>​       void clearSpitValve() { print(“Wind clearing spit valve”); }</p>
<p>}</p>
<p>class Percussion extends Instrument {</p>
<p>​       void play(Note n) { print(“Percussion.play() “ + n); }</p>
<p>​       public String toString() { return “Percussion”; }</p>
<p>​       void adjust() { print(“Adjusting Percussion”); } </p>
<p>}</p>
<p>class Stringed extends Instrument {</p>
<p>​       void play(Note n) { print(“Stringed.play() “ + n); }</p>
<p>​       public String toString() { return “Stringed”; }</p>
<p>​       void adjust() { print(“Adjusting Stringed”); } </p>
<p>}</p>
<p>class Keyboard extends Instrument {</p>
<p>​       void play(Note n) { print(“Keyboard.play() “ + n); }</p>
<p>​       public String toString() { return “Keyboard”; }</p>
<p>​       void adjust() { print(“Adjusting Keyboard”); } </p>
<p>}</p>
<p>class Brass extends Wind {</p>
<p>​       void play(Note n) { print(“Brass.play() “ + n); }</p>
<p>​       public String toString() { return “Brass”; }</p>
<p>​       void adjust() { print(“Adjusting Brass”); }</p>
<p>​       void clearSpitValve() { print(“Brass clearing spit valve”); }</p>
<p>}</p>
<p>class Woodwind extends Wind {</p>
<p>​       void play(Note n) { print(“Woodwind.play() “ + n); }</p>
<p>​       public String toString() { return “Woodwind”; }</p>
<p>​       void clearSpitValve() { print(“Woodwind clearing spit valve”); }</p>
<p>}</p>
<p>class Piano extends Keyboard {</p>
<p>​       void play(Note n) { print(“Piano.play() “ + n); }</p>
<p>​       public String toString() { return “Piano”; }</p>
<p>}</p>
<p>public class Music26 {</p>
<p>​                   public static void tune(Instrument i) {</p>
<p>​                           i.play(Note.MIDDLE_C);</p>
<p>​       }</p>
<p>​       public static void tuneAll(Instrument[] e) {</p>
<p>​              for(Instrument i : e)</p>
<p>​                     tune(i);</p>
<p>​       }</p>
<p>​       private static RandomInstrumentGenerator gen = new RandomInstrumentGenerator();    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           Instrument[] orchestra = new Instrument[20];</p>
<p>​                           for(int i = 0; i &lt; orchestra.length; i++)</p>
<p>​                     orchestra[i] = gen.next();</p>
<p>​              for(Instrument i : orchestra) {</p>
<p>​                     if(i instanceof Wind)                         ((Wind)i).clearSpitValve();</p>
<p>​                     i.adjust();</p>
<p>​              }</p>
<p>​              tuneAll(orchestra);</p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解问题/" itemprop="url">Java题解问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="2-1-1-练习"><a href="#2-1-1-练习" class="headerlink" title="2 . 1 1 练习"></a>2 . 1 1 练习</h2><p>(1) 参照本章的第一个例子，创建一个“Hello，World”程序，在屏幕上简单地显示这句话。注意在自己的类里只需一个方法（“main”方法会在程序启动时执行）。记住要把它设为static 形式，并置入自变量列表——即使根本不会用到这个列表。用javac 编译这个程序，再用java 运行它。</p>
<p>(2) 写一个程序，打印出从命令行获取的三个自变量。</p>
<p>(3) 找出Property.java 第二个版本的代码，这是一个简单的注释文档示例。请对文件执行javadoc，并在自己的Web 浏览器里观看结果。</p>
<p>(4) 以练习(1)的程序为基础，向其中加入注释文档。利用javadoc，将这个注释文档提取为一个HTML 文件，并用Web 浏览器观看。</p>
<h2 id="3-4-练习"><a href="#3-4-练习" class="headerlink" title="3 . 4 练习"></a>3 . 4 练习</h2><p>(1) 写一个程序，打印出1 到100 间的整数。</p>
<p>(2) 修改练习(1)，在值为47 时用一个break 退出程序。亦可换成return 试试。</p>
<p>(3) 创建一个switch 语句，为每一种case 都显示一条消息。并将switch 置入一个for 循环里，令其尝试每一种case。在每个case 后面都放置一个break，并对其进行测试。然后，删除break，看看会有什么情况出现。</p>
<h2 id="4-7-练习"><a href="#4-7-练习" class="headerlink" title="4 . 7 练习"></a>4 . 7 练习</h2><p>(1) 用默认构建器创建一个类（没有自变量），用它打印一条消息。创建属于这个类的一个对象。</p>
<p>(2) 在练习1 的基础上增加一个过载的构建器，令其采用一个String 自变量，并随同自己的消息打印出来。</p>
<p>(3) 以练习2 创建的类为基础上，创建属于它的对象句柄的一个数组，但不要实际创建对象并分配到数组里。运行程序时，注意是否打印出来自构建器调用的初始化消息。</p>
<p>(4) 创建同句柄数组联系起来的对象，最终完成练习3。</p>
<p>(5) 用自变量“before”，“after”和“none”运行程序，试验Garbage.java。重复这个操作，观察是否从输出中看出了一些固定的模式。改变代码，使System.runFinalization()在System.gc()之前调用，再观察结果。</p>
<h2 id="5-6-练习"><a href="#5-6-练习" class="headerlink" title="5 . 6 练习"></a>5 . 6 练习</h2><p>(1) 用public、private、protected 以及“友好的”数据成员及方法成员创建一个类。创建属于这个类的一个对象，并观察在试图访问所有类成员时会获得哪种类型的编译器错误提示。注意同一个目录内的类属于“默认”包的一部分。(2) 用protected 数据创建一个类。在相同的文件里创建第二个类，用一个方法操纵第一个类里的protected 数据。(3) 新建一个目录，并编辑自己的CLASSPATH，以便包括那个新目录。将P.class 文件复制到自己的新目录，然后改变文件名、P 类以及方法名（亦可考虑添加额外的输出，观察它的运行过程）。在一个不同的目录里创建另一个程序，令其使用自己的新类。</p>
<p>(4) 在c05 目录（假定在自己的CLASSPATH 里）创建下述文件：//: PackagedClass.javapackage c05;class PackagedClass {public PackagedClass() {System.out.println(“Creating a packaged class”);}} ///:<del>然后在c05 之外的另一个目录里创建下述文件：//: Foreign.javapackage c05.foreign;import c05.*;public class Foreign {public static void main (String[] args) {PackagedClass pc = new PackagedClass();}138} ///:</del>解释编译器为什么会产生一个错误。将Foreign（外部）类作为c05 包的一部分改变了什么东西吗？</p>
<h2 id="6-1-1-练习"><a href="#6-1-1-练习" class="headerlink" title="6 . 1 1 练习"></a>6 . 1 1 练习</h2><p>(1) 用默认构建器（空自变量列表）创建两个类：A 和B，令它们自己声明自己。从A 继承一个名为C 的新类，并在C 内创建一个成员B。不要为C 创建一个构建器。创建类C 的一个对象，并观察结果。</p>
<p>(2) 修改练习1，使A 和B 都有含有自变量的构建器，则不是采用默认构建器。为C 写一个构建器，并在C的构建器中执行所有初始化工作。</p>
<p>(3) 使用文件Cartoon.java ，将Cartoon 类的构建器代码变成注释内容标注出去。解释会发生什么事情。</p>
<p>(4) 使用文件Chess.java，将Chess 类的构建器代码作为注释标注出去。同样解释会发生什么。</p>
<h2 id="7-1-0-练习"><a href="#7-1-0-练习" class="headerlink" title="7 . 1 0 练习"></a>7 . 1 0 练习</h2><p>(1) 创建Rodent（啮齿动物）:Mouse（老鼠）,Gerbil（鼹鼠）,Hamster（大颊鼠）等的一个继承分级结构。在基础类中，提供适用于所有Rodent 的方法，并在衍生类中覆盖它们，从而根据不同类型的Rodent 采取不同的行动。创建一个Rodent 数组，在其中填充不同类型的Rodent，然后调用自己的基础类方法，看看会有什么情况发生。</p>
<p>(2) 修改练习1，使Rodent 成为一个接口。</p>
<p>(3) 改正WindError.java 中的问题。</p>
<p>(4) 在GreenhouseControls.java 中，添加Event 内部类，使其能打开和关闭风扇。</p>
<h2 id="8-9-练习"><a href="#8-9-练习" class="headerlink" title="8 . 9 练习"></a>8 . 9 练习</h2><p>(1) 新建一个名为Gerbil 的类，在构建器中初始化一个int gerbilNumber（类似本章的Mouse 例子）。为其写一个名为hop()的方法，用它打印出符合hop()条件的Gerbil 的编号。建一个Vector，并为Vector 添加一系列Gerbil 对象。现在，用elementAt()方法在Vector 中遍历，并为每个Gerbil 都调用hop()。</p>
<p>(2) 修改练习1，用Enumeration 在调用hop()的同时遍历Vector。</p>
<p>(3) 在AssocArray.java 中，修改这个例子，令其使用一个Hashtable，而不是AssocArray。</p>
<p>(4) 获取练习1 用到的Gerbil 类，改为把它置入一个Hashtable，然后将Gerbil 的名称作为一个String（键）与置入表格的每个Gerbil（值）都关联起来。获得用于keys()的一个Enumeration，并用它在Hashtable 里遍历，查找每个键的Gerbil，打印出键，然后将gerbil 告诉给hop()。</p>
<p>(5) 修改第7 章的练习1，用一个Vector 容纳Rodent（啮齿动物），并用Enumeration 在Rodent 序列中遍历。记住Vector 只能容纳对象，所以在访问单独的Rodent 时必须采用一个造型（如RTTI ）。</p>
<p>(6) 转到第7 章的中间位置，找到那个GreenhouseControls.java（温室控制）例子，该例应该由三个文件构成。在Controller.java 中，类EventSet 仅是一个集合。修改它的代码，用一个Stack 代替EventSet 。当然，这时可能并不仅仅用Stack 取代EventSet 这样简单；也需要用一个Enumeration 遍历事件集。可考虑在某些时候将集合当作Stack 对待，另一些时候则当作Vector 对待——这样或许能使事情变得更加简单。</p>
<p>(7) （有一定挑战性）在与所有Java 发行包配套提供的Java 源码库中找出用于Vector 的源码。复制这些代码，制作名为intVector 的一个特殊版本，只在其中包含int 数据。思考是否能为所有基本数据类型都制作Vector 的一个特殊版本。接下来，考虑假如制作一个链接列表类，令其能随同所有基本数据类型使用，那么会发生什么情况。若在Java 中提供了参数化类型，利用它们便可自动完成这一工作（还有其他许多好处）。</p>
<h2 id="9-1-0-练习"><a href="#9-1-0-练习" class="headerlink" title="9 . 1 0 练习"></a>9 . 1 0 练习</h2><p>(1) 用main()创建一个类，令其掷出try 块内的Exception 类的一个对象。为Exception 的构建器赋予一个字串参数。在catch 从句内捕获违例，并打印出字串参数。添加一个finally 从句，并打印一条消息，证明自己真正到达那里。</p>
<p>(2) 用extends 关键字创建自己的违例类。为这个类写一个构建器，令其采用String 参数，并随同String句柄把它保存到对象内。写一个方法，令其打印出保存下来的String。创建一个try-catch 从句，练习实际操作新违例。</p>
<p>(3) 写一个类，并令一个方法掷出在练习2 中创建的类型的一个违例。试着在没有违例规范的前提下编译它，观察编译器会报告什么。接着添加适当的违例规范。在一个try-catch 从句中尝试自己的类以及它的违例。</p>
<p>(4) 在第5 章，找到调用了Assert.java 的两个程序，并修改它们，令其掷出自己的违例类型，而不是打印到System.err。该违例应是扩展了RuntimeException 的一个内部类。</p>
<h2 id="1-0-1-1-练习"><a href="#1-0-1-1-练习" class="headerlink" title="1 0 . 1 1 练习"></a>1 0 . 1 1 练习</h2><p>(1) 打开一个文本文件，每次读取一行内容。将每行作为一个String 读入，并将那个String 对象置入一个Vector 里。按相反的顺序打印出Vector 中的所有行。</p>
<p>(2) 修改练习1，使读取那个文件的名字作为一个命令行参数提供。</p>
<p>(3) 修改练习2，又打开一个文本文件，以便将文字写入其中。将Vector 中的行随同行号一起写入文件。</p>
<p>(4) 修改练习2，强迫Vector 中的所有行都变成大写形式，将结果发给System.out。</p>
<p>(5) 修改练习2，在文件中查找指定的单词。打印出包含了欲找单词的所有文本行。</p>
<p>(6) 在Blips.java 中复制文件，将其重命名为BlipCheck.java。然后将类Blip2 重命名为BlipCheck（在进程中将其标记为public）。删除文件中的//!记号，并执行程序。接下来，将BlipCheck 的默认构建器变成注释信息。运行它，并解释为什么仍然能够工作。</p>
<p>(7) 在Blip3.java 中，将接在“You must do this:”字样后的两行变成注释，然后运行程序。解释得到的结果为什么会与执行了那两行代码不同。</p>
<p>(8) 转换SortedWordCount.java 程序，以便使用Java 1.1 IO 流。</p>
<p>(9) 根据本章正文的说明修改程序CADState.java。</p>
<p>(10) 在第7 章（中间部分）找到GreenhouseControls.java 示例，它应该由三个文件构成。在GreenhouseControls.java 中，Restart()内部类有一个硬编码的事件集。请修改这个程序，使其能从一个文本文件里动态读取事件以及它们的相关时间。</p>
<h2 id="1-1-5-练习"><a href="#1-1-5-练习" class="headerlink" title="1 1 . 5 练习"></a>1 1 . 5 练习</h2><p>(1) 写一个方法，向它传递一个对象，循环打印出对象层次结构中的所有类。</p>
<p>(2) 在ToyTest.java 中，将Toy 的默认构建器标记成注释信息，解释随之发生的事情。</p>
<p>(3) 新建一种类型的集合，令其使用一个Vector。捕获置入其中的第一个对象的类型，然后从那时起只允许用户插入那种类型的对象。</p>
<p>(4) 写一个程序，判断一个Char 数组属于基本数据类型，还是一个真正的对象。</p>
<p>(5) 根据本章的说明，实现clearSpitValve()。</p>
<p>(6) 实现本章介绍的rotate(Shape)方法，令其检查是否已经旋转了一个圆（若已旋转，就不再执行旋转操作）。</p>
<h2 id="1-2-6-练习"><a href="#1-2-6-练习" class="headerlink" title="1 2 . 6 练习"></a>1 2 . 6 练习</h2><p>(1) 创建一个myString 类，在其中包含了一个String 对象，以便用在构建器中用构建器的自变量对其进行初始化。添加一个toString()方法以及一个concatenate()方法，令其将一个String 对象追加到我们的内部字串。在myString 中实现clone()。创建两个static 方法，每个都取得一个myString x 句柄作为自己的自变量，并调用x.concatenate(“test”)。但在第二个方法中，请首先调用clone()。测试这两个方法，观察它们不同的结果。</p>
<p>(2) 创建一个名为Battery（电池）的类，在其中包含一个int，用它表示电池的编号（采用独一无二的标识符的形式）。接下来，创建一个名为Toy 的类，其中包含了一个Battery 数组以及一个toString，用于打印出所有电池。为Toy 写一个clone()方法，令其自动关闭所有Battery 对象。克隆Toy 并打印出结果，完成对它的测试。</p>
<p>(3) 修改CheckCloneable.java，使所有clone()方法都能捕获CloneNotSupportException 违例，而不是把它直接传递给调用者</p>
<p>(4) 修改Compete.java，为Thing2 和Thing4 类添加更多的成员对象，看看自己是否能判断计时随复杂性变化的规律——是一种简单的线性关系，还是看起来更加复杂。(5) 从Snake.java 开始，创建Snake 的一个深层复制版本。 </p>
<h2 id="1-3-2-1-练习"><a href="#1-3-2-1-练习" class="headerlink" title="1 3 . 2 1 练习"></a>1 3 . 2 1 练习</h2><p>(1)创建一个有文字字段和三个按钮的程序片。当我们按下每个按钮时，使不同的文字显示在文字段中。</p>
<p>(2)增加一个复选框到练习1 创建的程序中，捕捉事件，并插入不同的文字到文字字段中。</p>
<p>(3)创建一个程序片并增加所有导致action() 被调用的组件，然后捕捉他们的事件并在文字字段中为每个组件显示一个特定的消息。</p>
<p>(4)增加可以被handleEvent()方法测试事件的组件到练习3 中。过载handleEvent()并在文字字段中为每个组件显示特定的消息。</p>
<p>(5)创建一个有一个按钮和一个TextField 的程序片。编写一个handleEvent()，以便如果按钮有焦点，输入字符到将显示的TextField 中。</p>
<p>(6)创建一个应用程序并将本章所有的组件增加主要的帧，包括菜单和对话框。</p>
<p>(7)修改TextNew.java，以便字母在t2 中保持输入时的样子，取代自动变成大写。</p>
<p>(8)修改CardLayout1.java 以便它使用Java 1.1 的事件模型。</p>
<p>(9)增加Frog.class 到本章出现的清单文件中并运行jar 以创建一个包括Frog 和BangBean 的JAR 文件。现在从SUN 公司处下载并安装BDK 或者使用我们自己的可激活Bean 的程序构建工具并增加JAR 文件到我们的环境中，因此我们可以测试两个Bean 。</p>
<p>(10)创建我们自己的包括两个属性：一个布尔值为“on”，另一个为整型“level”，称为Valve 的JavaBean。创建一个清单文件，利用jar 打包我们的Bean，然后读入它到beanbox 或到我们自己的激活程序构建工具里，因此我们可以测试它。</p>
<p>(11)修改Menus.java，以便它处理多级菜单。这要假设读者已经熟悉了HTML 的基础知识。但那些东西并不难理解，而且有一些书和资料可供参考。    </p>
<h2 id="1-4-7-练习"><a href="#1-4-7-练习" class="headerlink" title="1 4 . 7 练习"></a>1 4 . 7 练习</h2><p>(1) 从Thread 继承一个类，并（过载）覆盖run()方法。在run()内，打印出一条消息，然后调用sleep()。重复三遍这些操作，然后从run()返回。在构建器中放置一条启动消息，并覆盖finalize()，打印一条关闭消息。创建一个独立的线程类，使它在run()内调用System.gc()和System.runFinalization()，并打印一条消息，表明调用成功。创建这两种类型的几个线程，然后运行它们，看看会发生什么。</p>
<p>(2) 修改Counter2.java，使线程成为一个内部类，而且不需要明确保存指向Counter2 的一个。</p>
<p>(3) 修改Sharing2.java，在TwoCounter 的run()方法内部添加一个synchronized（同步）块，而不是同步整个run()方法。</p>
<h2 id="1-5-1-0-练习"><a href="#1-5-1-0-练习" class="headerlink" title="1 5 . 1 0 练习"></a>1 5 . 1 0 练习</h2><p>(1) 编译和运行本章中的JabberServer 和JabberClient 程序。接着编辑一下程序，删去为输入和输出设计的所有缓冲机制，然后再次编译和运行，观察一下结果。</p>
<p>(2) 创建一个服务器，用它请求用户输入密码，然后打开一个文件，并将文件通过网络连接传送出去。创建一个同该服务器连接的客户，为其分配适当的密码，然后捕获和保存文件。在自己的机器上用localhost（通过调用InetAddress.getByName(null)生成本地IP 地址127.0.0.1）测试这两个程序。</p>
<p>(3) 修改练习2 中的程序，令其用多线程机制对多个客户进行控制。</p>
<p>(4) 修改JabberClient，禁止输出刷新，并观察结果。</p>
<p>(5) 以ShowHTML.java 为基础，创建一个程序片，令其成为对自己Web 站点的特定部分进行密码保护的大587门。</p>
<p>(6) （可能有些难度）创建一对客户／服务器程序，利用数据报（Datagram）将一个文件从一台机器传到另一台（参见本章数据报小节末尾的叙述）。</p>
<p>(7) （可能有些难度）对VLookup.java 程序作一番修改，使我们能点击得到的结果名字，然后程序会自动取得那个名字，并把它复制到剪贴板（以便我们方便地粘贴到自己的E-mail ）。可能要回过头去研究一下IO数据流的那一章，回忆该如何使用Java 1.1 剪贴板。</p>
<h2 id="1-6-1-0-练习"><a href="#1-6-1-0-练习" class="headerlink" title="1 6 . 1 0 练习"></a>1 6 . 1 0 练习</h2><p>(1) 将SingletonPattern.java 作为起点，创建一个类，用它管理自己固定数量的对象。</p>
<p>(2) 为TrashVisitor.java 添加一个名为Plastic（塑料）的类。</p>
<p>(3) 为DynaTrash.java 同样添加一个Plastic（塑料）类。 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解注释/" itemprop="url">Java题解注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第二十章-注释"><a href="#第二十章-注释" class="headerlink" title="第二十章 注释"></a>第二十章 注释</h2><p>public class TableCreator1 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     System.out.println(“arguments: annotated classes”);</p>
<p>​                     System.exit(0);</p>
<p>​              }      </p>
<p>​              for(String className : args) {</p>
<p>​                     Class&lt;?&gt; cl = Class.forName(className);</p>
<p>​                     DBTable dbTable = cl.getAnnotation(DBTable.class);</p>
<p>​                     if(dbTable == null) {</p>
<p>​                            System.out.println(“No DBTable annotations in class “ +</p>
<p>​                                   className);</p>
<p>​                            continue;</p>
<p>​                     }</p>
<p>​                     String tableName = dbTable.name();</p>
<p>​                                         if(tableName.length() &lt; 1)</p>
<p>​                            tableName = cl.getName().toUpperCase();</p>
<p>​                     List<string> columnDefs = new ArrayList<string>();</string></string></p>
<p>​                     for(Field field : cl.getDeclaredFields()) {</p>
<p>​                            String columnName = null;</p>
<p>​                            Annotation[] anns = field.getDeclaredAnnotations();</p>
<p>​                            if(anns.length &lt; 1) continue;                          if(anns[0] instanceof SQLInteger) {</p>
<p>​                                   SQLInteger sInt = (SQLInteger) anns[0];</p>
<p>​                                                                     if(sInt.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sInt.name();</p>
<p>​                                   columnDefs.add(columnName + “ INT” +</p>
<p>​                                          getConstraints(sInt.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLString) {</p>
<p>​                                   SQLString sString = (SQLString)anns[0];</p>
<p>​                                                                     if(sString.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                           columnName = sString.name();</p>
<p>​                                   columnDefs.add(columnName + “ VARCHAR(“ + </p>
<p>​                                          sString.value() + “)” +</p>
<p>​                                          getConstraints(sString.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLBoolean) {</p>
<p>​                                   SQLBoolean sBool = (SQLBoolean) anns[0];</p>
<p>​                                                                     if(sBool.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBool.name();</p>
<p>​                                   columnDefs.add(columnName + “ BOOLEAN(“ +</p>
<p>​                                          getConstraints(sBool.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLDateTime) { </p>
<p>​                                   SQLDateTime sDateTime = (SQLDateTime)anns[0];</p>
<p>​                                                                     if(sDateTime.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sDateTime.name();</p>
<p>​                                   columnDefs.add(columnName + “ DATETIME(“ +</p>
<p>​                                          getConstraints(sDateTime.constraints()));  </p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLVarChar) {</p>
<p>​                                   SQLVarChar sVarChar = (SQLVarChar)anns[0];</p>
<p>​                                   if(sVarChar.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sVarChar.name();</p>
<p>​                                   columnDefs.add(columnName + “ VARCHAR(“ +</p>
<p>​                                          getConstraints(sVarChar.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLBlob) {</p>
<p>​                                   SQLBlob sBlob = (SQLBlob)anns[0];</p>
<p>​                                                                     if(sBlob.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBlob.name();</p>
<p>​                                   columnDefs.add(columnName + “ BLOB(“ +</p>
<p>​                                          getConstraints(sBlob.constraints()));</p>
<p>​                            }</p>
<p>​                            StringBuilder createCommand = new StringBuilder(</p>
<p>​                                   “CREATE TABLE “ + tableName + “(“);</p>
<p>​                            for(String columnDef : columnDefs)</p>
<p>​                                   createCommand.append(“\n     “ + columnDef + “,”);</p>
<p>​                                                       String tableCreate = createCommand.substring(</p>
<p>​                                   0, createCommand.length() - 1) +”);”;</p>
<p>​                            System.out.println(“Table Creation SQL for “ + </p>
<p>​                                   className + “ is :\n” + tableCreate);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       private static String getConstraints(Constraints con) {</p>
<p>​              String  constraints = “”;</p>
<p>​              if(!con.allowNull()) constraints += “ NOT NULL”;</p>
<p>​              if(con.primaryKey()) constraints += “ PRIMARY KEY”;</p>
<p>​              if(con.unique()) constraints += “ UNIQUE”;</p>
<p>​              return constraints;</p>
<p>​       }</p>
<p>}      </p>
<p>@ExtractInterface(“IDivider”)</p>
<p>public class Divider {</p>
<p>​       public int divide(int x, int y) throws ArithmeticException {</p>
<p>​              if(y == 0) throw new ArithmeticException(“Divide by zero”);</p>
<p>​              int diff = subtract(x, y);</p>
<p>​              if(diff &lt; 0) return 0;</p>
<p>​              if(diff == 0) return 1;</p>
<p>​              int result = 0;</p>
<p>​              while(diff &gt;= 0) {</p>
<p>​                     result++;</p>
<p>​                     diff = subtract(diff, y);                        </p>
<p>​              }</p>
<p>​              return result;</p>
<p>​       }</p>
<p>​       private int subtract(int x, int y) { return x - y; }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              try {</p>
<p>​              Divider d = new Divider();</p>
<p>​              print(“11              print(“10              print(“10              print(“10              print(“10              print(“10              } catch(Exception e)  {</p>
<p>​                     print(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class TableCreationProcessorFactory3 implements AnnotationProcessorFactory {</p>
<p>​       public AnnotationProcessor getProcessorFor(</p>
<p>​              Set<annotationtypedeclaration> atds, AnnotationProcessorEnvironment env) {</annotationtypedeclaration></p>
<p>​              return new TableCreationProcessor(env);</p>
<p>​       }</p>
<p>​       public Collection<string> supportedAnnotationTypes() {</string></p>
<p>​              return Arrays.asList(</p>
<p>​                     “annotations.database.DBTable”,</p>
<p>​                     “annotations.database.Constraints”,</p>
<p>​                     “annotations.database.SQLString”,</p>
<p>​                     “annotations.database.SQLInteger”,</p>
<p>​                     “annotations.database.SQLBoolean”,</p>
<p>​                     “annotations.database.SQLVarChar”,</p>
<p>​                     “annotations.database.SQLDateTime”,</p>
<p>​                     “annotations.database.SQLBlob”);</p>
<p>​       }</p>
<p>​       public Collection<string> supportedOptions() {</string></p>
<p>​              return Collections.emptySet();</p>
<p>​       }</p>
<p>​       private static class TableCreationProcessor implements AnnotationProcessor {</p>
<p>​              private final AnnotationProcessorEnvironment env;</p>
<p>​              private String sql = “”;</p>
<p>​              public TableCreationProcessor(AnnotationProcessorEnvironment env) {</p>
<p>​                     this.env = env;</p>
<p>​              } </p>
<p>​              public void process() {</p>
<p>​                     for(TypeDeclaration typeDecl : env.getSpecifiedTypeDeclarations()) {</p>
<p>​                            typeDecl.accept(getDeclarationScanner(new TableCreationVisitor(), NO_OP));</p>
<p>​                            sql = sql.substring(0, sql.length() - 1) + “);”;</p>
<p>​                            System.out.println(“creation SQL is :\n” + sql);</p>
<p>​                            sql = “”;</p>
<p>​                     }</p>
<p>​              }      </p>
<p>​              private class TableCreationVisitor extends SimpleDeclarationVisitor {</p>
<p>​                     public void visitClassDeclaration(ClassDeclaration d) {</p>
<p>​                            DBTable dbTable = d.getAnnotation(DBTable. class);</p>
<p>​                            if(dbTable != null) {</p>
<p>​                                   sql += “CREATE TABLE “;</p>
<p>​                                   sql += (dbTable.name().length() &lt; 1) ? </p>
<p>​                                          d.getSimpleName().toUpperCase() : dbTable.name();</p>
<p>​                                   sql += “ (“;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​                     public void visitFieldDeclaration(FieldDeclaration d) {</p>
<p>​                            String columnName = “”;</p>
<p>​                            if(d.getAnnotation(SQLInteger.class) != null) {</p>
<p>​                                   SQLInteger sInt = d.getAnnotation(SQLInteger.class);</p>
<p>​                                                                     if(sInt.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sInt.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ INT” + </p>
<p>​                                          getConstraints(sInt.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLString.class) != null) {</p>
<p>​                                   SQLString sString = d.getAnnotation(SQLString.class);</p>
<p>​                                                                     if(sString.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sString.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ VARCHAR(“ + </p>
<p>​                                          sString.value() + “)” +</p>
<p>​                                          getConstraints(sString.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLBoolean.class) != null) {</p>
<p>​                                   SQLBoolean sBoolean = d.getAnnotation(SQLBoolean.class);</p>
<p>​                                                                     if(sBoolean.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBoolean.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ BOOLEAN(“ +</p>
<p>​                                          getConstraints(sBoolean.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLVarChar.class) != null) {</p>
<p>​                                   SQLVarChar sVarChar = d.getAnnotation(SQLVarChar.class);</p>
<p>​                                                                     if(sVarChar.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sVarChar.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ VARCHAR(“ +</p>
<p>​                                          getConstraints(sVarChar.constraints()) + “,”;     </p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLDateTime.class) != null) {</p>
<p>​                                   SQLDateTime sDateTime = d.getAnnotation(SQLDateTime.class);</p>
<p>​                                   if(sDateTime.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sDateTime.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ DATETIME(“ +</p>
<p>​                                          getConstraints(sDateTime.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLBlob.class) != null) {</p>
<p>​                                   SQLBlob sBlob = d.getAnnotation(SQLBlob.class);</p>
<p>​                                   if(sBlob.name().length()&lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBlob.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ BLOB(“ +</p>
<p>​                                          getConstraints(sBlob.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​                     private String getConstraints(Constraints con) {</p>
<p>​                            String constraints = “”;</p>
<p>​                            if(!con.allowNull())  constraints += “ NOT NULL”;</p>
<p>​                            if(con.primaryKey())  constraints += “ PRIMARY KEY”;</p>
<p>​                            if(con.unique()) constraints += “ UNIQUE”;</p>
<p>​                            return constraints;</p>
<p>​                     }</p>
<p>​              }      </p>
<p>​       }</p>
<p>}</p>
<p>public class AtUnitComposition4 {</p>
<p>​       AtUnitExampleEx4 testObject = new AtUnitExampleEx4();</p>
<p>​       @Test boolean _methodOne() { </p>
<p>​              return testObject.methodOne().equals(“This is methodOne”);</p>
<p>​       }</p>
<p>​       @Test boolean _methodTwo() {</p>
<p>​              return testObject.methodTwo() == 2;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit AtUnitComposition4”);</p>
<p>​       }</p>
<p>}</p>
<p>public class HashSetTest5 extends HashSet<string> {   @Test void initialization() {</string></p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              this.add(“one”);</p>
<p>​              assert this.contains(“one”);</p>
<p>​       }      </p>
<p>​       @Test void _remove() {</p>
<p>​              this.add(“one”);</p>
<p>​              this.remove(“one”);</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit HashSetTest5”);</p>
<p>​       }</p>
<p>}</p>
<p>public class LinkedListTest6 {</p>
<p>​       LinkedList<string> testObject = new LinkedList<string>();</string></string></p>
<p>​       @Test void initialization() {</p>
<p>​              assert testObject.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              testObject.add(“one”);</p>
<p>​              assert testObject.contains(“one”);</p>
<p>​       }</p>
<p>​       @Test void _remove() {</p>
<p>​              testObject.add(“one”);</p>
<p>​              testObject.remove(“one”);</p>
<p>​              assert testObject.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit LinkedListTest6”);</p>
<p>​       }</p>
<p>}</p>
<p>public class LinkedListTest7 extends LinkedList<string> {</string></p>
<p>​       @Test void initialization() {</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              this.add(“one”);</p>
<p>​              assert this.contains(“one”);</p>
<p>​       }</p>
<p>​       @Test void _remove() {</p>
<p>​              this.add(“one”);</p>
<p>​              this.remove(“one”);</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit LinkedListTest7”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex8Test extends Ex8 {</p>
<p>​       @Test boolean _methodOneCall() { </p>
<p>​              return methodOneCall().equals(“methodOne”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit Ex8Test”);</p>
<p>​       }</p>
<p>}</p>
<p>public class HashMapTest9 extends HashMap&lt;Integer,String&gt; {</p>
<p>​       @Test void _put() {</p>
<p>​              put(1, “Hi”);</p>
<p>​              assert get(1).equals(“Hi”);</p>
<p>​       }</p>
<p>​       @Test void _containsKey() {</p>
<p>​              put(2, “Bye”);</p>
<p>​              assert containsKey(2);</p>
<p>​       }</p>
<p>​       @Test void _containsValue() {</p>
<p>​              put(3, “yes”);</p>
<p>​              assert containsValue(“yes”);</p>
<p>​       }</p>
<p>​       @Test void _get() {</p>
<p>​              put(4, “hello”);</p>
<p>​              assert get(4).equals(“hello”);</p>
<p>​       }</p>
<p>​       @Test void _size() {</p>
<p>​              assert size() == 0;</p>
<p>​       }</p>
<p>​       @Test void _clear() {</p>
<p>​              put(5, “so long”);</p>
<p>​              clear();</p>
<p>​              assert size() == 0;</p>
<p>​       }             </p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit HashMapTest9”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Element10 {</p>
<p>​       private String ident;</p>
<p>​       public Element10(String id) { ident = id; }</p>
<p>​       public String toString() { return ident; }</p>
<p>​       public int hashCode() { return ident.hashCode(); }</p>
<p>​       public boolean equals(Object r) {</p>
<p>​              return r instanceof Element10 &amp;&amp;</p>
<p>​                     ident.equals(((Element10)r).ident);</p>
<p>​       }</p>
<p>​       protected void finalize() {</p>
<p>​              System.out.println(“Finalizing “ + </p>
<p>​              getClass().getSimpleName() + “ “ + ident);</p>
<p>​       }</p>
<p>​       @TestObjectCreate static Element10 create() {</p>
<p>​              return new Element10(“hi”);</p>
<p>​       }</p>
<p>​       @Test void _hashCode() {</p>
<p>​              String s = “hi”;</p>
<p>​              assert hashCode() == s.hashCode(); </p>
<p>​       }</p>
<p>​       @Test void _equals() {</p>
<p>​              Element10 e = new Element10(“hi”);</p>
<p>​              assert this.equals(e);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit Element10”);</p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解并发/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解并发/" itemprop="url">Java题解并发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第二十一章-并发"><a href="#第二十一章-并发" class="headerlink" title="第二十一章 并发"></a>第二十一章 并发</h2><p>class Ex1RunnerA implements Runnable {</p>
<p>​       public Ex1RunnerA() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerA”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerA”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerA task complete.”);</p>
<p>​              return;                         </p>
<p>​       }</p>
<p>}</p>
<p>class Ex1RunnerB implements Runnable {</p>
<p>​       public Ex1RunnerB() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerB”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerB”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerB task complete.”);</p>
<p>​              return;</p>
<p>​       }</p>
<p>}</p>
<p>class Ex1RunnerC implements Runnable {</p>
<p>​       public Ex1RunnerC() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerC”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerC”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerC task complete.”);</p>
<p>​              return;    </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex1 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Thread ta = new Thread(new Ex1RunnerA());           </p>
<p>​              Thread tb = new Thread(new Ex1RunnerB());           </p>
<p>​              Thread tc = new Thread(new Ex1RunnerC());</p>
<p>​              ta.start();</p>
<p>​              tb.start();</p>
<p>​              tc.start();</p>
<p>​       }</p>
<p>}      </p>
<p>class Ex1RunnerA implements Runnable {</p>
<p>​       public Ex1RunnerA() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerA”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerA”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerA task complete.”);</p>
<p>​              return;                         </p>
<p>​       }</p>
<p>}</p>
<p>class Ex1RunnerB implements Runnable {</p>
<p>​       public Ex1RunnerB() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerB”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerB”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerB task complete.”);</p>
<p>​              return;</p>
<p>​       }</p>
<p>}</p>
<p>class Ex1RunnerC implements Runnable {</p>
<p>​       public Ex1RunnerC() {</p>
<p>​              System.out.println(“Constructing Ex1RunnerC”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex1RunnerC”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex1RunnerC task complete.”);</p>
<p>​              return;    </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex1 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Thread ta = new Thread(new Ex1RunnerA());           </p>
<p>​              Thread tb = new Thread(new Ex1RunnerB());           </p>
<p>​              Thread tc = new Thread(new Ex1RunnerC());</p>
<p>​              ta.start();</p>
<p>​              tb.start();</p>
<p>​              tc.start();</p>
<p>​       }</p>
<p>}      </p>
<p>class Ex3RunnerA implements Runnable {</p>
<p>​       public Ex3RunnerA() {</p>
<p>​              System.out.println(“Constructing Ex3RunnerA”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex3RunnerA”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex3RunnerA task complete.”);</p>
<p>​              return;                         </p>
<p>​       }</p>
<p>}</p>
<p>class Ex3RunnerB implements Runnable {</p>
<p>​       public Ex3RunnerB() {</p>
<p>​              System.out.println(“Constructing Ex3RunnerB”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex3RunnerB”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex3RunnerB task complete.”);</p>
<p>​              return;</p>
<p>​       }</p>
<p>}</p>
<p>class Ex3RunnerC implements Runnable {</p>
<p>​       public Ex3RunnerC() {</p>
<p>​              System.out.println(“Constructing Ex3RunnerC”);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 3; i++) {</p>
<p>​                     System.out.println(“Hi from Ex3RunnerC”);       </p>
<p>​                     Thread.yield();</p>
<p>​              }</p>
<p>​              System.out.println(“Ex3RunnerC task complete.”);</p>
<p>​              return;    </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex3 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec1 = Executors.newCachedThreadPool();</p>
<p>​              exec1.execute(new Ex3RunnerA());</p>
<p>​              exec1.execute(new Ex3RunnerB());</p>
<p>​              exec1.execute(new Ex3RunnerC());</p>
<p>​              exec1.shutdown();</p>
<p>​              ExecutorService exec2 = Executors.newFixedThreadPool(3);</p>
<p>​              exec2.execute(new Ex3RunnerA());</p>
<p>​              exec2.execute(new Ex3RunnerB());</p>
<p>​              exec2.execute(new Ex3RunnerC());</p>
<p>​              exec2.shutdown();</p>
<p>​              ExecutorService exec3 = Executors.newSingleThreadExecutor();</p>
<p>​              exec3.execute(new Ex3RunnerA());</p>
<p>​              exec3.execute(new Ex3RunnerB());</p>
<p>​              exec3.execute(new Ex3RunnerC());</p>
<p>​              exec3.shutdown();</p>
<p>​       }</p>
<p>}      </p>
<p>class Ex4FibonacciA implements Runnable {</p>
<p>​       private int n = 0;</p>
<p>​       public Ex4FibonacciA(int n) {</p>
<p>​              this.n = n;</p>
<p>​       }</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; n; i++)</p>
<p>​                     print(fib(i) + “ “);</p>
<p>​                     println();         </p>
<p>​       }</p>
<p>}</p>
<p>class Ex4FibonacciB implements Runnable {</p>
<p>​       private int n = 0;</p>
<p>​       public Ex4FibonacciB(int n) {</p>
<p>​              this.n = n;</p>
<p>​       }</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; n; i++)</p>
<p>​                     print(fib(i) + “ “);</p>
<p>​                     println();         </p>
<p>​       }</p>
<p>}</p>
<p>class Ex4FibonacciC implements Runnable {</p>
<p>​       private int n = 0;</p>
<p>​       public Ex4FibonacciC(int n) {</p>
<p>​              this.n = n;</p>
<p>​       }</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; n; i++)</p>
<p>​                     print(fib(i) + “ “);    </p>
<p>​                     println();  </p>
<p>​       }</p>
<p>}</p>
<p>class Ex4FibonacciD implements Runnable {</p>
<p>​       private int n = 0;</p>
<p>​       public Ex4FibonacciD(int n) {</p>
<p>​              this.n = n;</p>
<p>​       }</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; n; i++)</p>
<p>​                     print(fib(i) + “ “);    </p>
<p>​                     println();  </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex4 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec1 = Executors.newCachedThreadPool();</p>
<p>​              exec1.execute(new Ex4FibonacciA(15));             </p>
<p>​              exec1.execute(new Ex4FibonacciB(15));             </p>
<p>​              exec1.execute(new Ex4FibonacciC(15));</p>
<p>​              exec1.execute(new Ex4FibonacciD(15));</p>
<p>​              exec1.shutdown();        </p>
<p>​              ExecutorService exec2 = Executors.newFixedThreadPool(4);</p>
<p>​              exec2.execute(new Ex4FibonacciA(15));             </p>
<p>​              exec2.execute(new Ex4FibonacciB(15));             </p>
<p>​              exec2.execute(new Ex4FibonacciC(15));</p>
<p>​              exec2.execute(new Ex4FibonacciD(15));</p>
<p>​              exec2.shutdown();</p>
<p>​              ExecutorService exec3 = Executors.newSingleThreadExecutor();</p>
<p>​              exec3.execute(new Ex4FibonacciA(15));             </p>
<p>​              exec3.execute(new Ex4FibonacciB(15));             </p>
<p>​              exec3.execute(new Ex4FibonacciC(15));</p>
<p>​              exec3.execute(new Ex4FibonacciD(15));</p>
<p>​              exec3.shutdown(); </p>
<p>​       }</p>
<p>}       </p>
<p>class Ex5Fibonacci implements Callable<integer> {</integer></p>
<p>​       private int n = 0;</p>
<p>​       public Ex5Fibonacci(int n) {</p>
<p>​              this.n = n;</p>
<p>​       }</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }</p>
<p>​       public Integer call() {</p>
<p>​              int result = 0;</p>
<p>​              for(int i = 0; i &lt; n; i++) </p>
<p>​                     result += fib(i);             </p>
<p>​              return (Integer)result;</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex5 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              ArrayList&lt;Future<integer>&gt; results = new ArrayList&lt;Future<integer>&gt;();</integer></integer></p>
<p>​              for(int i = 0; i &lt; 20; i++)</p>
<p>​                     results.add(exec.submit(new Ex5Fibonacci(i)));</p>
<p>​              for(Future<integer> fs : results)</integer></p>
<p>​                     try {</p>
<p>​                                                       System.out.println(fs.get());</p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            System.out.println(e);</p>
<p>​                            return;</p>
<p>​                     } catch(ExecutionException e) {</p>
<p>​                            System.out.println(e);    </p>
<p>​                     } finally {</p>
<p>​                            exec.shutdown();</p>
<p>​                     }                           </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex6 implements Runnable {</p>
<p>​       Random rand = new Random();</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     int t = 1000 * rand.nextInt(10);</p>
<p>​                     TimeUnit.MILLISECONDS.sleep(t);       </p>
<p>​                     System.out.println(“Slept “ + t                  return;                  </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     System.err.println(“Interrupted”);</p>
<p>​              }</p>
<p>​              </p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     System.out.println(“Usage: enter a number”);</p>
<p>​              }             </p>
<p>​              if(args.length == 1) {</p>
<p>​                     int n = Integer.parseInt(args[0]);</p>
<p>​                     ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​                     for(int i = 0; i &lt; n; i++)</p>
<p>​                            exec.execute(new Ex6());</p>
<p>​                     exec.shutdown();</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Daemon implements Runnable {</p>
<p>​       private Thread[] t = new Thread[30];</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; t.length; i++) {</p>
<p>​                     t[i] = new Thread(new DaemonSpawn());</p>
<p>​                     t[i].start();</p>
<p>​                     printnb(“DaemonSpawn “ + i + “ started, “);</p>
<p>​              }</p>
<p>​              for(int i = 0; i &lt; t.length; i++)</p>
<p>​                     printnb(“t[“ + i + “].isDaemon() = “ + </p>
<p>​                            t[i].isDaemon() + “, “);</p>
<p>​              while(true)</p>
<p>​                     Thread.yield();</p>
<p>​       }</p>
<p>}</p>
<p>class DaemonSpawn implements Runnable {</p>
<p>​       public void run() {</p>
<p>​              while(true)</p>
<p>​                     Thread.yield();</p>
<p>​       }</p>
<p>}</p>
<p>public class Daemons7 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              Thread d = new Thread(new Daemon());</p>
<p>​              d.setDaemon(true);</p>
<p>​              d.start();</p>
<p>​              printnb(“d.isDaemon() = “ + d.isDaemon() + “, “);</p>
<p>​                                 }</p>
<p>}</p>
<p>public class MoreBasicThreads8 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              try {                     for(int i = 0; i &lt; 25; i++) { </p>
<p>​                            Thread t = new Thread(new LiftOff());</p>
<p>​                            t.setDaemon(true);</p>
<p>​                            t.start();                        </p>
<p>​                     }</p>
<p>​                     System.out.println(“Waiting for LiftOff”);    </p>
<p>​              </p>
<p>​              } finally {</p>
<p>​                     System.out.println(“Finally out of main”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class SimplePriorities9ThreadFactory implements ThreadFactory {</p>
<p>​       Random rand = new Random();</p>
<p>​       public Thread newThread(Runnable r) {</p>
<p>​              Thread t = new Thread(r);</p>
<p>​              int i = rand.nextInt(3);</p>
<p>​              switch(i) {</p>
<p>​                     case 0 : t.setPriority(MIN_PRIORITY); break;</p>
<p>​                     case 1 : t.setPriority(NORM_PRIORITY); break;</p>
<p>​                     case 2 : t.setPriority(MAX_PRIORITY); break;</p>
<p>​                     default:   </p>
<p>​              }</p>
<p>​              return t;  </p>
<p>​       }</p>
<p>}</p>
<p>public class SimplePriorities9 implements Runnable {</p>
<p>​       private int countDown = 5;</p>
<p>​       private volatile double d;   public String toString() {</p>
<p>​              return Thread.currentThread() + “: “ + countDown;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              while(true) {</p>
<p>​                                         for(int i = 0; i &lt; 100000; i++) {</p>
<p>​                            d += (Math.PI + Math.E)                         if(i % 1000 == 0)</p>
<p>​                                   Thread.yield();</p>
<p>​                     } </p>
<p>​              System.out.println(this);</p>
<p>​              if(–countDown == 0) return;</p>
<p>​              }             </p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              ExecutorService exec = </p>
<p>​                     Executors.newCachedThreadPool(new SimplePriorities9ThreadFactory());</p>
<p>​              for(int i = 0; i &lt; 5; i++)</p>
<p>​                     exec.execute(new SimplePriorities9());</p>
<p>​              exec.execute(new SimplePriorities9());</p>
<p>​              exec.shutdown();</p>
<p>​                     </p>
<p>​       }</p>
<p>}</p>
<p>class Ex10Fibonacci implements Callable<integer> {</integer></p>
<p>​       private Integer n = 0;</p>
<p>​       ExecutorService exec = Executors.newSingleThreadExecutor();</p>
<p>​       private int fib(int x) {</p>
<p>​              if(x &lt; 2) return 1;</p>
<p>​              return fib(x - 2) + fib(x - 1);</p>
<p>​       }      </p>
<p>​       public Integer call() {</p>
<p>​              int result = 0;</p>
<p>​              for(int i = 0; i &lt; n; i++) </p>
<p>​                     result += fib(i);             </p>
<p>​              return (Integer)result;</p>
<p>​       }</p>
<p>​       public Future<integer> runTask(Integer n) {</integer></p>
<p>​              this.n = n;      </p>
<p>​              return exec.submit(this);              </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex10 {</p>
<p>​       public static void main(String[] args) {       </p>
<p>​              Ex10Fibonacci fib = new Ex10Fibonacci();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 15; i++) {</p>
<p>​                            print(“Sum of first “ + i + </p>
<p>​                                   “ Fibonacci numbers = “);</p>
<p>​                            println(fib.runTask(i).get());</p>
<p>​                     }                    </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     System.out.println(e);</p>
<p>​                     return;</p>
<p>​              } catch(ExecutionException e) {</p>
<p>​                     System.out.println(e);    </p>
<p>​              } finally {</p>
<p>​                     fib.exec.shutdown();</p>
<p>​              }                    </p>
<p>​       }</p>
<p>}</p>
<p>abstract class NumRangeGenerator {       private volatile boolean canceled = false;</p>
<p>​       public abstract int[] next(); </p>
<p>​       public void cancel() { canceled = true; }</p>
<p>​       public boolean isCanceled() { return canceled; }</p>
<p>}</p>
<p>class NumRangeChecker11 implements Runnable {      private NumRangeGenerator generator;</p>
<p>​       private final int id;</p>
<p>​       public NumRangeChecker11(NumRangeGenerator g, int ident) {</p>
<p>​              generator = g;</p>
<p>​              id = ident;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              System.out.println(“Testing..”);</p>
<p>​              while(!generator.isCanceled()) {</p>
<p>​                     int[] range = generator.next();</p>
<p>​                    if( range[0] &gt; range[1]) {</p>
<p>​                            System.out.println(“Error in test #” + id + “: min “ + range[0] </p>
<p>​                                   + “ &gt; “ + “max “ + range[1] );</p>
<p>​                            generator.cancel();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public static void test(NumRangeGenerator gen, int count) {</p>
<p>​              System.out.println(“Press Ctrl-C to exit”);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; count; i++) </p>
<p>​                     exec.execute(new NumRangeChecker11(gen, i));            </p>
<p>​              exec.shutdown();</p>
<p>​       }</p>
<p>​       public static void test(NumRangeGenerator gen) {</p>
<p>​              test(gen, 10);</p>
<p>​       }</p>
<p>}</p>
<p>public class NumRangeGenerator11 extends NumRangeGenerator {</p>
<p>​       private int min = 0;</p>
<p>​       private int max = 0;</p>
<p>​       private int[] range = { min, max };</p>
<p>​       private Random rand = new Random();</p>
<p>​       public int[] next() {             min = rand.nextInt(100);</p>
<p>​              max = rand.nextInt(100);</p>
<p>​              Thread.yield();</p>
<p>​              if(min &gt; max) max = min;</p>
<p>​              int[] ia = { min, max };</p>
<p>​              return ia;</p>
<p>​       }      </p>
<p>​       public static void main(String[] args) {</p>
<p>​              NumRangeChecker11.test(new NumRangeGenerator11());</p>
<p>​       }</p>
<p>}</p>
<p>public class AtomicityTest12 implements Runnable {</p>
<p>​       private int i = 0;</p>
<p>​       public synchronized int getValue() { return i; }</p>
<p>​       private synchronized void evenIncrement() { i++; i++; } </p>
<p>​       public void run() {</p>
<p>​              while(true) {</p>
<p>​                     evenIncrement();</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              AtomicityTest12 at = new AtomicityTest12();</p>
<p>​              exec.execute(at);</p>
<p>​              while(true) {</p>
<p>​                     int val = at.getValue();</p>
<p>​                     if(val % 2 != 0) {</p>
<p>​                            System.out.println(val);</p>
<p>​                            System.exit(0);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p> class CircularSet {</p>
<p>​       private int[] array;</p>
<p>​       private int len;</p>
<p>​       private int index = 0;</p>
<p>​       public CircularSet(int size) {</p>
<p>​              array = new int[size];</p>
<p>​              len = size;</p>
<p>​                                        for(int i = 0; i &lt; size; i++)</p>
<p>​                     array[i] = -1;</p>
<p>​       }</p>
<p>​       public synchronized void add(int i) {</p>
<p>​              array[index] = i;</p>
<p>​                           index = ++index % len;</p>
<p>​       }</p>
<p>​       public synchronized boolean contains(int val) {</p>
<p>​              for(int i = 0; i &lt; len; i++)</p>
<p>​                     if(array[i] == val) return true;</p>
<p>​              return false;</p>
<p>​       }</p>
<p>}</p>
<p>public class SerialNumberChecker13 {       </p>
<p>​       private static final int SIZE = 10;</p>
<p>​       private static CircularSet serials = new CircularSet(1000);</p>
<p>​       private static ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​       static class SerialChecker13 implements Runnable {</p>
<p>​              public void run() {</p>
<p>​                     while(true) {</p>
<p>​                            int serial = SerialNumberGenerator13.nextSerialNumber();</p>
<p>​                            if(serials.contains(serial)) {</p>
<p>​                                   System.out.println(“Duplicate: “ + serial);</p>
<p>​                                   System.exit(0);</p>
<p>​                            }</p>
<p>​                            serials.add(serial);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              for(int i = 0; i &lt; SIZE; i++)</p>
<p>​                     exec.execute(new SerialChecker13());</p>
<p>​                           if(args.length &gt; 0) {</p>
<p>​                     TimeUnit.SECONDS.sleep(new Integer(args[0]));</p>
<p>​                     System.out.println(“No duplicates detected”);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​       }      </p>
<p>}</p>
<p>public class Ex14 implements Runnable {</p>
<p>​       private static int timers = 0;</p>
<p>​       private static int tasks = 0;</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(timers &lt; 4000) {                             ++timers;</p>
<p>​                            Timer t = new Timer();         </p>
<p>​                            t.schedule(new TimerTask() {</p>
<p>​                                   public void run() {</p>
<p>​                                          ++tasks; </p>
<p>​                                          if(timers % 100 == 0)           </p>
<p>​                                                 System.out.println(timers + “ timers did “ </p>
<p>​                                                        + tasks + “ tasks”);</p>
<p>​                                   }</p>
<p>​                            }, 0);</p>
<p>​                            try {</p>
<p>​                                   TimeUnit.MILLISECONDS.sleep(30);                              } catch(InterruptedException e) {</p>
<p>​                                   System.out.println(“Sleep interrupted”);</p>
<p>​                            }</p>
<p>​                            t.cancel();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     System.out.println(“Done. “ + timers + “ timers completed “ </p>
<p>​                            + tasks + “ tasks”);</p>
<p>​              } </p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              exec.execute(new Ex14());</p>
<p>​              exec.shutdown();</p>
<p>​       }</p>
<p>}</p>
<p>class SyncTest1 {         public void f1() {</p>
<p>​              synchronized(this) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“f1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void g1() {</p>
<p>​              synchronized(this) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“g1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void h1() {</p>
<p>​              synchronized(this) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“h1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class SyncTest2 {         private Object syncObject1 = new Object();</p>
<p>​       private Object syncObject2 = new Object();</p>
<p>​       private Object syncObject3 = new Object();</p>
<p>​       public void f2() {</p>
<p>​              synchronized(syncObject1) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“f2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void g2() {</p>
<p>​              synchronized(syncObject2) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“g2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void h2() {</p>
<p>​              synchronized(syncObject3) {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“h2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex15 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              final SyncTest1 st1 = new SyncTest1();</p>
<p>​              final SyncTest2 st2 = new SyncTest2();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.f1();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.g1();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.h1();</p>
<p>​                     }</p>
<p>​              }.start();          </p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.f2();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.g2();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.h2();</p>
<p>​                     }</p>
<p>​              }.start();                 </p>
<p>​       }</p>
<p>}</p>
<p>class SyncTest1 {         private Lock lock = new ReentrantLock();</p>
<p>​       public void f1() {</p>
<p>​              lock.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“f1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock.unlock();</p>
<p>​              }             </p>
<p>​       }</p>
<p>​       public void g1() {</p>
<p>​              lock.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“g1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock.unlock();</p>
<p>​              }      </p>
<p>​       }</p>
<p>​       public void h1() {</p>
<p>​              lock.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“h1()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock.unlock();</p>
<p>​              }      </p>
<p>​       }</p>
<p>}</p>
<p>class SyncTest2 {         private Lock lock1 = new ReentrantLock();</p>
<p>​       private Lock lock2 = new ReentrantLock();</p>
<p>​       private Lock lock3 = new ReentrantLock();</p>
<p>​       </p>
<p>​       public void f2() {</p>
<p>​              lock1.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“f2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock1.unlock();</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void g2() {</p>
<p>​              lock2.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“g2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock2.unlock();</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void h2() {</p>
<p>​              lock3.lock();</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; 5; i++) {</p>
<p>​                            print(“h2()”);</p>
<p>​                            Thread.yield();</p>
<p>​                     }</p>
<p>​              } finally {</p>
<p>​                     lock3.unlock();</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex16 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              final SyncTest1 st1 = new SyncTest1();</p>
<p>​              final SyncTest2 st2 = new SyncTest2();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.f1();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.g1();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st1.h1();</p>
<p>​                     }</p>
<p>​              }.start();          </p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.f2();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.g2();</p>
<p>​                     }</p>
<p>​              }.start();</p>
<p>​              new Thread() {</p>
<p>​                     public void run() {</p>
<p>​                            st2.h2();</p>
<p>​                     }</p>
<p>​              }.start();                 </p>
<p>​       }</p>
<p>}</p>
<p>class RadCount {</p>
<p>​       private int count = 0;</p>
<p>​       private Random rand = new Random();</p>
<p>​       public synchronized int increment() {</p>
<p>​              return count++;</p>
<p>​       }</p>
<p>​       public synchronized int value() { return count; } </p>
<p>}</p>
<p>class Sensor implements Runnable {</p>
<p>​       private static RadCount count = new RadCount();</p>
<p>​       private static List<sensor> sensors = new ArrayList<sensor>();</sensor></sensor></p>
<p>​       private int number = 0;</p>
<p>​             private final int id;</p>
<p>​       private static volatile boolean canceled = false;</p>
<p>​             public static void cancel() { canceled = true; }</p>
<p>​       public Sensor(int id) {</p>
<p>​              this.id = id;</p>
<p>​                                        sensors.add(this);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              while(!canceled) {</p>
<p>​                     synchronized(this) {</p>
<p>​                            ++number;</p>
<p>​                     }</p>
<p>​                     print(this + “ Total: “ + count.increment());</p>
<p>​                     try {</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(25);</p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            print(“sleep interrupted”);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​              print(“Stopping “ + this);</p>
<p>​       }</p>
<p>​       public synchronized int getValue() { return number; }</p>
<p>​       public String toString() {</p>
<p>​              return “Sensor “ + id + “: “ + getValue();</p>
<p>​       } </p>
<p>​       public static int getTotalCount() {</p>
<p>​              return count.value();</p>
<p>​       }</p>
<p>​       public static int sumSensors() {</p>
<p>​              int sum = 0;</p>
<p>​              for(Sensor sensor : sensors)</p>
<p>​                     sum += sensor.getValue();</p>
<p>​              return sum;</p>
<p>​       }</p>
<p>}</p>
<p>public class RadiationCounter17 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     exec.execute(new Sensor(i));</p>
<p>​                           TimeUnit.SECONDS.sleep(4);</p>
<p>​              Sensor.cancel();</p>
<p>​              exec.shutdown();</p>
<p>​              if(!exec.awaitTermination(250, TimeUnit.MILLISECONDS))</p>
<p>​                     print(“Some tasks were not terminated”);</p>
<p>​              print(“Total: “ + Sensor.getTotalCount());</p>
<p>​              print(“Sum of Sensors: “ + Sensor.sumSensors());</p>
<p>​       }</p>
<p>}</p>
<p>class Nontask {</p>
<p>​       public static void rest() {</p>
<p>​              try {</p>
<p>​                     TimeUnit.SECONDS.sleep(5);</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     System.out.println(“Sleep interrupted”);</p>
<p>​              } finally {</p>
<p>​                     System.out.println(“Good Bye”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Worker implements Runnable {</p>
<p>​       public void run() {</p>
<p>​              Nontask.rest();              </p>
<p>​       }</p>
<p>}</p>
<p>public class Ex18 {</p>
<p>​       public static void main(String[] args) { </p>
<p>​                                        Thread t = new Thread(new Worker());</p>
<p>​              t.start();</p>
<p>​              t.interrupt();</p>
<p>​                           ExecutorService exec = Executors.newSingleThreadExecutor();</p>
<p>​              exec.execute(new Worker());              </p>
<p>​              exec.shutdownNow();</p>
<p>​                           ExecutorService exec2 = Executors.newSingleThreadExecutor();</p>
<p>​              Future&lt;?&gt; f = exec2.submit(new Worker());</p>
<p>​              try {</p>
<p>​                     TimeUnit.MILLISECONDS.sleep(100);              } catch(InterruptedException e) {</p>
<p>​                     System.out.println(“Sleep interrupted in main()”);</p>
<p>​              }</p>
<p>​              f.cancel(true);</p>
<p>​              exec2.shutdown();        </p>
<p>​       }</p>
<p>}</p>
<p>class Count {</p>
<p>​       private int count = 0;</p>
<p>​       private Random rand = new Random(47);</p>
<p>​             public synchronized int increment() {</p>
<p>​              int temp = count;</p>
<p>​              if(rand.nextBoolean())                      Thread.yield();</p>
<p>​              return (count = ++temp);</p>
<p>​       }</p>
<p>​       public synchronized int value() { return count; } </p>
<p>}</p>
<p>class Entrance implements Runnable {</p>
<p>​       private static Count count = new Count();</p>
<p>​       private static List<entrance> entrances = new ArrayList<entrance>();</entrance></entrance></p>
<p>​       private int number = 0;</p>
<p>​             private final int id;</p>
<p>​       private static volatile boolean canceled = false;</p>
<p>​             public static void cancel() { canceled = true; }</p>
<p>​       public Entrance(int id) {</p>
<p>​              this.id = id;</p>
<p>​                                        entrances.add(this);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              while(!canceled) {</p>
<p>​                     synchronized(this) {                          ++number;</p>
<p>​                     }</p>
<p>​                     print(this + “ Total: “ + count.increment());</p>
<p>​                     try {</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(50);</p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            print(“sleep interrupted”);</p>
<p>​                            break;                 }</p>
<p>​              }</p>
<p>​              print(“Stopping “ + this);</p>
<p>​       }</p>
<p>​       public synchronized int getValue() { return number; }</p>
<p>​       public String toString() {</p>
<p>​              return “Entrance “ + id + “: “ + getValue();</p>
<p>​       } </p>
<p>​       public static int getTotalCount() {</p>
<p>​              return count.value();</p>
<p>​       }</p>
<p>​       public static int sumEntrances() {</p>
<p>​              int sum = 0;</p>
<p>​              for(Entrance entrance : entrances)</p>
<p>​                     sum += entrance.getValue();</p>
<p>​              return sum;</p>
<p>​       }</p>
<p>}</p>
<p>public class OrnamentalGarden19 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; 5; i++)</p>
<p>​                     exec.execute(new Entrance(i));</p>
<p>​                           TimeUnit.SECONDS.sleep(4);</p>
<p>​                           exec.shutdownNow();</p>
<p>​              if(!exec.awaitTermination(250, TimeUnit.MILLISECONDS))</p>
<p>​                     print(“Some tasks were not terminated”);</p>
<p>​              print(“Total: “ + Entrance.getTotalCount());</p>
<p>​              print(“Sum of Entrances: “ + Entrance.sumEntrances());</p>
<p>​       }</p>
<p>}</p>
<p>public class CachedThreadPool20 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              System.out.println(“Using LiftOff:”);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; 5; i++) {</p>
<p>​                     Future&lt;?&gt; f = exec.submit(new LiftOff());</p>
<p>​                     f.cancel(true);                                           </p>
<p>​              }</p>
<p>​              exec.shutdownNow();</p>
<p>​              if(!exec.awaitTermination(250, TimeUnit.MILLISECONDS))</p>
<p>​                     System.out.println(“Some tasks were not terminated”);</p>
<p>​                           System.out.println(“\nUsing LiftOff20:”); </p>
<p>​              ExecutorService exec20 = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; 5; i++) {</p>
<p>​                     Future&lt;?&gt; f = exec20.submit(new LiftOff20());</p>
<p>​                     f.cancel(true);                             </p>
<p>​              }</p>
<p>​              exec20.shutdownNow();</p>
<p>​              if(!exec.awaitTermination(250, TimeUnit.MILLISECONDS))</p>
<p>​                     System.out.println(“Some tasks were not terminated”);          </p>
<p>​       }</p>
<p>}</p>
<p>class A implements Runnable {</p>
<p>​       private volatile boolean signal = false;</p>
<p>​       public synchronized void run() {               try {</p>
<p>​                     while(!signal) {                                                                          println(“A.run() wait()”);</p>
<p>​                                                       wait();</p>
<p>​                            signal = true;</p>
<p>​                            println(“A is done waiting”);                            </p>
<p>​                     }                    </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     println(“A run() interrupted”);      </p>
<p>​              } finally {</p>
<p>​                     println(“Leaving A.run()”);    </p>
<p>​              }             </p>
<p>​       }</p>
<p>​       public synchronized void message() {</p>
<p>​              println(“Hi from A”);</p>
<p>​       }             </p>
<p>}</p>
<p>class B implements Runnable {    </p>
<p>​       private A a;</p>
<p>​       public A getA() { return a; }</p>
<p>​       B(A a) { this.a = a; } </p>
<p>​       public void run() {</p>
<p>​              try { </p>
<p>​                     TimeUnit.MILLISECONDS.sleep(2000);</p>
<p>​                     synchronized(a) {                             println(“B.run() a.notifyAll()”);</p>
<p>​                            a.notifyAll();</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                    System.out.println(“B sleep interrupted”);</p>
<p>​              }             </p>
<p>​       }      </p>
<p>}</p>
<p>public class Ex21 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              B b = new B(new A());</p>
<p>​              exec.execute(b.getA());</p>
<p>​              try { </p>
<p>​                     TimeUnit.MILLISECONDS.sleep(100);                </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                    System.out.println(“main() sleep interrupted”);</p>
<p>​              }</p>
<p>​              b.getA().message();</p>
<p>​              exec.execute(b);</p>
<p>​              try { </p>
<p>​                     TimeUnit.MILLISECONDS.sleep(2500);                      </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                    System.out.println(“main() sleep interrupted”);</p>
<p>​              }             </p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>
<p>class A implements Runnable {</p>
<p>​       boolean flag = false;</p>
<p>​       public synchronized void run() {</p>
<p>​              try {</p>
<p>​                     TimeUnit.SECONDS.sleep(2);</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     println(“sleep interrupted in A”);</p>
<p>​              }</p>
<p>​              println(“A setting flag = true”); </p>
<p>​              flag = true;            </p>
<p>​       }      </p>
<p>}</p>
<p>class BusyWait implements Runnable {</p>
<p>​       A a = new A();</p>
<p>​       long start, end;</p>
<p>​       public synchronized A getA() { return a; }</p>
<p>​       private BusyWait(A a) {</p>
<p>​              this.a = a;</p>
<p>​       }</p>
<p>​       public static BusyWait buildBusyWait(A a) {</p>
<p>​              return new BusyWait(a);</p>
<p>​       }</p>
<p>​       public synchronized void run() {</p>
<p>​              println(“Busy a.flag = “ + a.flag);         </p>
<p>​              while(!Thread.interrupted()) {      </p>
<p>​                     start = System.nanoTime();         </p>
<p>​                     if(a.flag) {</p>
<p>​                            a.flag = false;</p>
<p>​                            println(“BusyWait reset a.flag = false”);</p>
<p>​                            end = System.nanoTime();</p>
<p>​                            println(“Busy waiting “ + (end - start) + “ nanoseconds”);</p>
<p>​                     }</p>
<p>​              }             </p>
<p>​       }</p>
<p>}</p>
<p>class BetterWait implements Runnable {</p>
<p>​       private A a = new A();</p>
<p>​       public synchronized A getA() { return a; }</p>
<p>​       private BetterWait(A a) {</p>
<p>​              this.a = a;</p>
<p>​       }</p>
<p>​       public static BetterWait buildBetterWait(A a) {</p>
<p>​              return new BetterWait(a);</p>
<p>​       }</p>
<p>​       public synchronized void run() {</p>
<p>​              println(“Better a.flag = “ + a.flag);</p>
<p>​              try {               </p>
<p>​                     while(!a.flag) {</p>
<p>​                            wait();     </p>
<p>​                            a.flag = false;</p>
<p>​                            println(“BetterWait reset a.flag = false”);</p>
<p>​                     }                           </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     println(“BetterWait.run() interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex22 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              BusyWait busy = BusyWait.buildBusyWait(new A());</p>
<p>​              exec.execute(busy.a);</p>
<p>​              exec.execute(busy);</p>
<p>​              try {</p>
<p>​                     TimeUnit.SECONDS.sleep(3);</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     println(“sleep interrupted in main()”);</p>
<p>​              }</p>
<p>​              println();</p>
<p>​              BetterWait better = BetterWait.buildBetterWait(new A());</p>
<p>​              exec.execute(better.getA());</p>
<p>​              exec.execute(better);</p>
<p>​              try {</p>
<p>​                     TimeUnit.SECONDS.sleep(3);</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     println(“sleep interrupted in main()”);</p>
<p>​              }</p>
<p>​              synchronized(better) {</p>
<p>​                     println(“Sending better.notifyAll()”);</p>
<p>​                     better.notifyAll();</p>
<p>​              }</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>
<p>class Car {</p>
<p>​       private boolean waxOn = false;</p>
<p>​       public synchronized void waxed() {</p>
<p>​              waxOn = true;                         notify();</p>
<p>​       }</p>
<p>​       public synchronized void buffed() {</p>
<p>​              waxOn = false;                        notify();</p>
<p>​       }</p>
<p>​       public synchronized void waitForWaxing() throws InterruptedException {</p>
<p>​              while(waxOn == false) wait();</p>
<p>​       }</p>
<p>​       public synchronized void waitForBuffing() throws InterruptedException {</p>
<p>​              while(waxOn == true) wait();</p>
<p>​       }</p>
<p>}      </p>
<p>class WaxOn implements Runnable {</p>
<p>​       private Car car;</p>
<p>​       public WaxOn(Car c) { car = c; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            printnb(“Wax On! “);</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(200);</p>
<p>​                            car.waxed();</p>
<p>​                            car.waitForBuffing();</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Exiting via interrupt”);</p>
<p>​              }</p>
<p>​              print(“Ending Wax On task”);</p>
<p>​       }</p>
<p>}</p>
<p>class WaxOff implements Runnable {</p>
<p>​       private Car car;</p>
<p>​       public WaxOff(Car c) { car = c; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            car.waitForWaxing();</p>
<p>​                            printnb(“Wax Off! “);</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(200);</p>
<p>​                            car.buffed();</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Exiting via interrupt”);</p>
<p>​              }</p>
<p>​              print(“Ending Wax Off task”);</p>
<p>​       }</p>
<p>}</p>
<p>public class WaxOMatic23 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              Car car = new Car();</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              exec.execute(new WaxOff(car));</p>
<p>​              exec.execute(new WaxOn(car));</p>
<p>​              TimeUnit.SECONDS.sleep(5);            exec.shutdownNow();         }</p>
<p>}      </p>
<p>class Item {</p>
<p>​       private final int itemNum;</p>
<p>​       public Item(int itemNum) { this.itemNum = itemNum; }</p>
<p>​       public String toString() { return “Item “ + itemNum; }</p>
<p>}</p>
<p>class Producer implements Runnable {</p>
<p>​       private int count = 0;</p>
<p>​       Market24 market;</p>
<p>​       Producer(Market24 m) { market = m; }</p>
<p>​       protected int getCount() { return count; }</p>
<p>​       public void run() {</p>
<p>​              while(!Thread.interrupted()) {</p>
<p>​                     try {</p>
<p>​                            while(count &lt; 100) {</p>
<p>​                                   Item item = new Item(++count);</p>
<p>​                                   if(market.storage.offer(item)) {</p>
<p>​                                          println(“Produced “ + item);</p>
<p>​                                                                                   synchronized(market.consumer) { </p>
<p>​                                                 market.consumer.notifyAll();</p>
<p>​                                          }      </p>
<p>​                                   }</p>
<p>​                                                                     synchronized(this) { </p>
<p>​                                          while(!(market.storage.size() &lt; 10)) {</p>
<p>​                                                 wait();</p>
<p>​                                          }</p>
<p>​                                   }</p>
<p>​                     }</p>
<p>​                                         println(“Produced “ + count + “ Items”</p>
<p>​                           + “\nStopping production”);</p>
<p>​                     market.exec.shutdownNow();      </p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            println(“Producer interrupted”);</p>
<p>​                            println(“Produced “ + count + “ Items”); </p>
<p>​                     }                                  </p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Consumer implements Runnable {</p>
<p>​       int consumed = 0;</p>
<p>​       Market24 market;</p>
<p>​       List<item> cart = new ArrayList<item>();</item></item></p>
<p>​       Consumer(Market24 m) { market = m; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                                                       synchronized(this) {</p>
<p>​                                   while(!(cart.size() &lt; market.producer.getCount())) {</p>
<p>​                                          wait();</p>
<p>​                                   } </p>
<p>​                            }</p>
<p>​                                                       if(cart.add(market.storage.poll())) {</p>
<p>​                                   println(“Consuming Item “ + ++consumed); </p>
<p>​                                                                     synchronized(market.producer) {</p>
<p>​                                          market.producer.notifyAll();</p>
<p>​                                   }</p>
<p>​                            }                    </p>
<p>​                     }             </p>
<p>​              }</p>
<p>​              catch(InterruptedException e) {</p>
<p>​                     println(“Consumer interrupted”);</p>
<p>​                     println(“Consumed “ + consumed + “ Items”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Market24 {</p>
<p>​       ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​       Queue<item> storage = new LinkedList<item>();</item></item></p>
<p>​       Producer producer = new Producer(this);</p>
<p>​       Consumer consumer = new Consumer(this);</p>
<p>​       public Market24() {</p>
<p>​              exec.execute(producer);</p>
<p>​              exec.execute(consumer);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              new Market24();</p>
<p>​       }</p>
<p>}</p>
<p>class Meal {</p>
<p>​       private final int orderNum;</p>
<p>​       public Meal(int orderNum) { this.orderNum = orderNum; }</p>
<p>​       public String toString() { return “Meal “ + orderNum; }</p>
<p>}</p>
<p>class WaitPerson25 implements Runnable {</p>
<p>​       private Restaurant25 restaurant;</p>
<p>​       public WaitPerson25(Restaurant25 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            synchronized(this) {</p>
<p>​                                   while(restaurant.meal == null)</p>
<p>​                                          wait();                         }</p>
<p>​                            print(“WaitPerson25 got “ + restaurant.meal);</p>
<p>​                            synchronized(restaurant.chef) {</p>
<p>​                                   restaurant.meal = null;</p>
<p>​                                   restaurant.chef.notifyAll();                       }</p>
<p>​                     }      </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“WaitPerson25 interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Chef25 implements Runnable {</p>
<p>​       private Restaurant25 restaurant;</p>
<p>​       private int count = 0;</p>
<p>​       public Chef25(Restaurant25 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            synchronized(this) {</p>
<p>​                                   while(restaurant.meal != null) </p>
<p>​                                          wait();                         }</p>
<p>​                            if(++count == 10) {</p>
<p>​                                   print(“Out of food, closing”);</p>
<p>​                                   restaurant.exec.shutdownNow();</p>
<p>​                                   return;                        }</p>
<p>​                            printnb(“Order up! “);</p>
<p>​                            synchronized(restaurant.waitPerson) {</p>
<p>​                                   restaurant.meal = new Meal(count);</p>
<p>​                                   restaurant.waitPerson.notifyAll();</p>
<p>​                            }</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(100);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Chef25 interrupted”);</p>
<p>​              }</p>
<p>​       }      </p>
<p>}</p>
<p>public class Restaurant25 {</p>
<p>​       Meal meal;</p>
<p>​       ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​       WaitPerson25 waitPerson = new WaitPerson25(this);</p>
<p>​       Chef25 chef = new Chef25(this);</p>
<p>​       public Restaurant25() {</p>
<p>​              exec.execute(chef);</p>
<p>​              exec.execute(waitPerson);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              new Restaurant25();</p>
<p>​       }</p>
<p>}</p>
<p>class Meal {</p>
<p>​       private final int orderNum;</p>
<p>​       public Meal(int orderNum) { this.orderNum = orderNum; }</p>
<p>​       public String toString() { return “Meal “ + orderNum; }</p>
<p>}</p>
<p>class WaitPerson26 implements Runnable {</p>
<p>​       private Restaurant26 restaurant;</p>
<p>​       protected boolean clean = true;</p>
<p>​       protected Meal m;      public WaitPerson26(Restaurant26 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            synchronized(this) {</p>
<p>​                                   while(restaurant.meal == null)</p>
<p>​                                          wait();                         }</p>
<p>​                            m = restaurant.meal;</p>
<p>​                            print(“WaitPerson got “ + m);</p>
<p>​                            synchronized(restaurant.chef) {</p>
<p>​                                   restaurant.meal = null;</p>
<p>​                                   restaurant.chef.notifyAll();                       }</p>
<p>​                            print(“WaitPerson delivered “ + m);</p>
<p>​                            synchronized(restaurant.busBoy) { </p>
<p>​                                   clean = false;</p>
<p>​                                   restaurant.busBoy.notifyAll();                          }</p>
<p>​                     }      </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“WaitPerson interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Chef26 implements Runnable {</p>
<p>​       private Restaurant26 restaurant;</p>
<p>​       private int count = 0;</p>
<p>​       public Chef26(Restaurant26 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            synchronized(this) {</p>
<p>​                                   while(restaurant.meal != null) </p>
<p>​                                          wait();                         }</p>
<p>​                            if(++count == 10) {</p>
<p>​                                   print(“Out of food, closing”);</p>
<p>​                                   restaurant.exec.shutdownNow();</p>
<p>​                                   return;</p>
<p>​                            }</p>
<p>​                            print(“Order up! “);</p>
<p>​                            synchronized(restaurant.waitPerson) {</p>
<p>​                                   restaurant.meal = new Meal(count);</p>
<p>​                                   restaurant.waitPerson.notifyAll();</p>
<p>​                            }</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(100);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Chef interrupted”);</p>
<p>​              }</p>
<p>​       }      </p>
<p>}</p>
<p>class BusBoy26 implements Runnable {</p>
<p>​       private Restaurant26 restaurant;</p>
<p>​       public BusBoy26(Restaurant26 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            synchronized(this) {</p>
<p>​                                   while(restaurant.waitPerson.clean)</p>
<p>​                                          wait();</p>
<p>​                            }</p>
<p>​                            print(“BusBoy cleaning up “ + restaurant.waitPerson.m);</p>
<p>​                            restaurant.waitPerson.clean = true;</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“BusBoy interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Restaurant26 {</p>
<p>​       Meal meal;</p>
<p>​       ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​       WaitPerson26 waitPerson = new WaitPerson26(this);</p>
<p>​       BusBoy26 busBoy = new BusBoy26(this);</p>
<p>​       Chef26 chef = new Chef26(this);</p>
<p>​       public Restaurant26() {</p>
<p>​              exec.execute(chef);</p>
<p>​              exec.execute(waitPerson);</p>
<p>​              exec.execute(busBoy);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              new Restaurant26();</p>
<p>​       }</p>
<p>}</p>
<p>class Meal {</p>
<p>​       private final int orderNum;</p>
<p>​       public Meal(int orderNum) { this.orderNum = orderNum; }</p>
<p>​       public String toString() { return “Meal “ + orderNum; }</p>
<p>}</p>
<p>class WaitPerson27 implements Runnable {</p>
<p>​       private Restaurant27 restaurant;</p>
<p>​       protected Lock lock = new ReentrantLock();</p>
<p>​       protected Condition condition = lock.newCondition();</p>
<p>​       public WaitPerson27(Restaurant27 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            lock.lock();</p>
<p>​                            try {</p>
<p>​                                   while(restaurant.meal == null)</p>
<p>​                                          condition.await();</p>
<p>​                            } finally {</p>
<p>​                                   lock.unlock();</p>
<p>​                            }</p>
<p>​                            print(“waitPerson got “ + restaurant.meal);</p>
<p>​                            restaurant.chef.lock.lock();</p>
<p>​                            try {</p>
<p>​                                   restaurant.meal = null;</p>
<p>​                                   restaurant.chef.condition.signalAll();</p>
<p>​                            } finally {</p>
<p>​                                   restaurant.chef.lock.unlock();</p>
<p>​                            }                           </p>
<p>​                     }      </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“WaitPerson27 interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Chef27 implements Runnable {</p>
<p>​       private Restaurant27 restaurant;</p>
<p>​       private int count = 0;</p>
<p>​       protected Lock lock = new ReentrantLock();</p>
<p>​       protected Condition condition = lock.newCondition();</p>
<p>​       public Chef27(Restaurant27 r) { restaurant = r; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            lock.lock(); </p>
<p>​                            try {</p>
<p>​                                   while(restaurant.meal != null)</p>
<p>​                                          condition.await();</p>
<p>​                            } finally {</p>
<p>​                                   lock.unlock();</p>
<p>​                            }</p>
<p>​                            if(++count == 10) {</p>
<p>​                                   print(“Out of food, closing”);</p>
<p>​                                   restaurant.exec.shutdownNow();</p>
<p>​                                   return;</p>
<p>​                            }</p>
<p>​                            printnb(“Order up! “);</p>
<p>​                            restaurant.waitPerson.lock.lock();</p>
<p>​                            try {</p>
<p>​                                   restaurant.meal = new Meal(count);</p>
<p>​                                   restaurant.waitPerson.condition.signalAll();</p>
<p>​                            } finally {</p>
<p>​                                   restaurant.waitPerson.lock.unlock();</p>
<p>​                            }</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(100);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“chef interrupted”);</p>
<p>​              }</p>
<p>​       }      </p>
<p>}</p>
<p>public class Restaurant27 {</p>
<p>​       Meal meal;</p>
<p>​       ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​       WaitPerson27 waitPerson = new WaitPerson27(this);</p>
<p>​       Chef27 chef = new Chef27(this);</p>
<p>​       public Restaurant27() {</p>
<p>​              exec.execute(chef);</p>
<p>​              exec.execute(waitPerson);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              new Restaurant27();</p>
<p>​       }</p>
<p>}</p>
<p>class LiftOffRunner implements Runnable {</p>
<p>​       private BlockingQueue<liftoff> rockets;</liftoff></p>
<p>​       public LiftOffRunner(BlockingQueue<liftoff> queue) {</liftoff></p>
<p>​              rockets = queue;</p>
<p>​       } </p>
<p>​       public void add(LiftOff lo) {</p>
<p>​              try {</p>
<p>​                     rockets.put(lo);</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Interrupted during put()”);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            LiftOff rocket = rockets.take();</p>
<p>​                            rocket.run();                       }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Waking from take()”);</p>
<p>​              }</p>
<p>​              print(“Exiting LiftOffRunner”);</p>
<p>​       }</p>
<p>}</p>
<p>class LiftOffAdder implements Runnable {</p>
<p>​       private LiftOffRunner runner;</p>
<p>​       public LiftOffAdder(LiftOffRunner runner) {</p>
<p>​              this.runner = runner;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              for(int i = 0; i &lt; 5; i++)</p>
<p>​                     runner.add(new LiftOff(5));   </p>
<p>​       }</p>
<p>}</p>
<p>public class TestBlockingQueues28 {</p>
<p>​       static void getKey() {</p>
<p>​              try {</p>
<p>​                                                             new BufferedReader(new InputStreamReader(System.in)).readLine();</p>
<p>​              } catch(java.io.IOException e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       static void getKey(String message) {</p>
<p>​              printnb(message);</p>
<p>​              getKey();</p>
<p>​       }</p>
<p>​       static void test(String msg, BlockingQueue<liftoff> queue) {</liftoff></p>
<p>​              print(msg);</p>
<p>​              LiftOffRunner runner = new LiftOffRunner(queue);</p>
<p>​              LiftOffAdder adder = new LiftOffAdder(runner);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              exec.execute(runner);</p>
<p>​              exec.execute(adder);</p>
<p>​              getKey(“Press ‘Enter’ (“ + msg + “)”);</p>
<p>​              print(“Finished “ + msg + “ test”);</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              test(“LinkedBlockingQueue”,                   new LinkedBlockingQueue<liftoff>());</liftoff></p>
<p>​              test(“ArrayBlockingQueue”,                     new ArrayBlockingQueue<liftoff>(3));</liftoff></p>
<p>​              test(“SynchronousQueue”,                      new SynchronousQueue<liftoff>());</liftoff></p>
<p>​       }</p>
<p>}</p>
<p>class Toast {</p>
<p>​       public enum Status { DRY, JELLIED, PEANUTBUTTERED }</p>
<p>​       private Status status = Status.DRY;</p>
<p>​       private final int id;</p>
<p>​       public Toast(int idn) { id = idn; }</p>
<p>​       public void jelly() { status = Status.JELLIED; }</p>
<p>​       public void peanutButter() { status = Status.PEANUTBUTTERED; }</p>
<p>​       public Status getStatus() { return status; }</p>
<p>​       public int getId() { return id; }</p>
<p>​       public String toString() {</p>
<p>​              return “Toast “ + id + “: “ + status;</p>
<p>​       }</p>
<p>}</p>
<p>class ToastQueue extends LinkedBlockingQueue<toast> {}</toast></p>
<p>​       </p>
<p>class Toaster implements Runnable {</p>
<p>​       private ToastQueue toastQueue;</p>
<p>​       private int count = 0;</p>
<p>​       private Random rand = new Random();</p>
<p>​       public Toaster(ToastQueue tq) { toastQueue = tq; }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            TimeUnit.MILLISECONDS.sleep(</p>
<p>​                                   100 + rand.nextInt(500));</p>
<p>​                                                       Toast t = new Toast(count++);</p>
<p>​                            print(t);</p>
<p>​                                                       toastQueue.put(t);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Toaster interrupted”);</p>
<p>​              }</p>
<p>​              print(“Toaster off”);</p>
<p>​       }</p>
<p>}</p>
<p> class PeanutButterer implements Runnable {</p>
<p>​       private ToastQueue dryQueue, peanutButteredQueue;</p>
<p>​       public PeanutButterer(ToastQueue dry, ToastQueue peanutButtered) {</p>
<p>​              dryQueue = dry;</p>
<p>​              peanutButteredQueue = peanutButtered;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                                                       Toast t = dryQueue.take();</p>
<p>​                            t.peanutButter();</p>
<p>​                            print(t);</p>
<p>​                            peanutButteredQueue.put(t);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                    print(“PeanutButterer interrupted”);</p>
<p>​              }</p>
<p>​              print(“PeanutButterer off”);</p>
<p>​       }</p>
<p>}</p>
<p> class Jellyer implements Runnable {</p>
<p>​       private ToastQueue dryQueue, jelliedQueue;</p>
<p>​       public Jellyer(ToastQueue dry, ToastQueue jellied ) {</p>
<p>​              dryQueue = dry;</p>
<p>​              jelliedQueue = jellied;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                                                       Toast t = dryQueue.take();</p>
<p>​                            t.jelly();</p>
<p>​                            print(t);</p>
<p>​                            jelliedQueue.put(t);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“Jellyer interrupted”);</p>
<p>​              }</p>
<p>​              print(“Jellyer off”);</p>
<p>​       }</p>
<p>}</p>
<p>class Sandwich {</p>
<p>​       private Toast top, bottom;</p>
<p>​       private final int id;</p>
<p>​       public Sandwich(Toast top, Toast bottom, int id) {</p>
<p>​              this.top = top;</p>
<p>​              this.bottom = bottom;</p>
<p>​              this.id = id;</p>
<p>​       }</p>
<p>​       public int getId() {</p>
<p>​              return id;</p>
<p>​       }</p>
<p>​       public Toast getTop() { return top; }</p>
<p>​       public Toast getBottom() { return bottom; }</p>
<p>​       public String toString() {</p>
<p>​              return “Sandwich “ + id + “: top: “ + top + “ and bottom: “ + bottom;</p>
<p>​       }</p>
<p>}</p>
<p>class SandwichQueue extends LinkedBlockingQueue<sandwich> {}</sandwich></p>
<p> class SandwichMaker implements Runnable {</p>
<p>​       private int count = 0;</p>
<p>​       private ToastQueue jelliedQueue, peanutButteredQueue;</p>
<p>​       private SandwichQueue sandwichQueue;</p>
<p>​       public SandwichMaker(ToastQueue jellied, ToastQueue peanutButtered, SandwichQueue sq) {</p>
<p>​              jelliedQueue = jellied;</p>
<p>​              peanutButteredQueue = peanutButtered;</p>
<p>​              sandwichQueue = sq;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            Sandwich s = new Sandwich(</p>
<p>​                                   jelliedQueue.take(), peanutButteredQueue.take(), count++);</p>
<p>​                            print(s);</p>
<p>​                            sandwichQueue.put(s);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(“SandwichMaker interrupted”);</p>
<p>​              }</p>
<p>​              print(“Sandwich maker off”);</p>
<p>​       }</p>
<p>}</p>
<p> class SandwichEater implements Runnable {</p>
<p>​       private SandwichQueue sandwichQueue;</p>
<p>​       private int counter = 0;</p>
<p>​       public SandwichEater(SandwichQueue sq) {</p>
<p>​              sandwichQueue = sq;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                                                       Sandwich s = sandwichQueue.take();</p>
<p>​                                                                                  if(s.getId() != counter++ || </p>
<p>​                                   s.getTop().getStatus() != Toast.Status.JELLIED || </p>
<p>​                                   s.getBottom().getStatus() != Toast.Status.PEANUTBUTTERED) {</p>
<p>​                                          print(“&gt;&gt;&gt;&gt; Error: “ + s);</p>
<p>​                                          System.exit(1);</p>
<p>​                            } else</p>
<p>​                                   print(“NumNum! “ + s);</p>
<p>​                     } </p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                            print(“SandwichEater interruped”);</p>
<p>​              }</p>
<p>​              print(“SandwichEater off”);</p>
<p>​       }</p>
<p>}</p>
<p>public class ToastOMatic29 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              ToastQueue dryQueue = new ToastQueue(),</p>
<p>​                     jelliedQueue = new ToastQueue(),</p>
<p>​                     peanutButteredQueue = new ToastQueue();</p>
<p>​              SandwichQueue sandwichQueue = new SandwichQueue();</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              exec.execute(new Toaster(dryQueue));</p>
<p>​              exec.execute(new Jellyer(dryQueue, jelliedQueue));</p>
<p>​              exec.execute(new PeanutButterer(dryQueue, peanutButteredQueue));</p>
<p>​              exec.execute(new SandwichMaker(</p>
<p>​                     jelliedQueue, peanutButteredQueue, sandwichQueue));</p>
<p>​              exec.execute(new SandwichEater(sandwichQueue));</p>
<p>​              TimeUnit.SECONDS.sleep(5);</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>
<p>class Sender implements Runnable {</p>
<p>​       private Random rand = new Random(47);</p>
<p>​       private LinkedBlockingQueue<character> queue;</character></p>
<p>​       public Sender(LinkedBlockingQueue<character> lbq) {</character></p>
<p>​              queue = lbq;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(true)</p>
<p>​                            for(char c = ‘A’; c &lt;= ‘z’; c++) {</p>
<p>​                                   queue.put(c);</p>
<p>​                                   TimeUnit.MILLISECONDS.sleep(rand.nextInt(500));</p>
<p>​                            }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(e + “ Sender sleep interrupted”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Receiver implements Runnable {</p>
<p>​       private LinkedBlockingQueue<character> queue;</character></p>
<p>​       public Receiver(LinkedBlockingQueue<character> lbq) {</character></p>
<p>​              queue = lbq;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​               try {</p>
<p>​                     while(true) {</p>
<p>​                                                       printnb(“Read: “ + (char)queue.take() + “, “);</p>
<p>​                     }</p>
<p>​               } catch(InterruptedException e) {</p>
<p>​                     print(e + “ Receiver read exception”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex30 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              LinkedBlockingQueue<character> lbq = new LinkedBlockingQueue<character>();</character></character></p>
<p>​              Sender sender = new Sender(lbq);</p>
<p>​              Receiver receiver = new Receiver(lbq);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              exec.execute(sender);</p>
<p>​              exec.execute(receiver);</p>
<p>​              TimeUnit.SECONDS.sleep(4);</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>
<p>public class Philosopher31 implements Runnable {</p>
<p>​       private Chopstick left;</p>
<p>​       private Chopstick right;</p>
<p>​       private LinkedBlockingQueue<chopstick> bin;</chopstick></p>
<p>​       private final int id;</p>
<p>​       private final int ponderFactor;</p>
<p>​       private Random rand = new Random(47);</p>
<p>​       private void pause() throws InterruptedException {</p>
<p>​              if(ponderFactor == 0) return;</p>
<p>​              TimeUnit.MILLISECONDS.sleep(rand.nextInt(ponderFactor * 250));</p>
<p>​       }</p>
<p>​       public Philosopher31(Chopstick left, Chopstick right, </p>
<p>​              LinkedBlockingQueue<chopstick> bin, int ident, int ponder) {</chopstick></p>
<p>​              this.left = left;</p>
<p>​              this.right = right;</p>
<p>​              this.bin = bin;</p>
<p>​              id = ident;</p>
<p>​              ponderFactor = ponder;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            print(this + “ “ + “thinking”);</p>
<p>​                            pause();</p>
<p>​                                                       print(this + “ taking first, right chopstick”);</p>
<p>​                            right = bin.take();</p>
<p>​                            print(this + “ taking second, left chopstick”);</p>
<p>​                            left = bin.take();</p>
<p>​                            print(this + “ eating”);</p>
<p>​                            pause();</p>
<p>​                            print(this + “ returning chopsticks”);</p>
<p>​                            bin.put(right);</p>
<p>​                            bin.put(left);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                     print(this + “ “ + “exiting via interrupt”);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public String toString() { return “Philosopher “ + id; }</p>
<p>}</p>
<p>public class DeadlockingDiningPhilosophers31 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              int ponder = 5;</p>
<p>​              if(args.length &gt; 0)</p>
<p>​                     ponder = Integer.parseInt(args[0]);</p>
<p>​              int size = 5;</p>
<p>​              if(args.length &gt; 1)</p>
<p>​                     size = Integer.parseInt(args[1]);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​                           LinkedBlockingQueue<chopstick> bin = new LinkedBlockingQueue<chopstick>();</chopstick></chopstick></p>
<p>​              Chopstick[] sticks = new Chopstick[size];</p>
<p>​              for(int i = 0; i &lt; size; i++) {</p>
<p>​                     sticks[i] = new Chopstick();</p>
<p>​                     bin.put(sticks[i]);</p>
<p>​              }      </p>
<p>​              for(int i = 0; i &lt; size; i++)     </p>
<p>​                     exec.execute(new Philosopher31(sticks[i], sticks[(i + 1) % size], bin, i, ponder));</p>
<p>​              if(args.length == 3 &amp;&amp; args[2].equals(“timeout”))</p>
<p>​                     TimeUnit.SECONDS.sleep(5);</p>
<p>​              else {</p>
<p>​                     System.out.println(“Press ‘Enter’ to quit”);</p>
<p>​                     System.in.read();</p>
<p>​              }</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>
<p>import java.util.concurrent.*;</p>
<p>import java.util.*;</p>
<p>import static net.mindview.util.Print.*;</p>
<p>class Count {</p>
<p>​       private int count = 0;</p>
<p>​       private Random rand = new Random(47);</p>
<p>​             public synchronized int increment() {</p>
<p>​              int temp = count;</p>
<p>​              if(rand.nextBoolean())                      Thread.yield();</p>
<p>​              return (count = ++temp);</p>
<p>​       }</p>
<p>​       public synchronized int value() { return count; } </p>
<p>}</p>
<p>class Entrance implements Runnable {</p>
<p>​       private static Count count = new Count();</p>
<p>​       private static List<entrance> entrances = new ArrayList<entrance>();</entrance></entrance></p>
<p>​       private int number = 0;</p>
<p>​       private final int id;</p>
<p>​       private final CountDownLatch doneSignal;</p>
<p>​       private static CountDownLatch stopSignal;</p>
<p>​       public Entrance(int id, CountDownLatch doneSignal, CountDownLatch stopSignal) {</p>
<p>​              this.id = id;</p>
<p>​              this.doneSignal = doneSignal;</p>
<p>​              this.stopSignal = stopSignal;</p>
<p>​                                        entrances.add(this);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              while(!(stopSignal.getCount() == 0)) {</p>
<p>​                     synchronized(this) {</p>
<p>​                            ++number;</p>
<p>​                     }</p>
<p>​                     print(this + “ Total: “ + count.increment());</p>
<p>​                     try { </p>
<p>​                            TimeUnit.MILLISECONDS.sleep(100);</p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            print(“sleep interrupted”);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​              print(“Closing “ + this);</p>
<p>​              doneSignal.countDown();</p>
<p>​       }</p>
<p>​       public synchronized int getValue() { return number; }</p>
<p>​       public String toString() {</p>
<p>​              return “Entrance “ + id + “: “ + getValue();</p>
<p>​       } </p>
<p>​       public static int getTotalCount() {</p>
<p>​              return count.value();</p>
<p>​       }</p>
<p>​       public static int sumEntrances() {</p>
<p>​              int sum = 0;</p>
<p>​              for(Entrance entrance : entrances)</p>
<p>​                     sum += entrance.getValue();</p>
<p>​              return sum;</p>
<p>​       }</p>
<p>}</p>
<p>public class OrnamentalGarden32 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              int SIZE = 5;</p>
<p>​              CountDownLatch stopSignal = new CountDownLatch(1);</p>
<p>​              CountDownLatch doneSignal = new CountDownLatch(SIZE);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; SIZE; i++)</p>
<p>​                     exec.execute(new Entrance(i, doneSignal, stopSignal));</p>
<p>​                           TimeUnit.SECONDS.sleep(2);</p>
<p>​                           stopSignal.countDown();</p>
<p>​                           doneSignal.await();</p>
<p>​              exec.shutdown();</p>
<p>​              print(“Total: “ + Entrance.getTotalCount());</p>
<p>​              print(“Sum of Entrances: “ + Entrance.sumEntrances());</p>
<p>​       }</p>
<p>}</p>
<p>class Count {</p>
<p>​       private int count = 0;</p>
<p>​       private Random rand = new Random(47);</p>
<p>​             public synchronized int increment() {</p>
<p>​              int temp = count;</p>
<p>​              if(rand.nextBoolean())                      Thread.yield();</p>
<p>​              return (count = ++temp);</p>
<p>​       }</p>
<p>​       public synchronized int value() { return count; } </p>
<p>}</p>
<p>class Entrance implements Runnable {</p>
<p>​       private static Count count = new Count();</p>
<p>​       private static List<entrance> entrances = new ArrayList<entrance>();</entrance></entrance></p>
<p>​       private int number = 0;</p>
<p>​       private final int id;</p>
<p>​       private final CountDownLatch doneSignal;</p>
<p>​       private static CountDownLatch stopSignal;</p>
<p>​       public Entrance(int id, CountDownLatch doneSignal, CountDownLatch stopSignal) {</p>
<p>​              this.id = id;</p>
<p>​              this.doneSignal = doneSignal;</p>
<p>​              this.stopSignal = stopSignal;</p>
<p>​                                        entrances.add(this);</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              while(!(stopSignal.getCount() == 0)) {</p>
<p>​                     synchronized(this) {</p>
<p>​                            ++number;</p>
<p>​                     }</p>
<p>​                     print(this + “ Total: “ + count.increment());</p>
<p>​                     try { </p>
<p>​                            TimeUnit.MILLISECONDS.sleep(100);</p>
<p>​                     } catch(InterruptedException e) {</p>
<p>​                            print(“sleep interrupted”);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​              print(“Closing “ + this);</p>
<p>​              doneSignal.countDown();</p>
<p>​       }</p>
<p>​       public synchronized int getValue() { return number; }</p>
<p>​       public String toString() {</p>
<p>​              return “Entrance “ + id + “: “ + getValue();</p>
<p>​       } </p>
<p>​       public static int getTotalCount() {</p>
<p>​              return count.value();</p>
<p>​       }</p>
<p>​       public static int sumEntrances() {</p>
<p>​              int sum = 0;</p>
<p>​              for(Entrance entrance : entrances)</p>
<p>​                     sum += entrance.getValue();</p>
<p>​              return sum;</p>
<p>​       }</p>
<p>}</p>
<p>public class OrnamentalGarden32 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              int SIZE = 5;</p>
<p>​              CountDownLatch stopSignal = new CountDownLatch(1);</p>
<p>​              CountDownLatch doneSignal = new CountDownLatch(SIZE);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              for(int i = 0; i &lt; SIZE; i++)</p>
<p>​                     exec.execute(new Entrance(i, doneSignal, stopSignal));</p>
<p>​                           TimeUnit.SECONDS.sleep(2);</p>
<p>​                           stopSignal.countDown();</p>
<p>​                           doneSignal.await();</p>
<p>​              exec.shutdown();</p>
<p>​              print(“Total: “ + Entrance.getTotalCount());</p>
<p>​              print(“Sum of Entrances: “ + Entrance.sumEntrances());</p>
<p>​       }</p>
<p>}</p>
<p>abstract class DelayedGreenhouseTask implements Delayed, Runnable {</p>
<p>​       protected long delayTime;        public long trigger;     public DelayedGreenhouseTask() {</p>
<p>​              delayTime = 0;</p>
<p>​              trigger = System.nanoTime();</p>
<p>​       }</p>
<p>​       public DelayedGreenhouseTask(long d) { </p>
<p>​              delayTime = d; </p>
<p>​              trigger = System.nanoTime() + </p>
<p>​                     NANOSECONDS.convert(delayTime, MILLISECONDS);</p>
<p>​       }</p>
<p>​       public long getDelay(TimeUnit unit) {</p>
<p>​              return unit.convert(</p>
<p>​                     trigger - System.nanoTime(), NANOSECONDS);</p>
<p>​       }</p>
<p>​       public int compareTo(Delayed d) {</p>
<p>​              DelayedGreenhouseTask that = (DelayedGreenhouseTask)d;</p>
<p>​              if(trigger &lt; that.trigger) return -1;</p>
<p>​              if(trigger &gt; that.trigger) return 1;</p>
<p>​              return 0;</p>
<p>​       }</p>
<p>​             abstract public DelayedGreenhouseTask create(long d);</p>
<p>​       abstract public void run(); </p>
<p>}</p>
<p>class GreenhouseController33 {</p>
<p>​       private volatile boolean light = false;</p>
<p>​       private volatile boolean water = false;</p>
<p>​       private String thermostat = “Day”;</p>
<p>​       DelayQueue<delayedgreenhousetask> tasks = new DelayQueue<delayedgreenhousetask>();</delayedgreenhousetask></delayedgreenhousetask></p>
<p>​       public synchronized String getThermostat()  {</p>
<p>​              return thermostat;</p>
<p>​       }</p>
<p>​       public synchronized void setThermostat(String value) {</p>
<p>​              thermostat = value;</p>
<p>​       }</p>
<p>​       class LightOn33 extends DelayedGreenhouseTask {</p>
<p>​              public LightOn33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public LightOn33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public LightOn33 create(long d) {                   return new LightOn33(d);</p>
<p>​              }</p>
<p>​              public void run() { </p>
<p>​                     if(!light) {</p>
<p>​                            System.out.println(“Turning on lights”);</p>
<p>​                            light = true;</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class LightOff33 extends DelayedGreenhouseTask {</p>
<p>​              public LightOff33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public LightOff33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public LightOff33 create(long d) { </p>
<p>​                     return new LightOff33(d);</p>
<p>​              }</p>
<p>​              public void run() { </p>
<p>​                     if(light) {</p>
<p>​                            System.out.println(“Turning off lights”);</p>
<p>​                            light = false;</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class WaterOn33 extends DelayedGreenhouseTask {</p>
<p>​              public WaterOn33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public WaterOn33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public WaterOn33 create(long d) {                 return new WaterOn33(d);</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                                         System.out.println(“Turning greenhouse water on”);</p>
<p>​                     water = true;</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class WaterOff33 extends DelayedGreenhouseTask {</p>
<p>​              public WaterOff33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public WaterOff33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public WaterOff33 create(long d) { </p>
<p>​                     return new WaterOff33(d);</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                                         System.out.println(“Turning greenhouse water off”);</p>
<p>​                     water = false;</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class ThermostatNight33 extends DelayedGreenhouseTask {</p>
<p>​              public ThermostatNight33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public ThermostatNight33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public ThermostatNight33 create(long d) { </p>
<p>​                     return new ThermostatNight33(d);</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                                         System.out.println(“Thermostat to night setting”);</p>
<p>​                     setThermostat(“Night”);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class ThermostatDay33 extends DelayedGreenhouseTask {</p>
<p>​              public ThermostatDay33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public ThermostatDay33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public ThermostatDay33 create(long d) { </p>
<p>​                     return new ThermostatDay33(d);</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                                         System.out.println(“Thermostat to day setting”);</p>
<p>​                     setThermostat(“Day”);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       class Bell33 extends DelayedGreenhouseTask {</p>
<p>​              public Bell33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public Bell33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public Bell33 create(long d) {</p>
<p>​                     return new Bell33(d);</p>
<p>​              }</p>
<p>​              public void run() { System.out.println(“Bing!”); }</p>
<p>​       }</p>
<p>​             static class DataPoint33 {</p>
<p>​              final Calendar time;</p>
<p>​              final float temperature;</p>
<p>​              final float humidity;</p>
<p>​              public DataPoint33(Calendar d, float temp, float hum) {</p>
<p>​                     time = d;</p>
<p>​                     temperature = temp;</p>
<p>​                     humidity = hum;</p>
<p>​              }</p>
<p>​              public String toString() {</p>
<p>​                     return time.getTime() + </p>
<p>​                            String.format(</p>
<p>​                                   “ temperature: %1$.1f humidity: %2$.2f”,</p>
<p>​                                   temperature, humidity);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       private Calendar lastTime = Calendar.getInstance();</p>
<p>​       {            lastTime.set(Calendar.MINUTE, 30);</p>
<p>​              lastTime.set(Calendar.SECOND, 00);</p>
<p>​       }</p>
<p>​       private float lastTemp = 65.0f;</p>
<p>​       private int tempDirection = +1;</p>
<p>​       private float lastHumidity = 50.0f;</p>
<p>​       private int humidityDirection = +1;</p>
<p>​       private Random rand = new Random(47);</p>
<p>​       List<datapoint33> data = Collections.synchronizedList(</datapoint33></p>
<p>​              new ArrayList<datapoint33>());</datapoint33></p>
<p>​       class CollectData33 extends DelayedGreenhouseTask {</p>
<p>​              public CollectData33() {</p>
<p>​                     super();</p>
<p>​              }</p>
<p>​              public CollectData33(long delayTime) {</p>
<p>​                     super(delayTime);</p>
<p>​              }</p>
<p>​              public CollectData33 create(long d) {</p>
<p>​                     return new CollectData33(d);</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                     System.out.println(“Collecting data”);</p>
<p>​                     synchronized(GreenhouseController33.this) {</p>
<p>​                                                       lastTime.set(Calendar.MINUTE, </p>
<p>​                                   lastTime.get(Calendar.MINUTE) + 30);</p>
<p>​                                                       if(rand.nextInt(5) == 4)</p>
<p>​                                   tempDirection = -tempDirection;</p>
<p>​                                                       lastTemp = lastTemp + </p>
<p>​                                   tempDirection * (1.0f + rand.nextFloat());</p>
<p>​                            if(rand.nextInt(5) == 4) </p>
<p>​                                   humidityDirection = -humidityDirection;</p>
<p>​                            lastHumidity = lastHumidity +</p>
<p>​                                   humidityDirection * rand.nextFloat();</p>
<p>​                                                                                                             data.add(new DataPoint33((Calendar)lastTime.clone(),</p>
<p>​                                   lastTemp, lastHumidity));</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public class StopController extends DelayedGreenhouseTask {</p>
<p>​              private ExecutorService exec;</p>
<p>​              public StopController(long delay, ExecutorService e) {</p>
<p>​                     super(delay);</p>
<p>​                     exec = e;</p>
<p>​              }</p>
<p>​              public StopController create(long delay) {</p>
<p>​                     return new StopController(delay, Executors.newCachedThreadPool());</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                     System.out.println(“Calling shutdownNow()”);</p>
<p>​                     exec.shutdownNow();</p>
<p>​                                         new Thread() {</p>
<p>​                            public void run() {</p>
<p>​                                   for(DataPoint33 d : data)</p>
<p>​                                          System.out.println(d);</p>
<p>​                            }</p>
<p>​                     }.start();</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public static class GreenhouseGo implements Runnable {</p>
<p>​              private DelayQueue<delayedgreenhousetask> q;</delayedgreenhousetask></p>
<p>​              public GreenhouseGo(DelayQueue<delayedgreenhousetask> q) {</delayedgreenhousetask></p>
<p>​                     this.q = q;</p>
<p>​              }</p>
<p>​              public void run() {</p>
<p>​                                         try {</p>
<p>​                            while(!Thread.interrupted()) </p>
<p>​                                   q.take().run();                     } catch(InterruptedException e) {</p>
<p>​                                                }</p>
<p>​                     System.out.println(“Finished GreenhouseGo”);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class GreenhouseScheduler33 {</p>
<p>​       public static void repeat(</p>
<p>​       GreenhouseController33 c, DelayedGreenhouseTask task, long interval, long duration) </p>
<p>​              throws Exception {</p>
<p>​              if(interval &lt;= duration) {</p>
<p>​                     for(int i = 0; i &lt; duration                          DelayedGreenhouseTask t = task.create(interval * (i + 1));</p>
<p>​                            c.tasks.put(t);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              GreenhouseController33 ghc = new GreenhouseController33();</p>
<p>​              repeat(ghc, ghc.new Bell33(), 1000, 4000);</p>
<p>​              repeat(ghc, ghc.new ThermostatNight33(), 2000, 4000);</p>
<p>​              repeat(ghc, ghc.new LightOn33(), 200, 4000);</p>
<p>​              repeat(ghc, ghc.new LightOff33(), 400, 4000);</p>
<p>​              repeat(ghc, ghc.new WaterOn33(), 600, 4000);</p>
<p>​              repeat(ghc, ghc.new WaterOff33(), 800, 4000);</p>
<p>​              repeat(ghc, ghc.new ThermostatDay33(), 1400, 4000);</p>
<p>​              repeat(ghc, ghc.new CollectData33(), 500, 4000);</p>
<p>​              ghc.tasks.put(ghc.new StopController(5000, exec));</p>
<p>​              exec.execute(new GreenhouseController33.GreenhouseGo(ghc.tasks));</p>
<p>​       }</p>
<p>}</p>
<p>class ExchangerProducer34<t> implements Runnable {</t></p>
<p>​       private Generator<t> generator;</t></p>
<p>​       private Exchanger&lt;List<t>&gt; exchanger;</t></p>
<p>​       private List<t> holder;</t></p>
<p>​       ExchangerProducer34(Exchanger&lt;List<t>&gt; exchg, Generator<t> gen, List<t> holder) {</t></t></t></p>
<p>​              exchanger = exchg;</p>
<p>​              generator = gen;</p>
<p>​              this.holder = holder;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            for(int i = 0; i &lt; ExchangerDemo34.size; i++)</p>
<p>​                                   holder.add(generator.next());</p>
<p>​                                                       holder = exchanger.exchange(holder);</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                                  }</p>
<p>​       }</p>
<p>}</p>
<p>class ExchangerConsumer34<t> implements Runnable {</t></p>
<p>​       private Exchanger&lt;List<t>&gt; exchanger;</t></p>
<p>​       private List<t> holder;</t></p>
<p>​       private volatile T value;</p>
<p>​       ExchangerConsumer34(Exchanger&lt;List<t>&gt; ex, List<t> holder) {</t></t></p>
<p>​              exchanger = ex;</p>
<p>​              this.holder = holder;</p>
<p>​       }</p>
<p>​       public void run() {</p>
<p>​              try {</p>
<p>​                     while(!Thread.interrupted()) {</p>
<p>​                            holder = exchanger.exchange(holder);</p>
<p>​                            for(T x : holder) {</p>
<p>​                                   value = x;                                 holder.remove(x);                            }</p>
<p>​                     }</p>
<p>​              } catch(InterruptedException e) {</p>
<p>​                                  }</p>
<p>​              System.out.println(“Final value: “ + value);</p>
<p>​       }</p>
<p>}</p>
<p>public class ExchangerDemo34 {</p>
<p>​       static int size = 10;</p>
<p>​       static int delay = 5;     public static void main(String[] args) throws Exception { </p>
<p>​              if(args.length &gt; 0) size = new Integer(args[0]);</p>
<p>​              if(args.length &gt; 1) delay = new Integer(args[1]);</p>
<p>​              ExecutorService exec = Executors.newCachedThreadPool();</p>
<p>​              Exchanger&lt;List<xctest34>&gt; xc = new Exchanger&lt;List<xctest34>&gt;();</xctest34></xctest34></p>
<p>​              List<xctest34></xctest34></p>
<p>​                     producerList = new CopyOnWriteArrayList<xctest34>(),</xctest34></p>
<p>​                     consumerList = new CopyOnWriteArrayList<xctest34>();</xctest34></p>
<p>​             exec.execute(new ExchangerProducer34<xctest34>(xc, BasicGenerator.create(XCTest34.class), producerList));</xctest34></p>
<p>​              exec.execute(new ExchangerConsumer34<xctest34>(xc, consumerList));</xctest34></p>
<p>​              TimeUnit.SECONDS.sleep(delay);</p>
<p>​              exec.shutdownNow();</p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解泛型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解泛型/" itemprop="url">Java题解泛型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第十五章-泛型"><a href="#第十五章-泛型" class="headerlink" title="第十五章 泛型"></a>第十五章 泛型</h2><p>class Robot {</p>
<p>​       private String name;</p>
<p>​       public Robot(String name) { this.name = name; }</p>
<p>​       public String toString() { </p>
<p>​              return name;</p>
<p>​       }</p>
<p>}</p>
<p>public class HolderEx2<t> {</t></p>
<p>​       private T x, y, z;</p>
<p>​       public HolderEx2(T x, T y, T z) { </p>
<p>​              this.x = x;</p>
<p>​              this.y = y;</p>
<p>​              this.z = z;</p>
<p>​        }</p>
<p>​       public void setX(T x) { this.x = x; }</p>
<p>​       public void setY(T y) { this.y = y; }</p>
<p>​       public void setZ(T z) { this.z = z; }</p>
<p>​       public T getX() { return x; }</p>
<p>​       public T getY() { return y; }</p>
<p>​       public T getZ() { return z; }</p>
<p>​       public String toString() {</p>
<p>​              return x + “, “ + y + “, “ + z;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Robot a = new Robot(“bot1”);</p>
<p>​              Robot b = new Robot(“bot2”);</p>
<p>​              Robot c = new Robot(“bot3”);</p>
<p>​              HolderEx2<robot> hEx2 = </robot></p>
<p>​                     new HolderEx2<robot>(a, b, c);</robot></p>
<p>​              System.out.println(“Holding: “ + hEx2);</p>
<p>​       }</p>
<p>}</p>
<p>class Robot {}</p>
<p>class Amphibian {}</p>
<p>class Vehicle {}</p>
<p>class SixTuple&lt;A,B,C,D,E,F&gt;</p>
<p>extends FiveTuple&lt;A,B,C,D,E&gt; {</p>
<p>  public final F sixth;</p>
<p>  public SixTuple(A a, B b, C c, D d, E e, F f) {</p>
<p>​    super(a, b, c, d, e);</p>
<p>​    sixth = f;</p>
<p>  }</p>
<p>  public String toString() {</p>
<p>​    return “(“ + first + “, “ + second + “, “ +</p>
<p>​      third + “, “ + fourth + “, “ + fifth + “, “ + sixth +”)”;</p>
<p>  }</p>
<p>} </p>
<p>public class SixTupleTest {</p>
<p>​       static SixTuple&lt;Robot, Vehicle, Amphibian, String, Integer, Double&gt; f() {</p>
<p>​              return new SixTuple&lt;Robot, Vehicle, Amphibian, String, Integer, Double&gt;( </p>
<p>​              new Robot(), new Vehicle(), new Amphibian(), “hi”, 47, 11.1);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              SixTuple&lt;Robot, Vehicle, Amphibian, String, Integer, Double&gt; st = f();</p>
<p>​              System.out.println(st);</p>
<p>​              System.out.println(f());         </p>
<p>​       }</p>
<p>} </p>
<p>interface Selector {</p>
<p>​       boolean end();</p>
<p>​       Object current();</p>
<p>​       void next();</p>
<p>}</p>
<p>public class GenericSequence<e> {    </e></p>
<p>​       private List<e> list = new ArrayList<e>();</e></e></p>
<p>​       private int next = 0;</p>
<p>​       public GenericSequence(List<e> list) { this.list = list; }</e></p>
<p>​       public void add(E e) { list.add(e); }</p>
<p>​       private class SequenceSelector implements Selector {</p>
<p>​              private int i = 0;</p>
<p>​              public boolean end() { return i == list.size(); }</p>
<p>​              public Object current() { return list.get(i); }</p>
<p>​              public void next() { if(i &lt; list.size()) i++; } </p>
<p>​       }</p>
<p>​       public Selector selector() {</p>
<p>​              return new SequenceSelector();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              List<string> ls = new ArrayList<string>();</string></string></p>
<p>​              GenericSequence<string> gs = new GenericSequence<string>(ls);</string></string></p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     gs.add(Integer.toString(i));</p>
<p>​              Selector selector = gs.selector();</p>
<p>​              while(!selector.end()) {</p>
<p>​                     System.out.print(selector.current() + “ “);</p>
<p>​                     selector.next();</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class LinkedStack5<t> {</t></p>
<p>​             private class Node {</p>
<p>​              T item;</p>
<p>​              Node next;</p>
<p>​              Node() { item = null; next = null; }</p>
<p>​              Node(T item, Node next) {</p>
<p>​                     this.item = item;</p>
<p>​                     this.next = next;</p>
<p>​              }</p>
<p>​              boolean end() { return item == null &amp;&amp; next == null; }</p>
<p>​       }</p>
<p>​       private Node top = new Node();      public void push(T item) {</p>
<p>​              top = new Node(item, top);</p>
<p>​       }</p>
<p>​       public T pop() {</p>
<p>​              T result = top.item;</p>
<p>​              if(!top.end())</p>
<p>​                     top = top.next;</p>
<p>​              return result;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              LinkedStack5<string> lss = new LinkedStack5<string>();</string></string></p>
<p>​              for(String s: “Phasers on stun!”.split(“ “)) </p>
<p>​                     lss.push(s);</p>
<p>​              String s;</p>
<p>​              while((s = lss.pop()) != null)</p>
<p>​                     System.out.println(s);</p>
<p>​       }</p>
<p>}</p>
<p>public class RandomList6<t> {</t></p>
<p>​       private ArrayList<t> storage = new ArrayList<t>();</t></t></p>
<p>​       private Random rand = new Random(47);</p>
<p>​       public void add(T item) { storage.add(item); }</p>
<p>​       public T select() {</p>
<p>​              return storage.get(rand.nextInt(storage.size()));</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              RandomList6<string> rs = new RandomList6<string>();</string></string></p>
<p>​              for(String s : (“The quick brown fox jumped over “ +</p>
<p>​                     “the lazy brown dog”).split(“ “))</p>
<p>​                     rs.add(s);</p>
<p>​              for(int i = 0; i &lt; 11; i++)</p>
<p>​                     System.out.print(rs.select() + “ “);</p>
<p>​              System.out.println();</p>
<p>​              RandomList6<integer> ri = new RandomList6<integer>();</integer></integer></p>
<p>​              for(int i = 0; i &lt; 11; i++)</p>
<p>​                     ri.add(i);               for(int i = 0; i &lt; 11; i++)</p>
<p>​                     System.out.print(ri.select() + “ “); </p>
<p>​              System.out.println();</p>
<p>​              RandomList6<pet> rp = new RandomList6<pet>();</pet></pet></p>
<p>​              for(Pet p : Pets.arrayList(10))</p>
<p>​                     rp.add(p);</p>
<p>​              for(int i = 0; i &lt; 11; i++)</p>
<p>​                     System.out.print(rp.select() + “ “);      </p>
<p>​       }</p>
<p>}</p>
<p>public class Fibonacci7 implements Generator<integer>, Iterable<integer> {</integer></integer></p>
<p>​       private int count = 0;</p>
<p>​       private int m;</p>
<p>​       public Integer next() { return fib(count++); }</p>
<p>​       private int fib(int n) {</p>
<p>​              if(n &lt; 2) return 1;</p>
<p>​              return fib(n - 2) + fib(n - 1);</p>
<p>​       }</p>
<p>​       public Fibonacci7() {}</p>
<p>​       public Fibonacci7(int m) { this.m = m; }</p>
<p>​       public Iterator<integer> iterator() {</integer></p>
<p>​              return new Iterator<integer>() {</integer></p>
<p>​                     public boolean hasNext() { return m &gt; 0; }</p>
<p>​                     public Integer next() {</p>
<p>​                            m–;</p>
<p>​                            return Fibonacci7.this.next();</p>
<p>​                     }</p>
<p>​                     public void remove() {                             throw new UnsupportedOperationException();</p>
<p>​                     }</p>
<p>​              };</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Fibonacci7 gen = new Fibonacci7();</p>
<p>​              for(int i = 0; i &lt; 18; i++)</p>
<p>​                     System.out.print(gen.next() + “ “);</p>
<p>​              System.out.println();</p>
<p>​              Iterator it = new Fibonacci7(20).iterator();</p>
<p>​              while(it.hasNext())</p>
<p>​                     System.out.print(it.next() + “ “);</p>
<p>​       }</p>
<p>​       </p>
<p>}</p>
<p>public class StoryCharacterGenerator </p>
<p>​       implements Generator<storycharacter>,  Iterable<storycharacter> {</storycharacter></storycharacter></p>
<p>​       private Class[] types = { DarthVader.class, JabbaTheHut.class, </p>
<p>​              LukeSkywalker.class, Yoda.class };</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public StoryCharacterGenerator() {}</p>
<p>​             private int size = 0;</p>
<p>​       public StoryCharacterGenerator(int sz) { size = sz; }</p>
<p>​       public StoryCharacter next() {</p>
<p>​              try {</p>
<p>​                     return </p>
<p>​                     (StoryCharacter)types[rand.nextInt(types.length)].newInstance();</p>
<p>​                           } catch(Exception e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       }      </p>
<p>​       class StoryCharacterIterator implements Iterator<storycharacter> {</storycharacter></p>
<p>​              int count = size;</p>
<p>​              public boolean hasNext() { return count &gt; 0; }</p>
<p>​              public StoryCharacter next() {</p>
<p>​                     count–;</p>
<p>​                     return StoryCharacterGenerator.this.next();</p>
<p>​              }</p>
<p>​              public void remove() {                      throw new UnsupportedOperationException();</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public Iterator<storycharacter> iterator() {</storycharacter></p>
<p>​              return new StoryCharacterIterator();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              StoryCharacterGenerator gen = new StoryCharacterGenerator();</p>
<p>​              for(int i = 0; i &lt; 5; i++)</p>
<p>​                     System.out.println(gen.next());</p>
<p>​              for(StoryCharacter s : new StoryCharacterGenerator(5))</p>
<p>​                     System.out.println(s); </p>
<p>​       }</p>
<p>}</p>
<p>  public class GenericMethods9 {</p>
<p>​       public &lt;T, U, V&gt; void f(T x, U y, V z) {</p>
<p>​              System.out.println(x.getClass().getName() +</p>
<p>​              “ “ + y.getClass().getName() +</p>
<p>​              “ “ + z.getClass().getName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              GenericMethods9 gm = new GenericMethods9();</p>
<p>​              gm.f(“”, 1, 1.0);</p>
<p>​              gm.f(1.0F, ‘c’, gm);</p>
<p>​       }</p>
<p>}</p>
<p>  public class GenericMethods10 {</p>
<p>​       public &lt;T, U&gt; void f(T x, U y, Integer z) {</p>
<p>​              System.out.println(x.getClass().getName() +</p>
<p>​              “ “ + y.getClass().getName() +</p>
<p>​              “ “ + z.getClass().getName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              GenericMethods10 gm = new GenericMethods10();</p>
<p>​              gm.f(“”, 1, 1);</p>
<p>​              gm.f(1.0F, ‘c’, 1);</p>
<p>​       }</p>
<p>}</p>
<p>class A { public String toString() { return “A”; } }</p>
<p>class B { public String toString() { return “B”; } }</p>
<p>class C extends B { </p>
<p>​       public String toString() { return “C”; }</p>
<p>}  </p>
<p>public class New11 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              A a = new A();</p>
<p>​              B b = new B();</p>
<p>​              C c = new C();</p>
<p>​              List<c> lc = New.list();</c></p>
<p>​              lc.add(new C());</p>
<p>​              Map&lt;A,List&lt;? extends B&gt;&gt; mab = New.map();</p>
<p>​              mab.put(a,lc);</p>
<p>​              LinkedList<b> llb = New.lList();</b></p>
<p>​              llb.add(new B());</p>
<p>​              Set<a> sa = New.set();</a></p>
<p>​              sa.add(new A());</p>
<p>​              Queue<b> qb = New.queue();</b></p>
<p>​              qb.add(new B());</p>
<p>​              println(lc);</p>
<p>​              println(mab);</p>
<p>​              println(llb);</p>
<p>​              println(sa);</p>
<p>​              println(qb);</p>
<p>​       }</p>
<p>}</p>
<p>public class LimitsOfInference12 {</p>
<p>​       static void f(Map&lt;Person, List&lt;? extends Pet&gt;&gt; petPeople) {}</p>
<p>​       public static void main(String[] args) {</p>
<p>​              f(New.&lt;Person, List&lt;? extends Pet&gt;&gt;map()); </p>
<p>​       }</p>
<p>}</p>
<p>public class Generators13 {</p>
<p>​       public static <t> Collection<t> fill(Collection<t> coll, Generator<t> gen, int n) {</t></t></t></t></p>
<p>​              for(int i = 0; i &lt; n; i++) coll.add(gen.next());</p>
<p>​              return coll;</p>
<p>​       }</p>
<p>​       public static <t> List<t> fill(List<t> l, Generator<t> gen, int n) {</t></t></t></t></p>
<p>​              for(int i = 0; i &lt; n; i++) l.add(gen.next());</p>
<p>​              return l;</p>
<p>​       }</p>
<p>​       public static <t> Queue<t> fill(Queue<t> q, Generator<t> gen, int n) {</t></t></t></t></p>
<p>​              for(int i = 0; i &lt; n; i++) q.add(gen.next());</p>
<p>​              return q;</p>
<p>​       }</p>
<p>​       public static <t> Set<t> fill(Set<t> s, Generator<t> gen, int n) {</t></t></t></t></p>
<p>​              for(int i = 0; i &lt; n; i++) s.add(gen.next());</p>
<p>​              return s;</p>
<p>​       }</p>
<p>​             public static <t> LinkedList<t> fill(LinkedList<t> ll, Generator<t> gen, int n) {</t></t></t></t></p>
<p>​              for(int i = 0; i &lt; n; i++) ll.add(gen.next());</p>
<p>​              return ll;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Collection<coffee> coffee = fill(new ArrayList<coffee>(), new CoffeeGenerator(), 4);</coffee></coffee></p>
<p>​              for(Coffee c : coffee) System.out.println(c);</p>
<p>​              Collection<integer> fnumbers = fill(new ArrayList<integer>(), new Fibonacci(), 12);</integer></integer></p>
<p>​              for(int i : fnumbers) System.out.print(i + “, “);</p>
<p>​              println();</p>
<p>​              List<coffee> coffeeList = fill(new ArrayList<coffee>(), new CoffeeGenerator(), 5);</coffee></coffee></p>
<p>​              println(“List type: “ + coffeeList.getClass());</p>
<p>​              println(“coffeeList:” + coffeeList);        </p>
<p>​              Queue<coffee> coffeeQueue = fill(new ArrayDeque<coffee>(), new CoffeeGenerator(), 5);</coffee></coffee></p>
<p>​              println(“Queue type: “ + coffeeQueue.getClass());</p>
<p>​              println(“coffeeQueue: “ + coffeeQueue); </p>
<p>​              Set<coffee> coffeeSet = fill(new HashSet<coffee>(), new CoffeeGenerator(), 5);</coffee></coffee></p>
<p>​              println(“Set type: “ + coffeeSet.getClass());</p>
<p>​              println(“coffeeSet: “ + coffeeSet);</p>
<p>​              LinkedList<coffee> coffeeLinkedList = fill(new LinkedList<coffee>(), new CoffeeGenerator(), 5);</coffee></coffee></p>
<p>​              println(“LinkedList type: “ + coffeeLinkedList.getClass());</p>
<p>​              println(“coffeeLinkedList: “ + coffeeLinkedList);</p>
<p>​       }</p>
<p>}</p>
<p>public class BasicGeneratorDemo14  {     </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Generator<countedobject> gen = </countedobject></p>
<p>​                     new BasicGenerator<countedobject>(CountedObject.class);</countedobject></p>
<p>​              for(int i = 0; i &lt; 5; i++)</p>
<p>​                     System.out.println(gen.next());</p>
<p>​       }</p>
<p>}</p>
<p>public class TupleTest15 {</p>
<p>​       static TwoTuple&lt;String,Integer&gt; f() {</p>
<p>​              return tuple(“hi”, 47);</p>
<p>​       }</p>
<p>​       static TwoTuple f2() { return tuple(“hi”, 47); }</p>
<p>​       static ThreeTuple&lt;Amphibian,String,Integer&gt; g() {</p>
<p>​              return tuple(new Amphibian(), “hi”, 47);</p>
<p>​       }</p>
<p>​       static FourTuple&lt;Vehicle,Amphibian,String,Integer&gt; h() {</p>
<p>​              return tuple(new Vehicle(), new Amphibian(), “hi”, 47);</p>
<p>​       }</p>
<p>​       static FiveTuple&lt;Vehicle,Amphibian,String,Integer,Double&gt; k() {</p>
<p>​              return tuple(new Vehicle(), new Amphibian(), “hi”, 47,</p>
<p>​              11.1);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TwoTuple&lt;String,Integer&gt; ttsi = f();</p>
<p>​                           TwoTuple&lt;String,Integer&gt; ttsi2 = f2();</p>
<p>​              System.out.println(ttsi);</p>
<p>​              System.out.println(f2());</p>
<p>​              System.out.println(g());</p>
<p>​              System.out.println(h());</p>
<p>​              System.out.println(k());</p>
<p>​       }</p>
<p>}</p>
<p>public class TupleTest16 {</p>
<p>​       static TwoTuple&lt;String,Integer&gt; f() {</p>
<p>​              return tuple(“hi”, 47);</p>
<p>​       }</p>
<p>​       static TwoTuple f2() { return tuple(“hi”, 47); }</p>
<p>​       static ThreeTuple&lt;Amphibian,String,Integer&gt; g() {</p>
<p>​              return tuple(new Amphibian(), “hi”, 47);</p>
<p>​       }</p>
<p>​       static FourTuple&lt;Vehicle,Amphibian,String,Integer&gt; h() {</p>
<p>​              return tuple(new Vehicle(), new Amphibian(), “hi”, 47);</p>
<p>​       }</p>
<p>​       static FiveTuple&lt;Vehicle,Amphibian,String,Integer,Double&gt; k() {</p>
<p>​              return tuple(new Vehicle(), new Amphibian(), “hi”, 47,</p>
<p>​              11.1);</p>
<p>​       }</p>
<p>​             static org.greggordon.util.SixTuple&lt;Robot,Vehicle,Amphibian,String,Integer,Double&gt; m() {</p>
<p>​              return tuple(new Robot(), new Vehicle(), new Amphibian(), “hi”, 47, 11.1);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TwoTuple&lt;String,Integer&gt; ttsi = f();</p>
<p>​              System.out.println(ttsi);</p>
<p>​              System.out.println(f2());</p>
<p>​              System.out.println(g());</p>
<p>​              System.out.println(h());</p>
<p>​              System.out.println(k());</p>
<p>​              System.out.println(m());</p>
<p>​       }</p>
<p>}</p>
<p>public class Sets17 {     </p>
<p>​       public static <t> Set<t> union(Set<t> a, Set<t> b) {          </t></t></t></t></p>
<p>​              try {</p>
<p>​                     if(a instanceof EnumSet) {</p>
<p>​                            Set<t> result = ((EnumSet<t>)a).clone();</t></t></p>
<p>​                            result.addAll(b);</p>
<p>​                                return result;</p>
<p>​                            }</p>
<p>​              } catch(Exception e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​              Set<t> result = new HashSet<t>(a);</t></t></p>
<p>​                  result.addAll(b);</p>
<p>​                  return result;</p>
<p>​       }      </p>
<p>​      public static <t> Set<t> intersection(Set<t> a, Set<t> b) {</t></t></t></t></p>
<p>​              try {</p>
<p>​                     if(a instanceof EnumSet) {</p>
<p>​                            Set<t> result = ((EnumSet<t>)a).clone();</t></t></p>
<p>​                            result.retainAll(b);</p>
<p>​                                return result;</p>
<p>​                            }</p>
<p>​              } catch(Exception e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​                  Set<t> result = new HashSet<t>(a);</t></t></p>
<p>​                  result.retainAll(b);</p>
<p>​                  return result;</p>
<p>​      }      </p>
<p>​           public static <t> Set<t>  difference(Set<t> superset, Set<t> subset) {</t></t></t></t></p>
<p>​              try {</p>
<p>​                     if(superset instanceof EnumSet) {</p>
<p>​                            Set<t> result = ((EnumSet<t>)superset).clone();</t></t></p>
<p>​                            result.removeAll(subset);</p>
<p>​                                return result;</p>
<p>​                            }</p>
<p>​              } catch(Exception e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​                  Set<t> result = new HashSet<t>(superset);</t></t></p>
<p>​                  result.removeAll(subset);</p>
<p>​                  return result;</p>
<p>​      }</p>
<p>​           public static <t> Set<t> complement(Set<t> a, Set<t> b) {</t></t></t></t></p>
<p>​                  return difference(union(a, b), intersection(a, b));</p>
<p>​      }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Set<watercolors> set1 =</watercolors></p>
<p>​                     EnumSet.range(BRILLIANT_RED, VIRIDIAN_HUE);</p>
<p>​              Set<watercolors> set2 =</watercolors></p>
<p>​                     EnumSet.range(CERULEAN_BLUE_HUE, BURNT_UMBER);</p>
<p>​              print(“set1: “ + set1);</p>
<p>​              print(“set2: “ + set2);</p>
<p>​              print(“union(set1, set2): “ + union(set1, set2));</p>
<p>​              Set<watercolors> subset = intersection(set1, set2);</watercolors></p>
<p>​              print(“intersection(set1, set2): “ + subset);</p>
<p>​              print(“difference(set1, set2): “ + </p>
<p>​                     difference(set1, set2));</p>
<p>​              print(“difference(set2, subset): “ + </p>
<p>​                     difference(set2, subset));</p>
<p>​              print(“complement(set1, set2): “ + </p>
<p>​                     complement(set1, set2));</p>
<p>​       }</p>
<p>} </p>
<p>class BigFish {</p>
<p>​       private static long counter = 0;</p>
<p>​       private final long id = ++counter;</p>
<p>​       private BigFish() {}</p>
<p>​       public String toString() {</p>
<p>​              return “BigFish” + id;</p>
<p>​       }</p>
<p>​       public static Generator<bigfish> generator() {</bigfish></p>
<p>​              return new Generator<bigfish>() {</bigfish></p>
<p>​                     public BigFish next() {</p>
<p>​                            return new BigFish();</p>
<p>​                     }      </p>
<p>​              };</p>
<p>​       }</p>
<p>}</p>
<p>class LittleFish {</p>
<p>​       private static long counter = 0;</p>
<p>​       private final long id = ++counter;</p>
<p>​       private LittleFish() {}</p>
<p>​       public String toString() {</p>
<p>​              return “LittleFish” + id;</p>
<p>​       }</p>
<p>​       public static Generator<littlefish> generator =</littlefish></p>
<p>​              new Generator<littlefish>() {</littlefish></p>
<p>​                     public LittleFish next() {</p>
<p>​                            return new LittleFish();</p>
<p>​                     }</p>
<p>​              };</p>
<p>}</p>
<p>public class Ocean18 {</p>
<p>​       public static void eat(BigFish bf, LittleFish lf) {</p>
<p>​              System.out.println(bf + “ eats “ + lf);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Random rand = new Random();</p>
<p>​              List<bigfish> hunters = new ArrayList<bigfish>();</bigfish></bigfish></p>
<p>​              Generators.fill(hunters, BigFish.generator(), 3);</p>
<p>​              Queue<littlefish> school = new LinkedList<littlefish>();</littlefish></littlefish></p>
<p>​              Generators.fill(school, LittleFish.generator, 15);</p>
<p>​              for(LittleFish f : school)</p>
<p>​                     eat(hunters.get(rand.nextInt(hunters.size())), f);</p>
<p>​       }</p>
<p>}</p>
<p>class Item {</p>
<p>​       private final int id;</p>
<p>​       private String description;</p>
<p>​       private String destination;</p>
<p>​       private double price;</p>
<p>​       public Item(int idNumber, String what, String whereTo, double price) {</p>
<p>​              id = idNumber;</p>
<p>​              description = what;</p>
<p>​              destination = whereTo;</p>
<p>​              this.price = price;</p>
<p>​              System.out.println(toString());</p>
<p>​       } </p>
<p>​       public String toString() {</p>
<p>​              return id + “, “ + description + “, “ + “$” + price + “, to: “ +</p>
<p>​                     destination;</p>
<p>​       }</p>
<p>​       public void priceChange(double change) {</p>
<p>​              price += change;</p>
<p>​       }</p>
<p>​       public static Generator<item> generator = </item></p>
<p>​              new Generator<item>() {</item></p>
<p>​                     private Random rand = new Random();</p>
<p>​                     public Item next() {</p>
<p>​                            return new Item(rand.nextInt(1000), </p>
<p>​                            “Very nice … “,  “Destination: …”, </p>
<p>​                            Math.round(rand.nextDouble() * 1000.0)); </p>
<p>​                     }</p>
<p>​              };</p>
<p>}</p>
<p>class Shelf extends ArrayList<item> {</item></p>
<p>​       public Shelf(int nItems) {</p>
<p>​              Generators.fill(this, Item.generator, nItems);</p>
<p>​       }</p>
<p>}</p>
<p>class StorageArea extends ArrayList<shelf> {</shelf></p>
<p>​       public StorageArea(int nShelves, int nItems) {</p>
<p>​              for(int i = 0; i &lt; nShelves; i++)</p>
<p>​                     add(new Shelf(nItems));</p>
<p>​       }</p>
<p>}</p>
<p>class Deck extends ArrayList<storagearea> {</storagearea></p>
<p>​       public Deck(int nStorageAreas, int nShelves, int nItems) {</p>
<p>​              for(int i = 0; i &lt; nStorageAreas; i++)</p>
<p>​                     add(new StorageArea(nShelves, nItems));</p>
<p>​       }</p>
<p>}</p>
<p>class Office {}</p>
<p>public class CargoShip19 extends ArrayList<deck> {</deck></p>
<p>​       private Office office;</p>
<p>​       public CargoShip19(int nDecks, int nStorageAreas, int nShelves, int nItems) {</p>
<p>​              for(int i = 0; i &lt; nDecks; i++)</p>
<p>​                     add(new Deck(nStorageAreas, nShelves, nItems));</p>
<p>​       }      </p>
<p>​       public String toString() {</p>
<p>​              StringBuilder result = new StringBuilder();</p>
<p>​              for(Deck d : this)</p>
<p>​                     for(StorageArea sa : d)</p>
<p>​                            for(Shelf s : sa)</p>
<p>​                                   for(Item i : s) {</p>
<p>​                                          result.append(i);</p>
<p>​                                          result.append(‘\n’);</p>
<p>​                                   }</p>
<p>​              return result.toString();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              System.out.println(new CargoShip19(3, 4, 3, 10));</p>
<p>​       }</p>
<p>}</p>
<p>interface A {</p>
<p>​       void f();</p>
<p>​       void g();</p>
<p>}</p>
<p>class A3 implements A {</p>
<p>​       public void f() { System.out.println(“A3.f()”); }</p>
<p>​       public void g() { System.out.println(“A3.g()”); }</p>
<p>​       public void h() { System.out.println(“A3.h()”); }</p>
<p>}</p>
<p>class G {</p>
<p>​       public static <t extends a> void j(T x) { </t></p>
<p>​              x.f();</p>
<p>​              x.g();</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex20 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              A3 a3 = new A3();</p>
<p>​              G.j(a3);    </p>
<p>​       }</p>
<p>}</p>
<p>public class ClassTypeCapture21<t> {</t></p>
<p>​       Class&lt;?&gt; kind;</p>
<p>​       Map&lt;String,Class&lt;?&gt;&gt; map;</p>
<p>​       public ClassTypeCapture21(Class&lt;?&gt; kind) {</p>
<p>​              this.kind = kind;</p>
<p>​       }</p>
<p>​       public ClassTypeCapture21(Class<?> kind, Map<string,class<?>&gt; map) {</string,class<?></p>
<p>​              this.kind = kind;</p>
<p>​              this.map = map;</p>
<p>​       }</p>
<p>​       public boolean f(Object arg) {</p>
<p>​              return kind.isInstance(arg);</p>
<p>​       }</p>
<p>​       public void addType(String typename, Class&lt;?&gt; kind) {</p>
<p>​              map.put(typename, kind);</p>
<p>​       }</p>
<p>​       public Object createNew(String typename) </p>
<p>​              throws IllegalAccessException, InstantiationException {</p>
<p>​              if(map.containsKey(typename))</p>
<p>​                     return map.get(typename).newInstance();                </p>
<p>​              System.out.println(typename + “ class not available”);</p>
<p>​              return null;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ClassTypeCapture21<building> ctt1 = new ClassTypeCapture21<building>(Building.class);</building></building></p>
<p>​              println(ctt1.f(new Building()));</p>
<p>​              println(ctt1.f(new House()));</p>
<p>​              ClassTypeCapture21<house> ctt2 = new ClassTypeCapture21<house>(House.class);</house></house></p>
<p>​              println(ctt2.f(new Building()));</p>
<p>​              println(ctt2.f(new House()));</p>
<p>​              ClassTypeCapture21<building> ct = </building></p>
<p>​              new ClassTypeCapture21<building>(Building.class, new HashMap&lt;String, Class&lt;?&gt;&gt;());</building></p>
<p>​              ct.addType(“House”, House.class);</p>
<p>​              ct.addType(“Building”, Building.class);</p>
<p>​              println(“ct.map = “ + ct.map);</p>
<p>​              try {</p>
<p>​                     Building b = (Building)ct.createNew(“Building”);</p>
<p>​                     House h = (House)ct.createNew(“House”);</p>
<p>​                     print(“b.getClass().getName(): “);</p>
<p>​                     println(b.getClass().getName());</p>
<p>​                     print(“h.getClass().getName(): “);</p>
<p>​                     println(h.getClass().getName());</p>
<p>​                     print(“House h is instance House: “);</p>
<p>​                     println(h instanceof House);</p>
<p>​                     print(“House h is instance of Building: “);</p>
<p>​                     println(h instanceof Building);</p>
<p>​                     print(“Building b is instance of House: “);</p>
<p>​                     println(b instanceof House);</p>
<p>​                     ct.createNew(“String”);             } catch(IllegalAccessException e) {</p>
<p>​                     println(“IllegalAccessException in main”);</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     println(“InstantiationException in main”);</p>
<p>​              }             </p>
<p>​       }</p>
<p>}</p>
<p>class Building {}</p>
<p>class House extends Building {</p>
<p>​       private String location;</p>
<p>​       private Integer area;</p>
<p>​       public House() { location = null; }</p>
<p>​       public House(Integer area) { this.area = area; }</p>
<p>​       public House(String location) {</p>
<p>​              this.location = location;</p>
<p>​       }</p>
<p>​       public House(String location, Integer area) {</p>
<p>​              this.location = location;</p>
<p>​              this.area = area;</p>
<p>​       }</p>
<p>​       public String toString() {</p>
<p>​              return “House” + ((location == null) ? “” :  “ in “ + location) +</p>
<p>​                     ((area != null) ? (“, “+ area + “ sqft”) : “”);</p>
<p>​       }</p>
<p>}</p>
<p>public class ClassTypeCreator22<t> {</t></p>
<p>​       Class&lt;?&gt; kind;</p>
<p>​       public ClassTypeCreator22(Class&lt;?&gt; kind) {</p>
<p>​              this.kind = kind;</p>
<p>​       }</p>
<p>​       public Object createNew(String typename) </p>
<p>​              throws   IllegalAccessException, </p>
<p>​                     InstantiationException, </p>
<p>​                     ClassNotFoundException {</p>
<p>​              return Class.forName(typename).newInstance();</p>
<p>​       }      </p>
<p>​             public Object createNew(String typename, Object… args) </p>
<p>​              throws   IllegalAccessException, </p>
<p>​                     InstantiationException, </p>
<p>​                     ClassNotFoundException,</p>
<p>​                     NoSuchMethodException,</p>
<p>​                     InvocationTargetException {</p>
<p>​              switch(args.length) {</p>
<p>​              case 1 : return Class.forName(typename).getConstructor(args[0].getClass()).newInstance(args[0]);</p>
<p>​              case 2 : return Class.forName(typename).getConstructor(args[0].getClass(), args[1].getClass()).</p>
<p>​                     newInstance(args[0], args[1]);</p>
<p>​              }</p>
<p>​              return null;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ClassTypeCreator22<building> ctcb = new ClassTypeCreator22<building>(Building.class);</building></building></p>
<p>​              ClassTypeCreator22<house> ctch = new ClassTypeCreator22<house>(House.class);</house></house></p>
<p>​              try {</p>
<p>​                     Building b = (Building)ctcb.createNew(“Building”);</p>
<p>​                                         println(“House constructors:”);</p>
<p>​                     Constructor[] ctors = House.class.getConstructors();</p>
<p>​                     for(Constructor ctor : ctors) println(ctor);</p>
<p>​                                         House h = (House)ctch.createNew(“House”, “Hawaii”);</p>
<p>​                     House h2 = (House)ctch.createNew(“House”, 3000);</p>
<p>​                     House h3 = (House)ctch.createNew(“House”, “Manila”, 5000);</p>
<p>​                     println(“Constructed House objects:”);</p>
<p>​                     println(h);</p>
<p>​                     println(h2);</p>
<p>​                     println(h3);</p>
<p>​              } catch(IllegalAccessException e) {</p>
<p>​                     println(“IllegalAccessException in main”);</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     println(“InstantiationException in main”);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     println(“ClassNotFoundException in main”);</p>
<p>​              } catch(NoSuchMethodException e) {</p>
<p>​                     println(“NoSuchMethodException in main”);</p>
<p>​              } catch(InvocationTargetException e) {</p>
<p>​                     println(“InvocationTargetException in main”);</p>
<p>​              }             </p>
<p>​       }</p>
<p>}</p>
<p> interface FactoryI<t> {</t></p>
<p>​       T create(Integer i);</p>
<p>}</p>
<p>class Foo2<t> {</t></p>
<p>​       private T x;</p>
<p>​       public void get() { System.out.println(x); }</p>
<p>​       public &lt;F extends FactoryI<t>&gt; Foo2(F factory, Integer i) {</t></p>
<p>​              x = factory.create(i);</p>
<p>​       }</p>
<p>}</p>
<p>class IntegerFactory implements FactoryI<integer> {</integer></p>
<p>​       public Integer create(Integer i) {</p>
<p>​              return new Integer(i);</p>
<p>​       }</p>
<p>}</p>
<p>class Widget {</p>
<p>​       int i;</p>
<p>​       public static class Factory implements FactoryI<widget> {</widget></p>
<p>​              public Widget create(Integer i) {</p>
<p>​                     Widget w = new Widget();</p>
<p>​                     w.i = i;</p>
<p>​                     return w;</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public String toString() {</p>
<p>​              return “Widget “ + i;     </p>
<p>​       }</p>
<p>}</p>
<p>public class FactoryConstraint23 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Foo2 f1 = new Foo2<integer>(new IntegerFactory(), 1);</integer></p>
<p>​              Foo2 f2 = new Foo2<widget>(new Widget.Factory(), 2);</widget></p>
<p>​              f1.get();</p>
<p>​              f2.get();</p>
<p>​              }</p>
<p>}</p>
<p>interface Factory<t> {</t></p>
<p>​       T create();</p>
<p>}</p>
<p>class Building {}</p>
<p>class House extends Building {}</p>
<p>class BuildingFactory implements Factory<building> {</building></p>
<p>​       public Building create() {</p>
<p>​              return new Building();</p>
<p>​       }</p>
<p>}</p>
<p>class HouseFactory implements Factory<house> {</house></p>
<p>​       public House create() {</p>
<p>​              return new House();</p>
<p>​       }</p>
<p>}</p>
<p>public class ClassTypeCapture24<t> {</t></p>
<p>​       Class&lt;?&gt; kind;</p>
<p>​       public ClassTypeCapture24(Class&lt;?&gt; kind) {</p>
<p>​              this.kind = kind;</p>
<p>​       }</p>
<p>​       Map&lt;String,Factory&gt; map;  </p>
<p>​       public ClassTypeCapture24(Class&lt;?&gt; kind, Map&lt;String,Factory&gt; map) {</p>
<p>​              this.kind = kind;</p>
<p>​              this.map = map;</p>
<p>​       }</p>
<p>​       public boolean f(Object arg) {</p>
<p>​              return kind.isInstance(arg);</p>
<p>​       }</p>
<p>​       public void addType(String typename, Factory factory) {</p>
<p>​              map.put(typename, factory);</p>
<p>​       }</p>
<p>​       public Object createNew(String typename) </p>
<p>​              throws IllegalAccessException, InstantiationException {</p>
<p>​              if(map.containsKey(typename))</p>
<p>​                     return map.get(typename).create();                  </p>
<p>​              System.out.println(typename + “ class not available”);</p>
<p>​              return null;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ClassTypeCapture24<building> ctt1 = </building></p>
<p>​                     new ClassTypeCapture24<building>(Building.class);</building></p>
<p>​              println(ctt1.f(new Building()));</p>
<p>​              println(ctt1.f(new House()));</p>
<p>​              ClassTypeCapture24<house> ctt2 = </house></p>
<p>​                     new ClassTypeCapture24<house>(House.class);</house></p>
<p>​              println(ctt2.f(new Building()));</p>
<p>​              println(ctt2.f(new House()));</p>
<p>​              ClassTypeCapture24<building> ct = </building></p>
<p>​              new ClassTypeCapture24<building>(</building></p>
<p>​                     Building.class, new HashMap&lt;String,Factory&gt;());</p>
<p>​              ct.addType(“House”, new HouseFactory());</p>
<p>​              ct.addType(“Building”, new BuildingFactory());</p>
<p>​              println(“ct.map = “ + ct.map);</p>
<p>​              try {</p>
<p>​                     Building b = (Building)ct.createNew(“Building”);</p>
<p>​                     House h = (House)ct.createNew(“House”);</p>
<p>​                     print(“b.getClass().getName(): “);</p>
<p>​                     println(b.getClass().getName());</p>
<p>​                     print(“h.getClass().getName(): “);</p>
<p>​                     println(h.getClass().getName());</p>
<p>​                     print(“House h is instance House: “);</p>
<p>​                     println(h instanceof House);</p>
<p>​                     print(“House h is instance of Building: “);</p>
<p>​                     println(h instanceof Building);</p>
<p>​                     print(“Building b is instance of House: “);</p>
<p>​                     println(b instanceof House);</p>
<p>​                     ct.createNew(“String”);             } catch(IllegalAccessException e) {</p>
<p>​                     println(“IllegalAccessException in main”);</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     println(“InstantiationException in main”);</p>
<p>​              }             </p>
<p>​       }</p>
<p>}</p>
<p>interface A {}</p>
<p>interface B {} </p>
<p>class C implements A, B {</p>
<p>​       public String toString() { return “C”; }</p>
<p>}</p>
<p>public class Ex25 {</p>
<p>​       <t extends a> void a(T t) { System.out.println(“a(“ + t + “)”); }</t></p>
<p>​       <t extends b> void b(T t) { System.out.println(“b(“ + t + “)”); }</t></p>
<p>​       public static void main(String[] args) {</p>
<p>​              C c = new C();</p>
<p>​              Ex25 ex = new Ex25();</p>
<p>​              ex.a(c);</p>
<p>​              ex.b(c);</p>
<p>​       }</p>
<p>}</p>
<p> public class Ex26 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Number[] numbers = new Integer[3];</p>
<p>​              numbers[0] = new Integer(0);</p>
<p>​              numbers[1] = new Integer(1);</p>
<p>​              numbers[2] = new Integer(2);</p>
<p>​                                        try {                     numbers[1] = new Double(3.4);</p>
<p>​              } catch(Exception e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​              for(Number n : numbers)</p>
<p>​                     System.out.println(n);</p>
<p>​                                                                               for(Number n : numbers)</p>
<p>​                     System.out.println(n.getClass().getSimpleName());    </p>
<p>​       }      </p>
<p>}</p>
<p>​    import java.util.*;</p>
<p>public class Ex27 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                                        List&lt;? extends Number&gt; nlist = new ArrayList<integer>();</integer></p>
<p>​                                        nlist.add(null);             Number x = nlist.get(0);            System.out.println(nlist);</p>
<p>​       }      </p>
<p>}</p>
<p>public class Ex28 {</p>
<p>​       class Generic1<t> {</t></p>
<p>​              T t;</p>
<p>​              void take(T t) { this.t = t; }</p>
<p>​       }</p>
<p>​             class Generic2<t> {</t></p>
<p>​              T t;</p>
<p>​              T give() { return t; }</p>
<p>​       }</p>
<p>​       <t> void contra(Generic1&lt;? super T&gt; g1t, T t) {</t></p>
<p>​              g1t.take(t);</p>
<p>​       }</p>
<p>​       <t> T co(Generic2&lt;? extends T&gt; g2t) {</t></p>
<p>​              return g2t.give();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Ex28 e28 = new Ex28();</p>
<p>​              e28.contra(e28.new Generic1<pet>(), new Cat(“kitty”));</pet></p>
<p>​              e28.co(e28.new Generic2<pet>());             </pet></p>
<p>​       }</p>
<p>}</p>
<p>public class Ex29 {</p>
<p>​       static void f1(Holder&lt;List&lt;?&gt;&gt; holder) {</p>
<p>​              println(“Calling methods for the Holder: “);</p>
<p>​              println(“holder: “ + holder);</p>
<p>​              println(“holder.get(): “ + holder.get());</p>
<p>​              println(“Calling holder.set(Arrays.asList(1,2,3)”);</p>
<p>​              holder.set(Arrays.asList(1,2,3));</p>
<p>​              println(“holder.get(): “ + holder.get());</p>
<p>​              int[] ia = {1,2,3};</p>
<p>​              println(“int[] ia = {1,2,3}”);</p>
<p>​              println(“holder.equals(ia): “ + holder.equals(ia));</p>
<p>​              List iaList = Arrays.asList(ia);</p>
<p>​              println(“List iaList = Arrays.asList(ia)”);</p>
<p>​              println(“holder.equals(iaList): “ + holder.equals(iaList));</p>
<p>​              List<integer> l = new ArrayList<integer>();</integer></integer></p>
<p>​              for(int i = 1; i &lt; 4; i++) l.add(i);</p>
<p>​              println(“l = List<integer>() and add 1,2,3”);</integer></p>
<p>​              println(“holder.equals(l): “ + holder.equals(l));</p>
<p>​              println();</p>
<p>​                                   </p>
<p>​              println(“Calling methods for the List: “);</p>
<p>​              println(“holder.get(): “ + holder.get());</p>
<p>​              println(“holder.get().getClass(): “ + holder.get().getClass());</p>
<p>​                                                     List&lt;?&gt; list = holder.get();</p>
<p>​              println(“list: “ + list); </p>
<p>​                           List list1 = holder.get();                                       println(“list1.getClass(): “ + list1.getClass());</p>
<p>​              println(“list.equals(list1): “ + list.equals(list1));</p>
<p>​                           println(“list.contains(1): “ + list.contains(1));              </p>
<p>​              Collection<integer> c = new HashSet<integer>();</integer></integer></p>
<p>​              for(int i = 1; i &lt; 4; i++) c.add(i);</p>
<p>​              println(“list.containsAll(c): “ + list.containsAll(c));       </p>
<p>​              println(“list.equals(c): “ + list.equals(c));</p>
<p>​              println(“list = “ + list);</p>
<p>​              println(“c = “ + c);</p>
<p>​              println(“c.getClass(): “ + c.getClass());              println(“list.get(0) = “ + list.get(0));</p>
<p>​              println(“list.hashCode() = “ + list.hashCode());</p>
<p>​              println(“list.indexOf(2) = “ + list.indexOf(2));      </p>
<p>​              ListIterator li = list.listIterator();</p>
<p>​              println(“After ListIterator li = list.listIterator():”);</p>
<p>​              println(“li.next() = “ + li.next());</p>
<p>​                                                                                            println(“list.size() = “ + list.size());</p>
<p>​              println(“list.subList(1,2) = “ + list.subList(1,2));</p>
<p>​              Object[] oa = list.toArray();</p>
<p>​              println(“After Object[] oa = list.toArray():”);</p>
<p>​              print(“oa = “);</p>
<p>​              for(Object o : oa) print(o + “ “);</p>
<p>​              println(); </p>
<p>​                                        Number[] na = list.toArray(new Number[3]);</p>
<p>​              println(“After Number[] na = list.toArray(new Number[3]):”);</p>
<p>​              print(“na = “);</p>
<p>​              for(Number n : na) print(n + “ “);</p>
<p>​              println();</p>
<p>​       }</p>
<p>​       static void f2(List&lt;Holder&lt;?&gt;&gt; list) {</p>
<p>​              println(“Calling methods for the List: “);</p>
<p>​              println(“list = “ + list);</p>
<p>​              println(“Adding Integer, String, Double”);</p>
<p>​              list.add(new Holder<integer>(1));</integer></p>
<p>​              list.add(new Holder<string>(“two”));</string></p>
<p>​              list.add(new Holder<double>(3.0));</double></p>
<p>​              println(“list = “ + list);</p>
<p>​              println(“Elements of list: “);</p>
<p>​              for(Holder h : list) </p>
<p>​                     println(“h.get() = “ + h.get());</p>
<p>​              println(“Adding Float”);</p>
<p>​              list.add(3, new Holder<float>(4.0f));</float></p>
<p>​              println(“list = “ + list);</p>
<p>​              println(“Elements of list: “);</p>
<p>​              for(Holder h : list) </p>
<p>​                     println(“h.get() = “ + h.get());</p>
<p>​              println(“list.clear()”);</p>
<p>​              list.clear();</p>
<p>​              println(“list = “ + list);</p>
<p>​              Collection&lt;Holder&lt;?&gt;&gt; c = </p>
<p>​                     new ArrayList&lt;Holder&lt;?&gt;&gt;();</p>
<p>​              c.add(new Holder<string>(“one”));</string></p>
<p>​              c.add(new Holder<float>(2.0f));</float></p>
<p>​              c.add(new Holder<double>(3.0));</double></p>
<p>​              list.addAll(c);</p>
<p>​              println(“Adding String, Float, Double”);</p>
<p>​              println(“list = “ + list);</p>
<p>​              println(“Elements of list: “);</p>
<p>​              for(Holder h : list) </p>
<p>​                     println(“h.get() = “ + h.get().getClass().getSimpleName() </p>
<p>​                            + “ “ + h.get());</p>
<p>​              list.add(3, new Holder<string>(“four”));</string></p>
<p>​              println(“Elements of list: “);</p>
<p>​              for(Holder h : list) </p>
<p>​                     println(“h.get() = “ + h.get().getClass().getSimpleName() </p>
<p>​                            + “ “ + h.get());</p>
<p>​              Object listClone = ((ArrayList)list).clone();</p>
<p>​              println(“((ArrayList)list).clone() = “ +  listClone);</p>
<p>​              println(“((ArrayList)list).clone().getClass() = “ +</p>
<p>​                     ((ArrayList)list).clone().getClass());</p>
<p>​                                        println(“Replacing element with h4, new Holder<integer>(4)”);</integer></p>
<p>​              Holder<integer> h4 = new Holder<integer>(4);</integer></integer></p>
<p>​              list.set(3, h4);</p>
<p>​              println(“Elements of list Holders: “);</p>
<p>​              for(Holder h : list) </p>
<p>​                     println(h.get().getClass().getSimpleName() </p>
<p>​                            + “ “ + h.get());</p>
<p>​              println(“list.contains(list.set(3, h4): “ + </p>
<p>​                            list.contains(list.set(3, h4)));</p>
<p>​              println(“list.contains(4): “ + list.contains(4));</p>
<p>​              println(“list.contains(h4): “ + list.contains(h4));</p>
<p>​              println(“Adding null member to list”);        </p>
<p>​              list.add(null);</p>
<p>​              println(“list.contains(null): “ + list.contains(null));</p>
<p>​              println(“list.get(0).get(): “ + list.get(0).get());</p>
<p>​              println(“list.indexOf(h4) = “ + list.indexOf(h4));</p>
<p>​              println(“list.indexOf(null) = “ + list.indexOf(null));</p>
<p>​              println(“list.isEmpty(): “ + list.isEmpty());</p>
<p>​              println(“list.lastIndexOf(null) = “ + list.lastIndexOf(null));  </p>
<p>​              println(“Removing index 0”);</p>
<p>​              list.remove(0);</p>
<p>​              println(“Elements of list Holders: “);</p>
<p>​              for(Holder h : list) {</p>
<p>​                     if(h == null) println(“null”);</p>
<p>​                     else</p>
<p>​                     println(h.get().getClass().getSimpleName() </p>
<p>​                            + “ “ + h.get());      </p>
<p>​                     }</p>
<p>​              println(“Removing null”);</p>
<p>​              println(“Elements of list Holders: “);</p>
<p>​              for(Holder h : list) {</p>
<p>​                     if(h == null) println(“null”);</p>
<p>​                     else</p>
<p>​                     println(h.get().getClass().getSimpleName() </p>
<p>​                            + “ “ + h.get());      </p>
<p>​                     }</p>
<p>​                                        println(“list.size() = “ + list.size());</p>
<p>​              Object[] oa = list.toArray();</p>
<p>​              print(“list.toArray() = “);</p>
<p>​              for(int i = 0; i &lt; oa.length; i++) </p>
<p>​                     print(oa[i] + “ “);</p>
<p>​              println();</p>
<p>​              Holder[] ha = ((ArrayList&lt;Holder&lt;?&gt;&gt;)list).toArray(new Holder[4]);</p>
<p>​              println(“(ArrayList&lt;Holder&lt;?&gt;&gt;list).toArray(new Holder[4]) = “);</p>
<p>​              for(int i = 0; i &lt; ha.length; i++)</p>
<p>​                     print(ha[i] + “ “);</p>
<p>​              println();</p>
<p>​              println(“Holder[4] Holders are holding: “);</p>
<p>​              for(Holder h : ha) {</p>
<p>​                     if(h == null) println(“null”);</p>
<p>​                     else println(h.get());</p>
<p>​              }</p>
<p>​              println();         </p>
<p>​       </p>
<p>​              println(“Calling methods for the Holder: “);</p>
<p>​              println(“list = “ + list);</p>
<p>​              print(“Three Holders (one null) in list:”);</p>
<p>​              for(int i = 0; i &lt; list.size(); i++) {</p>
<p>​                     if(list.get(i) == null) println(“null”); </p>
<p>​                     else</p>
<p>​                     println(list.get(i).getClass().getSimpleName());</p>
<p>​              }</p>
<p>​              list.remove(3);</p>
<p>​              println(“Holders are holding:”);</p>
<p>​              for(Holder h : list) println(h.get());</p>
<p>​              Holder&lt;?&gt; h1 = list.get(0);</p>
<p>​              Holder&lt;?&gt; h2 = list.get(1);</p>
<p>​              Holder&lt;?&gt; h3 = list.get(2);</p>
<p>​              println(list.get(0).getClass() + “: “ </p>
<p>​                     + list.get(0).get().getClass().getSimpleName() + “, “ </p>
<p>​                     + list.get(0).get());</p>
<p>​              println(list.get(1).getClass() + “: “ </p>
<p>​                     + list.get(1).get().getClass().getSimpleName() + “, “ </p>
<p>​                     + list.get(1).get());</p>
<p>​              println(list.get(2).getClass() + “: “ </p>
<p>​                     + list.get(2).get().getClass().getSimpleName() + “, “</p>
<p>​                     + list.get(2).get());</p>
<p>​                                                     </p>
<p>​       }      </p>
<p>​       public static void main(String[] args) {</p>
<p>​              println(“new Holder&lt;List&lt;?&gt;&gt; holder”);</p>
<p>​              f1(new Holder&lt;List&lt;?&gt;&gt;());</p>
<p>​              println();</p>
<p>​              println(“List&lt;Holder<?>> list = new ArrayList<holder<?>&gt;();”);</holder<?></p>
<p>​              List&lt;Holder<?>> list = new ArrayList<holder<?>&gt;();</holder<?></p>
<p>​              f2(list);</p>
<p>​       }</p>
<p>}</p>
<p>public class Holders30 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Holder<character> charHolder = new Holder<character>();</character></character></p>
<p>​              Holder<byte> byteHolder = new Holder<byte>();</byte></byte></p>
<p>​              Holder<short> shortHolder = new Holder<short>();</short></short></p>
<p>​              Holder<integer> intHolder = new Holder<integer>();</integer></integer></p>
<p>​              Holder<long> longHolder = new Holder<long>();</long></long></p>
<p>​              Holder<float> floatHolder = new Holder<float>();</float></float></p>
<p>​              Holder<double> doubleHolder = new Holder<double>();</double></double></p>
<p>​                           charHolder.set(‘a’);</p>
<p>​              print(charHolder.get() + “, “);</p>
<p>​              println(charHolder.get().getClass());</p>
<p>​              char c = charHolder.get();</p>
<p>​              println(“char c = charHolder.get() = “ + c);</p>
<p>​              byte b = 1;</p>
<p>​              byteHolder.set(b);</p>
<p>​              print(byteHolder.get() + “, “);</p>
<p>​              println(byteHolder.get().getClass());</p>
<p>​              byte bb = byteHolder.get();</p>
<p>​              println(“byte bb = byteHolder.get() = “ + bb);                </p>
<p>​              short s = 1;</p>
<p>​              shortHolder.set(s);</p>
<p>​              print(shortHolder.get() + “, “);</p>
<p>​              println(shortHolder.get().getClass());</p>
<p>​              short ss = shortHolder.get();</p>
<p>​              println(“short ss = shortHolder.get() = “ + ss);</p>
<p>​              intHolder.set(1);</p>
<p>​              print(intHolder.get() + “. “);</p>
<p>​              println(intHolder.get().getClass());</p>
<p>​              int i = intHolder.get();</p>
<p>​              println(“int i = intHolder.get() = “ + i);</p>
<p>​              long l = 2;</p>
<p>​              longHolder.set(l);</p>
<p>​              print(longHolder.get() + “, “);</p>
<p>​              println(longHolder.get().getClass());</p>
<p>​              long ll = longHolder.get();</p>
<p>​              println(“long ll = longHolder.get() = “ + ll);</p>
<p>​              float f = 1f;</p>
<p>​              floatHolder.set(f);</p>
<p>​              print(floatHolder.get() + “, “);</p>
<p>​              println(floatHolder.get().getClass());</p>
<p>​              float ff = floatHolder.get();</p>
<p>​              println(“float ff = floatHolder.get() = “ + ff);</p>
<p>​              double d = 1.1;</p>
<p>​              doubleHolder.set(d);</p>
<p>​              print(doubleHolder.get() + “, “);</p>
<p>​              println(doubleHolder.get().getClass());</p>
<p>​              double dd = doubleHolder.get();</p>
<p>​              println(“double dd = doubleHolder.get() = “ + dd);        </p>
<p>​       }             </p>
<p>​              </p>
<p>}</p>
<p>  interface Payable { float getPay(); }</p>
<p>class Employee implements Payable {</p>
<p>​       private float weeklyPay;</p>
<p>​       public float getPay() {</p>
<p>​              return weeklyPay;</p>
<p>​       }             </p>
<p>} </p>
<p>class Hourly extends Employee {</p>
<p>​       public String name;</p>
<p>​       protected float hourlyPay;</p>
<p>​       public int hoursWorked;</p>
<p>​       Hourly(String s, float pay, int hours) {</p>
<p>​              name = s;</p>
<p>​              hourlyPay = pay;</p>
<p>​              hoursWorked = hours;</p>
<p>​       }</p>
<p>​       public float getPay() {</p>
<p>​              System.out.println(“Pay “ + name + </p>
<p>​                     “ $” + hourlyPay * hoursWorked);</p>
<p>​              return hourlyPay * hoursWorked;      </p>
<p>​       }</p>
<p>}</p>
<p>public class MultipleInterfaceVariants31 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Hourly h = new Hourly(“Joe”, 50.00f, 40);</p>
<p>​              h.getPay();</p>
<p>​       }</p>
<p>}</p>
<p>class FixedSizeStack<t> {</t></p>
<p>​       private int index = 0;</p>
<p>​       private Object[] storage;</p>
<p>​       public FixedSizeStack(int size) {</p>
<p>​              storage = new Object[size];</p>
<p>​       }</p>
<p>​       int getIndex() { return index; } </p>
<p>​       public void push(T item) { storage[index++] = item; }</p>
<p>​       @SuppressWarnings(“unchecked”)</p>
<p>​       public T pop() { return (T)storage[–index]; }</p>
<p>}</p>
<p>public class GenericCast32 {</p>
<p>​       public static final int SIZE = 10;</p>
<p>​       public static void main(String[] args) {</p>
<p>​              FixedSizeStack<string> strings = </string></p>
<p>​                     new FixedSizeStack<string>(SIZE);</string></p>
<p>​              for(String s : “A B C D E F G H I J”.split(“ “))</p>
<p>​                     strings.push(s);</p>
<p>​                                        if(strings.getIndex() &lt; SIZE) strings.push(“oops”);</p>
<p>​              for(int i = 0; i &lt; SIZE; i++) {</p>
<p>​                     String s = strings.pop();</p>
<p>​                     System.out.print(s + “ “);</p>
<p>​              }                                  </p>
<p>​       }             </p>
<p>​              </p>
<p>}</p>
<p>class VariableSizeStack<t> { </t></p>
<p>​       private ArrayList<t> storage = new ArrayList<t>();</t></t></p>
<p>​           public int count() {</p>
<p>​              return storage.size();</p>
<p>​           } </p>
<p>​           public void push(T item) { </p>
<p>​              storage.add(item); </p>
<p>​           }</p>
<p>​           public T pop() { </p>
<p>​              return storage.remove(storage.size() - 1);</p>
<p>​           }</p>
<p>}</p>
<p>public class GenericCast33 {</p>
<p>​      public static void main(String[] args) {</p>
<p>​               VariableSizeStack<string> strings =</string></p>
<p>​                          new VariableSizeStack<string>();</string></p>
<p>​               for(String s : “A B C D E F G H I J”.split(“ “))</p>
<p>​                          strings.push(s);</p>
<p>​              int currentCount = strings.count();</p>
<p>​              for(int i = 0; i &lt; currentCount; i++) {</p>
<p>​                   String s = strings.pop();</p>
<p>​                   System.out.print(s + “ “);</p>
<p>​              }                }      }</p>
<p>abstract class SelfBoundedType&lt;T extends SelfBoundedType<t>&gt; {</t></p>
<p>​       abstract T f(T arg);</p>
<p>​       T g(T arg) { </p>
<p>​              System.out.println(“g(T arg)”);</p>
<p>​              return f(arg); </p>
<p>​       }      </p>
<p>}</p>
<p>class D extends SelfBoundedType<d> {</d></p>
<p>​       D f(D arg) { </p>
<p>​              System.out.println(“f(D arg)”);</p>
<p>​              return arg; </p>
<p>​       }      </p>
<p>}</p>
<p>public class Ex34 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              D d = new D();</p>
<p>​              d.f(d).g(d);</p>
<p>​       }</p>
<p>}</p>
<p>public class CheckedList35 {</p>
<p>​       @SuppressWarnings(“unchecked”)</p>
<p>​       static void oldStyleMethod(List probablyMocha) {</p>
<p>​              probablyMocha.add(new Breve());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              List<mocha> mocha1 = new ArrayList<mocha>();</mocha></mocha></p>
<p>​              oldStyleMethod(mocha1);                List<mocha> mocha2 = Collections.checkedList(</mocha></p>
<p>​                     new ArrayList<mocha>(), Mocha.class);</mocha></p>
<p>​              try {</p>
<p>​                     oldStyleMethod(mocha2);                } catch(Exception e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​                           List<coffee> coffee = Collections.checkedList(</coffee></p>
<p>​                     new ArrayList<coffee>(), Coffee.class);</coffee></p>
<p>​              coffee.add(new Mocha());</p>
<p>​              coffee.add(new Breve());             </p>
<p>​       }</p>
<p>}      </p>
<p>​    import java.util.*;</p>
<p>interface Processor&lt;T,E extends Exception, E2 extends Exception&gt; {</p>
<p>​       void process(List<t> resultCollector) throws E,E2;</t></p>
<p>}</p>
<p>class ProcessRunner&lt;T,E extends Exception, E2 extends Exception&gt; </p>
<p>extends ArrayList&lt;Processor&lt;T,E,E2&gt;&gt; {</p>
<p>​       List<t> processAll() throws E,E2 {</t></p>
<p>​              List<t> resultCollector = new ArrayList<t>();</t></t></p>
<p>​              for(Processor&lt;T,E,E2&gt; processor : this)</p>
<p>​                     processor.process(resultCollector);</p>
<p>​              return resultCollector;</p>
<p>​       }</p>
<p>}</p>
<p>class Failure1 extends Exception {}</p>
<p>class Failure3 extends Exception {}</p>
<p>class Processor1 implements Processor&lt;String,Failure1,Failure3&gt; {</p>
<p>​       static int count = 3;</p>
<p>​       public void</p>
<p>​       process(List<string> resultCollector) throws Failure1, Failure3 {</string></p>
<p>​              if(count– &gt; 1)</p>
<p>​                     resultCollector.add(“Hep!”);</p>
<p>​              else</p>
<p>​                     resultCollector.add(“Ho!”);</p>
<p>​              if(count &lt; 0)</p>
<p>​                     throw new Failure1();</p>
<p>​              if(count &lt; -1)</p>
<p>​                     throw new Failure3();</p>
<p>​       }</p>
<p>}</p>
<p>class Processor1b implements Processor&lt;String,Failure1,Failure3&gt; {</p>
<p>​       static int count = 3;</p>
<p>​       public void</p>
<p>​       process(List<string> resultCollector) throws Failure1, Failure3 {</string></p>
<p>​              if(count– &gt; 1)</p>
<p>​                     resultCollector.add(“Hep!”);</p>
<p>​              else</p>
<p>​                     resultCollector.add(“Ho!”);</p>
<p>​              if(count &lt; 0)</p>
<p>​                     throw new Failure1();</p>
<p>​              if(count == 1)</p>
<p>​                     throw new Failure3();</p>
<p>​       }</p>
<p>}</p>
<p>class Failure2 extends Exception {}</p>
<p>class Processor2 implements Processor&lt;Integer,Failure2,Failure3&gt; {</p>
<p>​       static int count = 2;</p>
<p>​       public void</p>
<p>​       process(List<integer> resultCollector) throws Failure2, Failure3 {</integer></p>
<p>​              if(count– == 0)</p>
<p>​                     resultCollector.add(47);</p>
<p>​              else {</p>
<p>​                     resultCollector.add(11);</p>
<p>​              }</p>
<p>​              if(count &lt; 0)</p>
<p>​                     throw new Failure2();</p>
<p>​              if(count &lt; -1)</p>
<p>​                     throw new Failure3();</p>
<p>​       }</p>
<p>}</p>
<p>class Processor2b implements Processor&lt;Integer,Failure2,Failure3&gt; {</p>
<p>​       static int count = 2;</p>
<p>​       public void</p>
<p>​       process(List<integer> resultCollector) throws Failure2, Failure3 {</integer></p>
<p>​              if(count– == 0)</p>
<p>​                     resultCollector.add(47);</p>
<p>​              else {</p>
<p>​                     resultCollector.add(11);</p>
<p>​              }</p>
<p>​              if(count &lt; 0)</p>
<p>​                     throw new Failure2();</p>
<p>​              if(count == 1)</p>
<p>​                     throw new Failure3();</p>
<p>​       }</p>
<p>}</p>
<p>public class ThrowGenericException36 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              ProcessRunner&lt;String,Failure1,Failure3&gt; runner =</p>
<p>​                     new ProcessRunner&lt;String,Failure1,Failure3&gt;();</p>
<p>​              for(int i = 0; i &lt; 3; i++)</p>
<p>​                     runner.add(new Processor1());</p>
<p>​              try {</p>
<p>​                     System.out.println(runner.processAll());</p>
<p>​              } catch(Failure1 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              } catch(Failure3 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​              ProcessRunner&lt;String,Failure1,Failure3&gt; runnerb =</p>
<p>​                     new ProcessRunner&lt;String,Failure1,Failure3&gt;();</p>
<p>​              for(int i = 0; i &lt; 3; i++)</p>
<p>​                     runnerb.add(new Processor1b());</p>
<p>​              try {</p>
<p>​                     System.out.println(runnerb.processAll());</p>
<p>​              } catch(Failure1 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              } catch(Failure3 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​              ProcessRunner&lt;Integer,Failure2,Failure3&gt; runner2 =</p>
<p>​                     new ProcessRunner&lt;Integer,Failure2,Failure3&gt;();</p>
<p>​              for(int i = 0; i &lt; 3; i++)</p>
<p>​                     runner2.add(new Processor2());</p>
<p>​              try {</p>
<p>​                     System.out.println(runner2.processAll());</p>
<p>​              } catch(Failure2 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              } catch(Failure3 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​              ProcessRunner&lt;Integer,Failure2,Failure3&gt; runner2b =</p>
<p>​                     new ProcessRunner&lt;Integer,Failure2,Failure3&gt;();</p>
<p>​              for(int i = 0; i &lt; 3; i++)</p>
<p>​                     runner2b.add(new Processor2b());</p>
<p>​              try {</p>
<p>​                     System.out.println(runner2b.processAll());</p>
<p>​              } catch(Failure2 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              } catch(Failure3 e) {</p>
<p>​                     System.out.println(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>​       </p>
<p>}      </p>
<p>class TimeStampedImp implements TimeStamped {</p>
<p>​       private final long timeStamp;</p>
<p>​       public TimeStampedImp() {</p>
<p>​              timeStamp = new Date().getTime();</p>
<p>​       }</p>
<p>​       public long getStamp() { return timeStamp; }</p>
<p>}</p>
<p>interface SerialNumbered { long getSerialNumber(); }</p>
<p>class SerialNumberedImp implements SerialNumbered {</p>
<p>​       private static long counter = 1;</p>
<p>​       private final long serialNumber = counter++;</p>
<p>​       public long getSerialNumber() { return serialNumber; }</p>
<p>}</p>
<p>interface Color { String getColor();  }</p>
<p>class Colored implements Color {</p>
<p>​       private String color = “blue”;</p>
<p>​       public void setColor(String col) { color = col; }</p>
<p>​       public String getColor() { return color; }</p>
<p>}</p>
<p>interface Basic {</p>
<p>​       public void set(String val);</p>
<p>​       public String get();</p>
<p>}</p>
<p>class BasicImp implements Basic {</p>
<p>​       private String value;</p>
<p>​       public void set(String val) { value = val; }</p>
<p>​       public String get() { return value; }</p>
<p>}</p>
<p>class Mixin extends BasicImp </p>
<p>implements TimeStamped, SerialNumbered, Color {</p>
<p>​       private TimeStamped timeStamp = new TimeStampedImp();</p>
<p>​       private SerialNumbered serialNumber = new SerialNumberedImp();</p>
<p>​       private Colored color = new Colored();</p>
<p>​       public long getStamp() { return timeStamp.getStamp(); }</p>
<p>​       public long getSerialNumber() { </p>
<p>​              return serialNumber.getSerialNumber(); </p>
<p>​       }</p>
<p>​       public String getColor() { return color.getColor(); }</p>
<p>}</p>
<p>public class Mixins37 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Mixin mixin1 = new Mixin(), mixin2 = new Mixin();</p>
<p>​              mixin1.set(“test string 1”);</p>
<p>​              mixin2.set(“test string 2”);</p>
<p>​              System.out.println(mixin1.get() + “ “ + mixin1.getStamp() </p>
<p>​                     + “ “ + mixin1.getSerialNumber() + “ “ + </p>
<p>​                     mixin1.getColor());</p>
<p>​              System.out.println(mixin2.get() + “ “ + mixin2.getStamp() </p>
<p>​                     + “ “ + mixin2.getSerialNumber() + “ “ + </p>
<p>​                     mixin2.getColor());</p>
<p>​       }</p>
<p>}</p>
<p>class BasicCoffee {</p>
<p>​       private static long counter = 0;</p>
<p>​      private final long id = counter++;</p>
<p>​       private String value;</p>
<p>​       public void set(String val) { value = val; }</p>
<p>​       public String get() { return value; }</p>
<p>​      public String toString() {</p>
<p>​                  return getClass().getSimpleName() + “ “ + id;</p>
<p>​      }</p>
<p>}</p>
<p>class Decorator extends BasicCoffee {</p>
<p>​       protected BasicCoffee basicCoffee;</p>
<p>​       public Decorator(BasicCoffee basicCoffee) { </p>
<p>​              this.basicCoffee = basicCoffee; </p>
<p>​       }</p>
<p>​       public void set(String val) { basicCoffee.set(val); }</p>
<p>​       public String get() { return basicCoffee.get(); }</p>
<p>}</p>
<p>class SteamedMilk extends Decorator {</p>
<p>​       private final String steamedMilk = “steamedMilk”;</p>
<p>​       public SteamedMilk(BasicCoffee basicCoffee) {</p>
<p>​              super(basicCoffee);</p>
<p>​       }</p>
<p>​       public String getSteamedMilk() { return steamedMilk; }</p>
<p>}</p>
<p>class Foam extends Decorator {</p>
<p>​       private final String foam = “foam”;</p>
<p>​       public Foam(BasicCoffee basicCoffee) {</p>
<p>​              super(basicCoffee);</p>
<p>​       }</p>
<p>​       public String getFoam() { return foam; }</p>
<p>}</p>
<p>class Chocolate extends Decorator {</p>
<p>​       private final String chocolate = “chocolate”;</p>
<p>​       public Chocolate(BasicCoffee basicCoffee) {</p>
<p>​              super(basicCoffee);</p>
<p>​       }</p>
<p>​       public String getChocolate() { return chocolate; }</p>
<p>}</p>
<p>class Caramel extends Decorator {</p>
<p>​       private final String caramel = “caramel”;</p>
<p>​       public Caramel(BasicCoffee basicCoffee) {</p>
<p>​              super(basicCoffee);</p>
<p>​       }</p>
<p>​       public String getCaramel() { return caramel; }</p>
<p>}</p>
<p>class WhippedCream extends Decorator {</p>
<p>​       private final String whippedCream = “whippedCream”;</p>
<p>​       public WhippedCream(BasicCoffee basicCoffee) {</p>
<p>​              super(basicCoffee);</p>
<p>​       }</p>
<p>​       public String getWhippedCream() { return whippedCream; }</p>
<p>}</p>
<p>public class CoffeeDecoration38 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              SteamedMilk sm = new SteamedMilk(new BasicCoffee());</p>
<p>​              SteamedMilk sm2 = new SteamedMilk(</p>
<p>​                     new Foam(new BasicCoffee()));</p>
<p>​              Chocolate c = new Chocolate(new BasicCoffee());</p>
<p>​              WhippedCream wc = new WhippedCream(new Caramel(</p>
<p>​                     new Chocolate(new Foam(new SteamedMilk(</p>
<p>​                     new BasicCoffee())))));</p>
<p>​       }</p>
<p>}</p>
<p>class MixinProxy implements InvocationHandler {</p>
<p>​       Map&lt;String,Object&gt; delegatesByMethod;</p>
<p>​       public MixinProxy(TwoTuple&lt;Object,Class&lt;?&gt;&gt;… pairs) {</p>
<p>​              delegatesByMethod = new HashMap&lt;String,Object&gt;();</p>
<p>​              for(TwoTuple&lt;Object,Class&lt;?&gt;&gt; pair : pairs) {</p>
<p>​                     for(Method method : pair.second.getMethods()) {</p>
<p>​                            String methodName = method.getName();</p>
<p>​                                                                                  if(!delegatesByMethod.containsKey(methodName))</p>
<p>​                                   delegatesByMethod.put(methodName, pair.first);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</p>
<p>​              String methodName = method.getName();</p>
<p>​              Object delegate = delegatesByMethod.get(methodName);</p>
<p>​              return method.invoke(delegate, args);</p>
<p>​       }</p>
<p>​       @SuppressWarnings(“unchecked”)</p>
<p>​       public static Object newInstance(TwoTuple… pairs) {</p>
<p>​              Class[] interfaces = new Class[pairs.length];</p>
<p>​              for(int i = 0; i &lt; pairs.length; i++) {</p>
<p>​                     interfaces[i] = (Class)pairs[i].second;</p>
<p>​              }</p>
<p>​              ClassLoader cl = pairs[0].first.getClass().getClassLoader();</p>
<p>​              return Proxy.newProxyInstance(cl, interfaces, new MixinProxy(pairs));</p>
<p>​       }</p>
<p>}</p>
<p>public class DynamicProxyMixin39 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Object mixin = MixinProxy.newInstance(tuple(new BasicImp(), Basic.class), </p>
<p>​                     tuple(new TimeStampedImp(), TimeStamped.class),</p>
<p>​                     tuple(new SerialNumberedImp(), SerialNumbered.class),</p>
<p>​                     tuple(new Colored(), Color.class));</p>
<p>​              Basic b = (Basic)mixin;</p>
<p>​              TimeStamped t = (TimeStamped)mixin;</p>
<p>​              SerialNumbered s = (SerialNumbered)mixin;</p>
<p>​              b.set(“Hello”);</p>
<p>​              Color c = (Color)mixin;</p>
<p>​              System.out.println(b.get());</p>
<p>​              System.out.println(t.getStamp());</p>
<p>​              System.out.println(s.getSerialNumber());</p>
<p>​              System.out.println(c.getColor());         </p>
<p>​       }</p>
<p>public class Apply40 {</p>
<p>​       public static &lt;T,S extends Iterable&lt;? extends T&gt;&gt; void apply(S seq, Method f, Object… args) {</p>
<p>​              try {</p>
<p>​                     for(T t : seq)</p>
<p>​                            f.invoke(t, args);</p>
<p>​              } catch(Exception e) {</p>
<p>​                                         throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class FilledList<t> extends ArrayList<t> { </t></t></p>
<p>​       public FilledList(Class&lt;? extends T&gt; type, int size) {</p>
<p>​              try {</p>
<p>​                     for(int i = 0; i &lt; size; i++)</p>
<p>​                                                       add(type.newInstance());</p>
<p>​              } catch(Exception e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class ApplyTest40 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​                           List<pet> pets = Pets.arrayList(10);</pet></p>
<p>​              print(“Random pets: “ + pets);</p>
<p>​                           Apply40.apply(pets, Pet.class.getMethod(“speak”));</p>
<p>​                           Apply40.apply(new FilledList<pet>(Dog.class, 5), Pet.class.getMethod(“speak”));</pet></p>
<p>​       }</p>
<p>}</p>
<p>interface Addable<t> { void add(T t); }</t></p>
<p>public class Fill41 {</p>
<p>​             public static <t> void fill(Addable<t> addable, </t></t></p>
<p>​       Class&lt;? extends T&gt; classToken, int size) {</p>
<p>​              for(int i = 0; i &lt; size; i++) </p>
<p>​                     try {</p>
<p>​                            addable.add(classToken.newInstance());</p>
<p>​                     } catch(Exception e) {</p>
<p>​                            throw new RuntimeException(e);</p>
<p>​                     }</p>
<p>​       }</p>
<p>​             public static <t> void fill(Addable<t> addable, </t></t></p>
<p>​       Generator<t> generator, int size) {</t></p>
<p>​              for(int i = 0; i &lt; size; i++)</p>
<p>​                     addable.add(generator.next());</p>
<p>​       }</p>
<p>}</p>
<p>  class AddableCollectionAdapter<t> implements Addable<t> {</t></t></p>
<p>​       private Collection<t> c;</t></p>
<p>​       public AddableCollectionAdapter(Collection<t> c) {</t></p>
<p>​              this.c = c;</p>
<p>​       }</p>
<p>​       public void add(T item) { c.add(item); }</p>
<p>}</p>
<p> class Adapter {</p>
<p>​       public static <t> </t></p>
<p>​       Addable<t> collectionAdapter(Collection<t> c) {</t></t></p>
<p>​              return new AddableCollectionAdapter<t>(c);          </t></p>
<p>​       }</p>
<p>}</p>
<p>  class AddableSimpleQueue<t></t></p>
<p>extends SimpleQueue<t> implements Addable<t> {</t></t></p>
<p>​       public void add(T item) { super.add(item); }</p>
<p>}</p>
<p>class Fill41Test {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<pet> pets = new ArrayList<pet>();</pet></pet></p>
<p>​              Fill41.fill(</p>
<p>​                     new AddableCollectionAdapter<pet>(pets),</pet></p>
<p>​                     Pet.class, 3);</p>
<p>​                           Fill41.fill(Adapter.collectionAdapter(pets), Manx.class, 2);</p>
<p>​              for(Pet p : pets) print(p);</p>
<p>​              print(“—————“);</p>
<p>​                           AddableSimpleQueue<pet> petQueue = </pet></p>
<p>​                     new AddableSimpleQueue<pet>();</pet></p>
<p>​              Fill41.fill(petQueue, Pug.class, 4);</p>
<p>​              Fill41.fill(petQueue, Gerbil.class, 1);</p>
<p>​              for(Pet p : petQueue) print(p);            </p>
<p>​       }</p>
<p>}</p>
<p> interface Combiner<t> { T combine(T x, T y); }</t></p>
<p>interface UnaryFunction&lt;R,T&gt; { R function(T x); }</p>
<p>interface Collector<t> extends UnaryFunction&lt;T,T&gt; {</t></p>
<p>​       T result();  }</p>
<p>class Food {</p>
<p>​       private String foodName = “”;</p>
<p>​       public Food() { foodName = “”; } </p>
<p>​       public Food(String name) { foodName = name; }</p>
<p>​       public void set(String name) { foodName = name; }</p>
<p>​       public String get() { return foodName; }</p>
<p>​       public void eat() { foodName = “”; }</p>
<p>​       public String toString() { return “Food: “ + foodName; }</p>
<p>}</p>
<p>class Drink {</p>
<p>​       private String drinkName = “”;</p>
<p>​       public Drink() { drinkName= “”; }</p>
<p>​       public Drink(String name) { drinkName = name; }</p>
<p>​       public void set(String name) { drinkName = name; }</p>
<p>​       public String get() { return drinkName; }</p>
<p>​       public void eat() { drinkName = “”; }</p>
<p>​       public String toString() { return “Drink: “ + drinkName; } </p>
<p>}</p>
<p>public class Functional42 {</p>
<p>​                   public static <t> T</t></p>
<p>​       reduce(Iterable<t> seq, Combiner<t> combiner) {</t></t></p>
<p>​              Iterator<t> it = seq.iterator();</t></p>
<p>​              if(it.hasNext()) {</p>
<p>​                     T result = it.next();</p>
<p>​                     while(it.hasNext())</p>
<p>​                            result = combiner.combine(result, it.next());</p>
<p>​                     return result;</p>
<p>​              }</p>
<p>​                           return null;   } </p>
<p>​                               public static <t> Collector<t></t></t></p>
<p>​       forEach(Iterable<t> seq, Collector<t> func) {</t></t></p>
<p>​              for(T t : seq) func.function(t);</p>
<p>​              return func;</p>
<p>​       }      </p>
<p>​       static class MealMaker implements Combiner<food> {</food></p>
<p>​              public Food combine(Food f1, Food f2) {</p>
<p>​                     return new Food(f1.get() + “ “ + f2.get());</p>
<p>​              }</p>
<p>​       }</p>
<p>​       static class DrinkMaker implements Combiner<drink> {</drink></p>
<p>​              public Drink combine(Drink d1, Drink d2) {</p>
<p>​                     return new Drink(d1.get() + “ “ + d2.get());</p>
<p>​              }</p>
<p>​       }</p>
<p>​       static class CookedMeal</p>
<p>​       implements Collector<food> {</food></p>
<p>​              private Food f = new Food(“”);</p>
<p>​              public Food function(Food x) {</p>
<p>​                     f = new Food(f.get() + “ “ + x.get());</p>
<p>​                     return f;</p>
<p>​              }</p>
<p>​              public Food result() { return new Food(“cooked “ + f.get()); }</p>
<p>​       }      </p>
<p>​       public static void main(String[] args) {</p>
<p>​              List<food> lf = Arrays.asList(new Food(“bread”),</food></p>
<p>​                     new Food(“ham”), new Food(“cheese”));</p>
<p>​              Food meal = reduce(lf, new MealMaker());</p>
<p>​              print(meal);</p>
<p>​              List<drink> ld = Arrays.asList(new Drink(“water”),</drink></p>
<p>​                     new Drink(“orange juice”), new Drink(“lemon”));</p>
<p>​              Drink drink = reduce(ld, new DrinkMaker());</p>
<p>​              print(drink);</p>
<p>​              print(forEach(lf, new CookedMeal()).result());</p>
<p>​              </p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zqfmcl</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">193</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zqfmcl</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>

<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Fey's blog" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="Fey&#39;s blog">
<meta property="og:url" content="https://zqfmcl.github.io/dialy/page/4/index.html">
<meta property="og:site_name" content="Fey&#39;s blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fey&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zqfmcl.github.io/dialy/page/4/">





  <title>Fey's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fey's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解重用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解重用/" itemprop="url">Java题解重用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第七章-重用"><a href="#第七章-重用" class="headerlink" title="第七章  重用"></a>第七章  重用</h2><p>class Engine {</p>
<p>​       private String s;</p>
<p>​       Engine() {</p>
<p>​              println(“Engine()”);</p>
<p>​              s = “Constructed”;</p>
<p>​       }</p>
<p>​       public String toString() { return s; }</p>
<p>}</p>
<p>public class Airplane {</p>
<p>​       private String fuselage, wings, tail;</p>
<p>​       private Engine e;</p>
<p>​       public Airplane() {</p>
<p>​              println(“Inside Airplane()”);</p>
<p>​              fuselage = “Body”;</p>
<p>​              wings = “Airfoils”;</p>
<p>​              tail = “Empennage”;                          </p>
<p>​       }</p>
<p>​       public String toString() { </p>
<p>​              if(e == null)                       e = new Engine();</p>
<p>​              return “fuselage = “ + fuselage + “, “ +</p>
<p>​                     “wings = “ + wings + “, “ +</p>
<p>​                     “tail = “ + tail + “, “ +</p>
<p>​                     “Engine = “ + e;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Airplane N1234 = new Airplane();</p>
<p>​              print(N1234);</p>
<p>​       }</p>
<p>}</p>
<p>public class Sterilizer extends Detergent {</p>
<p>​       public void scrub() { append(“ Sterilizer.scrub()”); }</p>
<p>​       public void sterilize() { append(“ sterilize()”); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Sterilizer x = new Sterilizer();</p>
<p>​              x.dilute();</p>
<p>​              x.apply(); </p>
<p>​              x.scrub();</p>
<p>​              x.foam();</p>
<p>​              x.sterilize();</p>
<p>​              println(x);</p>
<p>​              println(“Testing base class:”);</p>
<p>​              Detergent.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Art {</p>
<p>​       Art() { println(“Art constructor”); }</p>
<p>}</p>
<p>class Drawing extends Art {</p>
<p>​       Drawing() { println(“Drawing constructor”); }</p>
<p>}</p>
<p>public class Cartoon2 extends Drawing {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Cartoon2 x = new Cartoon2();</p>
<p>​       }</p>
<p>}</p>
<p>class A { A(){ println(“A()”);} }</p>
<p>class B extends A { B(){ println(“B()”);} }</p>
<p>class C extends B { C(){ println(“C()”);} }</p>
<p>class D extends C {</p>
<p>​       D() { println(“D()”); }</p>
<p>​       public static D makeD() { return new D(); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              D d = new D();</p>
<p>​              D d2 = makeD();</p>
<p>​       }</p>
<p>}</p>
<p>public class E extends D {</p>
<p>​       E() { println(“E()”); } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              E e = new E();</p>
<p>​                           D.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class A { A(){ println(“A()”);} }</p>
<p>class B extends A { B(){ println(“B()”);} }</p>
<p>class C extends A { </p>
<p>​       B b = new B();      public static void main(String[] args) {</p>
<p>​              C c = new C();      }</p>
<p>}</p>
<p>class Game {</p>
<p>​       Game(int i) {</p>
<p>​              print(“Game constructor”);</p>
<p>​       }      </p>
<p>}</p>
<p>class BoardGame extends Game {</p>
<p>​       BoardGame(int i) {</p>
<p>​                                               super(i);               print(“BoardGame constructor”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Chess extends BoardGame {</p>
<p>​       Chess() {</p>
<p>​              super(11);</p>
<p>​              print(“Chess constructor”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Chess x = new Chess();</p>
<p>​       }</p>
<p>}</p>
<p>class A { </p>
<p>​       A(char c, int i) { println(“A(char, int)”);} </p>
<p>}</p>
<p>class B extends A {       </p>
<p>​       B(String s, float f){</p>
<p>​              super(‘ ‘, 0); </p>
<p>​              println(“B(String, float)”);</p>
<p>​       } </p>
<p>}</p>
<p>class C7 extends A { </p>
<p>​       private char c;</p>
<p>​       private int i;</p>
<p>​       C7(char a, int j) {   </p>
<p>​              super(a, j); </p>
<p>​              c = a;</p>
<p>​              i = j;</p>
<p>​       }</p>
<p>​       B b = new B(“hi”, 1f);   public static void main(String[] args) {</p>
<p>​              C7 c = new C7(‘b’, 2);         }</p>
<p>}</p>
<p>class A { </p>
<p>​       A(char c, int i) { println(“A(char, int)”);} </p>
<p>}</p>
<p>class Ex8 extends A { </p>
<p>​       private char c;</p>
<p>​       private int i;</p>
<p>​       Ex8() { </p>
<p>​              super(‘z’, 3);</p>
<p>​              println(“Ex8()”); </p>
<p>​       } </p>
<p>​       Ex8(char a, int j) {  </p>
<p>​              super(a, j); </p>
<p>​              c = a;</p>
<p>​              i = j;</p>
<p>​              println(“Ex8(char,int)”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Ex8 ex1 = new Ex8();</p>
<p>​              Ex8 ex2 = new Ex8(‘b’, 2); </p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1() { println(“Component1()”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2() { println(“Component2()”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3() { println(“Component3()”); }</p>
<p>}</p>
<p>class Root { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root() { println(“Root()”); } </p>
<p>}</p>
<p>class Stem extends Root { </p>
<p>​       Component1 c1stem;</p>
<p>​       Component2 c2stem;</p>
<p>​       Component3 c3stem;</p>
<p>​       Stem() { println(“Stem()”); } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem s = new Stem();</p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1(byte b) { println(“Component1(byte)”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2(short s) { println(“Component2(short)”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3(int i) { println(“Component3(int)”); }</p>
<p>}</p>
<p>class Root { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root(float f) { </p>
<p>​              c1root = new Component1((byte)0);</p>
<p>​              c2root = new Component2((short)0);</p>
<p>​              c3root = new Component3(0);</p>
<p>​              println(“Root(foat)”); </p>
<p>​       } </p>
<p>}</p>
<p>class Stem10 extends Root { </p>
<p>​       Component1 c1stem10;</p>
<p>​       Component2 c2stem10;</p>
<p>​       Component3 c3stem10;</p>
<p>​       Stem10(double d) { </p>
<p>​              super(2.78f);</p>
<p>​              c1stem10 = new Component1((byte)1);</p>
<p>​              c2stem10 = new Component2((short)1);</p>
<p>​              c3stem10 = new Component3(1);</p>
<p>​              println(“Stem10(double)”); </p>
<p>​       } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem10 x = new Stem10(2.78);</p>
<p>​       }</p>
<p>}</p>
<p>class Cleanser {</p>
<p>​       private String s = “Cleanser”;</p>
<p>​       public void append(String a) { s += a; }</p>
<p>​       public void dilute() { append(“ dilute()”); }</p>
<p>​       public void apply() { append(“ apply()”); }</p>
<p>​       public void scrub() { append(“ scrub()”); }</p>
<p>​       public String toString() { return s; }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Cleanser x = new Cleanser();</p>
<p>​              print(x);</p>
<p>​       }</p>
<p>}</p>
<p>public class DetergentDelegation {</p>
<p>​       private String s = “DetergentDelegation”;</p>
<p>​       Cleanser c = new Cleanser();</p>
<p>​       public void append(String a) { s += a; }</p>
<p>​             public void dilute() { </p>
<p>​              c.dilute(); </p>
<p>​       }</p>
<p>​       public void apply() {</p>
<p>​              c.apply(); </p>
<p>​              }</p>
<p>​             public void scrub() {</p>
<p>​              append(“ DetergentDelegation.scrub()”);</p>
<p>​              c.scrub(); </p>
<p>​       }</p>
<p>​       public void foam() { append(“ foam()”); } </p>
<p>​       public String toString() { return s + “ “ + c; }     </p>
<p>​       public static void main(String[] args) {</p>
<p>​              DetergentDelegation x = new DetergentDelegation();</p>
<p>​              x.dilute();</p>
<p>​              x.apply();</p>
<p>​              x.scrub();</p>
<p>​              x.foam();</p>
<p>​              print(x);</p>
<p>​              print(“Testing base class:”);</p>
<p>​              Cleanser.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Component1 {</p>
<p>​       Component1() { println(“Component1()”); }</p>
<p>​       void dispose() { println(“Component1.dispose()”); }</p>
<p>}</p>
<p>class Component2 {</p>
<p>​       Component2() { println(“Component2()”); }</p>
<p>​       void dispose() { println(“Component2.dispose()”); }</p>
<p>}</p>
<p>class Component3 {</p>
<p>​       Component3() { println(“Component3()”); }</p>
<p>​       void dispose() { println(“Component3.dispose()”); }</p>
<p>}</p>
<p>class Root2 { </p>
<p>​       Component1 c1root;</p>
<p>​       Component2 c2root;</p>
<p>​       Component3 c3root;</p>
<p>​       Root2() { </p>
<p>​              println(“Root()”);</p>
<p>​              c1root = new Component1();</p>
<p>​              c2root = new Component2();</p>
<p>​              c3root = new Component3();</p>
<p>​       }</p>
<p>​       void dispose() {</p>
<p>​              c3root.dispose();</p>
<p>​              c2root.dispose();</p>
<p>​              c1root.dispose();</p>
<p>​              println(“Root2.dispose()”);</p>
<p>​       } </p>
<p>}</p>
<p>class Stem2 extends Root2 { </p>
<p>​       Component1 c1stem;</p>
<p>​       Component2 c2stem;</p>
<p>​       Component3 c3stem;</p>
<p>​       Stem2() { </p>
<p>​              super();</p>
<p>​              println(“Stem2()”); </p>
<p>​              c1stem = new Component1();</p>
<p>​              c2stem = new Component2();</p>
<p>​              c3stem = new Component3();</p>
<p>​       }</p>
<p>​       void dispose() {</p>
<p>​              c3stem.dispose();</p>
<p>​              c2stem.dispose();</p>
<p>​              c1stem.dispose();</p>
<p>​              super.dispose();</p>
<p>​              println(“Stem2.dispose()”);</p>
<p>​       } </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Stem2 s = new Stem2();</p>
<p>​              try {</p>
<p>​                                  } finally {</p>
<p>​                     s.dispose();</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class ThreeWay {</p>
<p>​       void number(byte b) { println(b); }</p>
<p>​       void number(short s) { println(s); }</p>
<p>​       void number(int i) { println(i); }</p>
<p>}</p>
<p>class Overload extends ThreeWay {</p>
<p>​       void number(float f) { println(f); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Overload ov = new Overload();</p>
<p>​              ov.number((byte)0);</p>
<p>​              ov.number((short)1);</p>
<p>​              ov.number(2);</p>
<p>​              ov.number(3.0f);</p>
<p>​       }</p>
<p>}</p>
<p> class Engine {</p>
<p>​       public void start() {}</p>
<p>​       public void rev() {}</p>
<p>​       public void stop() {}</p>
<p>​       public void service() { System.out.println(“service engine”); }</p>
<p>}</p>
<p>class Wheel {</p>
<p>​       public void inflate(int psi) {}</p>
<p>}</p>
<p>class Window {</p>
<p>​       public void rollup() {}</p>
<p>​       public void rolldown() {}</p>
<p>}</p>
<p>class Door {</p>
<p>​       public Window window = new Window();</p>
<p>​       public void open() {}</p>
<p>​       public void close() {}</p>
<p>}</p>
<p>public class Car {</p>
<p>​       public Engine engine = new Engine();</p>
<p>​       public Wheel[] wheel = new Wheel[4];</p>
<p>​       public Door</p>
<p>​              left = new Door(),</p>
<p>​              right = new Door();     public Car() {</p>
<p>​              for(int i = 0; i &lt; 4; i++)</p>
<p>​                     wheel[i] = new Wheel();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Car car = new Car();</p>
<p>​              car.left.window.rollup();</p>
<p>​              car.wheel[0].inflate(72);</p>
<p>​              car.engine.service();</p>
<p>​       }      </p>
<p>}</p>
<p>class DeviceFail {   </p>
<p>​       public static void main(String[] s) {</p>
<p>​              BasicDevice fail = new BasicDevice();</p>
<p>​              fail.showS();</p>
<p>​                    }</p>
<p>}</p>
<p>public class Device extends BasicDevice {</p>
<p>​       void changeBasic(String t) {</p>
<p>​              super.changeS(t);        }      </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Device d = new Device();</p>
<p>​              d.showS();</p>
<p>​              d.changeBasic(“Changed”);              d.showS();</p>
<p>​              DeviceFail.main(args);</p>
<p>​       }</p>
<p>}</p>
<p>class Amphibian {</p>
<p>​       protected void swim() {</p>
<p>​              println(“Amphibian swim”);         </p>
<p>​       }</p>
<p>​       protected void speak() {</p>
<p>​              println(“Amphibian speak”);</p>
<p>​       }</p>
<p>​       void eat() {</p>
<p>​              println(“Amphibian eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Amphibian grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>}</p>
<p>public class Frog extends Amphibian {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Frog f = new Frog();</p>
<p>​                           f.swim();</p>
<p>​              f.speak();</p>
<p>​              f.eat();</p>
<p>​                           Amphibian.grow(f);</p>
<p>​       }</p>
<p>}</p>
<p>class Amphibian {</p>
<p>​       protected void swim() {</p>
<p>​              println(“Amphibian swim”);         </p>
<p>​       }</p>
<p>​       protected void speak() {</p>
<p>​              println(“Amphibian speak”);</p>
<p>​       }</p>
<p>​       void eat() {</p>
<p>​              println(“Amphibian eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Amphibian grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>}</p>
<p>public class Frog17 extends Amphibian {</p>
<p>​       @Override protected void swim() {</p>
<p>​              println(“Frog swim”);            </p>
<p>​       }</p>
<p>​       @Override protected void speak() {</p>
<p>​              println(“Frog speak”);</p>
<p>​       }</p>
<p>​       @Override void eat() {</p>
<p>​              println(“Frog eat”);</p>
<p>​       }</p>
<p>​       static void grow(Amphibian a) {</p>
<p>​              println(“Frog grow”);</p>
<p>​              a.eat();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Frog17 f = new Frog17();</p>
<p>​                           f.swim();</p>
<p>​              f.speak();</p>
<p>​              f.eat();</p>
<p>​                           f.grow(f);</p>
<p>​                           Amphibian.grow(f);</p>
<p>​       }</p>
<p>}</p>
<p>class Test {</p>
<p>​       Test() { println(“Test()”); }</p>
<p>}</p>
<p>public class Difference {</p>
<p>​       private String name;</p>
<p>​       public Difference(String s) { name = s;  } </p>
<p>​       static final Test sft = new Test();        private final Test ft = new Test();</p>
<p>​       static final String SFS = “static final”;        private final String fs = “final”;</p>
<p>​       private static Random rand = new Random();</p>
<p>​       static final int SFI = rand.nextInt();    private final int fi = rand.nextInt();</p>
<p>​       public String toString() {</p>
<p>​              return (name + “: “ + sft + “, “ + ft + “, “ + SFS + “, “ + fs + “, “ + SFI + “, “ + fi);        }            </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Difference d1 = new Difference(“d1”);</p>
<p>​              Difference d2 = new Difference(“d2”);</p>
<p>​              Difference d3 = new Difference(“d3”);</p>
<p>​              println(d1);</p>
<p>​              println(d2);</p>
<p>​              println(d3);</p>
<p>​       }</p>
<p>}</p>
<p>class Poppet {</p>
<p>​       private int i;</p>
<p>​       Poppet(int k) { i = k; }</p>
<p>​       public String toString() { </p>
<p>​              return (“Poppet “ + i); </p>
<p>​       }</p>
<p>}</p>
<p>public class BlankFinalEx {</p>
<p>​       private final Poppet p;             public BlankFinalEx() {</p>
<p>​              p = new Poppet(1);     }</p>
<p>​       public BlankFinalEx(int x) {</p>
<p>​              p = new Poppet(x);     }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              BlankFinalEx b1 = new BlankFinalEx();</p>
<p>​              BlankFinalEx b2 = new BlankFinalEx(47);</p>
<p>​                                        System.out.println(“b1.p: “ + b1.p);</p>
<p>​              System.out.println(“b2.p: “ + b2.p);</p>
<p>​       }</p>
<p>}</p>
<p>class WithFinals {</p>
<p>​             private final void f() { print(“WithFinals.f()”); }</p>
<p>​             private void g() { print(“WithFinals.g()”); }</p>
<p>} </p>
<p>class OverridingPrivate extends WithFinals {</p>
<p>​             private final void f() { print(“OverridingPrivate.f()”); }</p>
<p>​       private void g() { print(“OverridingPrivate.g()”); }</p>
<p>​                    }</p>
<p>class OverridingPrivate2 extends OverridingPrivate {</p>
<p>​             public final void f() { print(“OverridingPrivate2.f()”); }</p>
<p>​       public void g() { print(“OverridingPrivate2.g()”); }</p>
<p>​                    }</p>
<p>public class FinalOverridingIllusionEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              OverridingPrivate2 op2 = new OverridingPrivate2();</p>
<p>​              op2.f();</p>
<p>​              op2.g();</p>
<p>​                           OverridingPrivate op = op2;</p>
<p>​                                                                  WithFinals wf = op2;</p>
<p>​                                 }</p>
<p>}</p>
<p>class WithFinal {</p>
<p>​       final void f() { print(“WithFinal.f()”); }</p>
<p>​       void g() { print(“WithFinal.g()”); }</p>
<p>​       final void h() { print(“WitFinal.h()”); }</p>
<p>} </p>
<p>class OverrideFinal extends WithFinal {</p>
<p>​                   @Override public void g() { print(“OverrideFinal.g()”); }          }</p>
<p>public class FinalOverrideEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              OverrideFinal of = new OverrideFinal();</p>
<p>​              of.f();</p>
<p>​              of.g();</p>
<p>​              of.h();</p>
<p>​                           WithFinal wf = of;</p>
<p>​              wf.f(); </p>
<p>​              wf.g();</p>
<p>​              wf.h(); </p>
<p>​       }</p>
<p>}</p>
<p> class SmallBrain {} </p>
<p>final class Dinosaur {</p>
<p>​       SmallBrain x = new SmallBrain();</p>
<p>}</p>
<p>public class JurassicEx {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Dinosaur d = new Dinosaur();</p>
<p>​       }</p>
<p>}</p>
<p>class A {</p>
<p>​       static int j = printInit(“A.j initialized”);</p>
<p>​       static int printInit(String s) {</p>
<p>​              println(s);</p>
<p>​              return 1;</p>
<p>​       }</p>
<p>​       A() { println(“A() constructor”); }   </p>
<p>} </p>
<p>class B extends A {</p>
<p>​       static int k = printInit(“B.k initialized”);</p>
<p>​       B() { println(“B() constructor”); }   </p>
<p>}</p>
<p>class C {</p>
<p>​       static int n = printInitC(“C.n initialized”);</p>
<p>​       static A a = new A();     </p>
<p>​       C() { println(“C() constructor”); }</p>
<p>​       static int printInitC(String s) {</p>
<p>​              println(s);</p>
<p>​              return 1;</p>
<p>​       }</p>
<p>}</p>
<p>class D {</p>
<p>​       D() { println(“D() constructor”); }</p>
<p>}</p>
<p>public class LoadClass extends B {</p>
<p>​       static int i = printInit(“LoadClass.i initialized”);</p>
<p>​       LoadClass() { println(“LoadClass() constructor”); }</p>
<p>​       public static void main(String[] args) {</p>
<p>​                                        println(“hi”);</p>
<p>​                           LoadClass lc = new LoadClass();</p>
<p>​                           println(C.a);</p>
<p>​                           D d = new D();</p>
<p>​       }</p>
<p>}</p>
<p>class Insect {</p>
<p>​       private int i = 9;</p>
<p>​       protected int j;</p>
<p>​       Insect() {</p>
<p>​              print(“i = “ + i + “, j = “ + j);</p>
<p>​              j = 39;</p>
<p>​       }</p>
<p>​       private static int x1 = printInit(“static Insect.x1 initialized”);</p>
<p>​       static int printInit(String s) {</p>
<p>​              print(s);</p>
<p>​              return 47;</p>
<p>​       }</p>
<p>}</p>
<p>class Beetle extends Insect {</p>
<p>​       private int k = printInit(“Beetle.k initialized”);</p>
<p>​       public Beetle() {</p>
<p>​              print(“k = “ + k);</p>
<p>​              print(“j = “ + j);</p>
<p>​       }</p>
<p>​       private static int x2 = printInit(“static Beetle.x2 initialized”);     </p>
<p>}</p>
<p>public class Scarab extends Beetle {</p>
<p>​       private int n = printInit(“Scarab.n initialized”);</p>
<p>​       public Scarab() {</p>
<p>​              print(“n = “ + n);</p>
<p>​              print(“j = “ + j);</p>
<p>​       }</p>
<p>​       private static int x3 = printInit(“static Scarab.x3 initialized”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              print(“Scarab constructor”);</p>
<p>​              Scarab sc = new Scarab();                  </p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解类型信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解类型信息/" itemprop="url">Java题解类型信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第十四章-类型信息"><a href="#第十四章-类型信息" class="headerlink" title="第十四章 类型信息"></a>第十四章 类型信息</h2><p>class Toy {</p>
<p>​                         Toy(int i) {}</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest1 {</p>
<p>​       static void printInfo(Class cc) {</p>
<p>​              print(“Class name: “ + cc.getName() +</p>
<p>​                     “ is interface? [“ + cc.isInterface() + “]”);</p>
<p>​              print(“Simple name: “ + cc.getSimpleName());</p>
<p>​              print(“Canonical name: “ + cc.getCanonicalName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(“typeinfo.toys.FancyToy”);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Can’t find FancyToy”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(c);</p>
<p>​              for(Class face : c.getInterfaces())</p>
<p>​                     printInfo(face);</p>
<p>​              Class up = c.getSuperclass();</p>
<p>​              Object obj = null;</p>
<p>​              try {</p>
<p>​                                                             obj = up.newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Cannot instantiate”);</p>
<p>​                     System.exit(1);</p>
<p>​              } catch(IllegalAccessException i) {</p>
<p>​                     print(“Cannot access”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(obj.getClass());</p>
<p>​       }</p>
<p>}</p>
<p>interface HasBatteries {}</p>
<p>interface Waterproof {}</p>
<p>interface Shoots {}</p>
<p>interface Flies {}</p>
<p>class Toy {</p>
<p>​                   Toy() {}</p>
<p>​       Toy(int i) {}</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots, Flies {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest2 {</p>
<p>​       static void printInfo(Class cc) {</p>
<p>​              print(“Class name: “ + cc.getName() +</p>
<p>​                     “ is interface? [“ + cc.isInterface() + “]”);</p>
<p>​              print(“Simple name: “ + cc.getSimpleName());</p>
<p>​              print(“Canonical name: “ + cc.getCanonicalName());</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(“typeinfo.toys.FancyToy”);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Can’t find FancyToy”);</p>
<p>​                     System.exit(1);</p>
<p>​              }</p>
<p>​              printInfo(c);</p>
<p>​              for(Class face : c.getInterfaces())</p>
<p>​                     printInfo(face);</p>
<p>​              Class up = c.getSuperclass();</p>
<p>​              Object obj = null;</p>
<p>​              try {</p>
<p>​                                         obj = up.newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Cannot instantiate”);</p>
<p>​                     System.exit(1);</p>
<p>​              } catch(IllegalAccessException i) {</p>
<p>​                     print(“Cannot access”);</p>
<p>​                     System.exit(1);</p>
<p>​              }      </p>
<p>​              printInfo(obj.getClass());</p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>class Rhomboid extends Shape {</p>
<p>​       public String toString() { return “Rhomboid”; }</p>
<p>}</p>
<p>public class Shapes3 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw();</p>
<p>​              Rhomboid r = new Rhomboid();</p>
<p>​              ((Shape)r).draw();</p>
<p>​                                 }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>class Rhomboid extends Shape {</p>
<p>​       public String toString() { return “Rhomboid”; }</p>
<p>}</p>
<p>public class Shapes4 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw();</p>
<p>​              Rhomboid r = new Rhomboid();</p>
<p>​                           Shape s = (Shape)r;</p>
<p>​              s.draw();</p>
<p>​                           if(s instanceof Circle) </p>
<p>​                     ((Circle)s).draw();</p>
<p>​              else if(!(s instanceof Circle))</p>
<p>​                     System.out.println(“(Shape)r is not a Circle”);           </p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       public String toString() { return “Circle”; }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       public String toString() { return “Square”; }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       public String toString() { return “Triangle”; }</p>
<p>}</p>
<p>public class Shapes5 {</p>
<p>​       public static void rotate(Shape s) {</p>
<p>​                     if(!(s instanceof Circle))</p>
<p>​                            System.out.println(s + “ rotate”);</p>
<p>​              }                    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle(), new Rhomboid()</p>
<p>​              );</p>
<p>​                           for(Shape shape : shapeList)</p>
<p>​                     shape.draw(); </p>
<p>​              System.out.println();     </p>
<p>​              for(Shape shape : shapeList)</p>
<p>​                     rotate(shape);</p>
<p>​       }</p>
<p>}</p>
<p>abstract class Shape {</p>
<p>​       void draw() { System.out.println(this + “.draw()”); }</p>
<p>​       abstract public String toString();</p>
<p>}</p>
<p>class Circle extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Circle”; </p>
<p>​       }</p>
<p>}</p>
<p>class Square extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Square”; </p>
<p>​       }</p>
<p>}</p>
<p>class Triangle extends Shape {</p>
<p>​       boolean flag = false;</p>
<p>​       public String toString() { </p>
<p>​              return (flag ? “H” : “Unh”) + “ighlighted “ + “Triangle”; </p>
<p>​       }</p>
<p>}</p>
<p>public class Shapes6 {</p>
<p>​       public static void setFlag(Shape s) {</p>
<p>​                     if(s instanceof Triangle)</p>
<p>​                            ((Triangle)s).flag = true; </p>
<p>​              }                    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           List<shape> shapeList = Arrays.asList(</shape></p>
<p>​                     new Circle(), new Square(), new Triangle()</p>
<p>​              );</p>
<p>​              for(Shape shape : shapeList) {</p>
<p>​                     setFlag(shape);</p>
<p>​                     System.out.println(shape);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Candy {</p>
<p>​       static { print(“Loading Candy”); }</p>
<p>}</p>
<p>class Gum {</p>
<p>​       static { print(“Loading Gum”); } </p>
<p>}</p>
<p>class Cookie {</p>
<p>​       static { print(“Loading Cookie”); }</p>
<p>}</p>
<p>public class SweetShop7 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     System.out.println(“Usage: sweetName”);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              Class c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(args[0]);</p>
<p>​                     print(“Enjoy your “ + args[0]);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“Couldn’t find “ + args[0]);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>  class A {}</p>
<p>class B extends A {}</p>
<p>class C extends B {}</p>
<p>public class Ex8 {</p>
<p>​       public static void Hierarchy(Object o) {</p>
<p>​              if(o.getClass().getSuperclass() != null) {             </p>
<p>​                     System.out.println(o.getClass() + “ is a subclass of “ + </p>
<p>​                            o.getClass().getSuperclass()); </p>
<p>​                     try {</p>
<p>​                            Hierarchy(o.getClass().getSuperclass().newInstance());</p>
<p>​                     } catch(InstantiationException e) {</p>
<p>​                            System.out.println(“Unable to instantiate obj”);</p>
<p>​                     } catch(IllegalAccessException e) {</p>
<p>​                            System.out.println(“Unable to access”);</p>
<p>​                     }</p>
<p>​              } </p>
<p>​       }             </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Hierarchy(new C());</p>
<p>​       }</p>
<p>}</p>
<p>  class A { int i; String s; }</p>
<p>class B extends A { int j; float f; }</p>
<p>class C extends B { int k; B b;}</p>
<p>public class Ex9 {</p>
<p>​       public static void Hierarchy(Object o) {</p>
<p>​              Object[] fields = o.getClass().getDeclaredFields();</p>
<p>​              if(fields.length == 0)</p>
<p>​                     System.out.println(o.getClass() + “ has no fields”);</p>
<p>​              if(fields.length &gt; 0) {</p>
<p>​                     System.out.println(“Field(s) of “ + o.getClass() + “:”);</p>
<p>​                     for(Object obj : fields) </p>
<p>​                            System.out.println(“ “ + obj);</p>
<p>​              }</p>
<p>​              if(o.getClass().getSuperclass() != null) {                    </p>
<p>​                     System.out.println(o.getClass() + “ is a subclass of “ + </p>
<p>​                            o.getClass().getSuperclass()); </p>
<p>​                     try {</p>
<p>​                            Hierarchy(o.getClass().getSuperclass().newInstance());</p>
<p>​                     } catch(InstantiationException e) {</p>
<p>​                            System.out.println(“Unabloe to instantiate obj”);</p>
<p>​                     } catch(IllegalAccessException e) {</p>
<p>​                            System.out.println(“Unable to access”);</p>
<p>​                     }</p>
<p>​              } </p>
<p>​       }             </p>
<p>​       public static void main(String[] args) {</p>
<p>​              Hierarchy(new C());</p>
<p>​       }</p>
<p>}</p>
<p>  public class Ex10 {     </p>
<p>​       public static void main(String[] args) {</p>
<p>​              char[] c = new char[10];</p>
<p>​                           System.out.println(“Superclass of char[] c: “ + </p>
<p>​                     c.getClass().getSuperclass());</p>
<p>​              System.out.println(“char[] c instanceof Object: “ + </p>
<p>​                     (c instanceof Object));</p>
<p>​       }</p>
<p>}</p>
<p>​             package typeinfo.pets;</p>
<p>​       public class Gerbil extends Rodent {</p>
<p>​              public Gerbil(String name) { super(name); }</p>
<p>​              public Gerbil() { super(); }</p>
<p>​       } </p>
<p>​             “typeinfo.pets.Gerbil” </p>
<p>​             if(pet instanceof Gerbil) counter.count(“Gerbil”); </p>
<p>​             Gerbil.class </p>
<p>public class Ex11 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Pet.class);</p>
<p>​              for(Pet pet : Pets.createArray(20)) {</p>
<p>​                     printnb(pet.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(pet);</p>
<p>​              }      </p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex12 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Coffee.class);</p>
<p>​              for(Coffee coffee : new CoffeeGenerator(20)) {</p>
<p>​                     printnb(coffee.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(coffee);</p>
<p>​              }</p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex13 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              TypeCounter counter = new TypeCounter(Part.class);</p>
<p>​              List<part> partList = new ArrayList<part>();</part></part></p>
<p>​              for(int i = 0; i &lt; 20; i++)              </p>
<p>​                     partList.add(Part.createRandom());</p>
<p>​              for(Part part : partList) {</p>
<p>​                     printnb(part.getClass().getSimpleName() + “ “);</p>
<p>​                     counter.count(part);</p>
<p>​              }</p>
<p>​              print();</p>
<p>​              print(counter);</p>
<p>​       }</p>
<p>}</p>
<p>class Part {</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName();</p>
<p>​       }</p>
<p>​       static List&lt;Class&lt;? extends Part&gt;&gt; partClasses = </p>
<p>​              new ArrayList&lt;Class&lt;? extends Part&gt;&gt;();</p>
<p>​       static {</p>
<p>​                                        partClasses.add(FuelFilter.class);</p>
<p>​              partClasses.add(AirFilter.class);</p>
<p>​              partClasses.add(CabinAirFilter.class);</p>
<p>​              partClasses.add(OilFilter.class);</p>
<p>​              partClasses.add(FanBelt.class);</p>
<p>​              partClasses.add(PowerSteeringBelt.class);</p>
<p>​              partClasses.add(GeneratorBelt.class);</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Part createRandom() {</p>
<p>​              int n = rand.nextInt(partClasses.size());</p>
<p>​              try {</p>
<p>​                     return partClasses.get(n).newInstance();</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              } catch(IllegalAccessException e) {</p>
<p>​                     throw new RuntimeException(e);</p>
<p>​              }</p>
<p>​       } </p>
<p>}</p>
<p>class Filter extends Part {}</p>
<p>class FuelFilter extends Filter {</p>
<p>​             public static class Factory implements typeinfo.factory.Factory<fuelfilter> {</fuelfilter></p>
<p>​              public FuelFilter create() { return new FuelFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class AirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<airfilter> {</airfilter></p>
<p>​              public AirFilter create() { return new AirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class CabinAirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cabinairfilter> {</cabinairfilter></p>
<p>​              public CabinAirFilter create() { return new CabinAirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class OilFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<oilfilter> {</oilfilter></p>
<p>​              public OilFilter create() { return new OilFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Belt extends Part {}</p>
<p>class FanBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<fanbelt> {</fanbelt></p>
<p>​              public FanBelt create() { return new FanBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class GeneratorBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<generatorbelt> {</generatorbelt></p>
<p>​              public GeneratorBelt create() { return new GeneratorBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class PowerSteeringBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<powersteeringbelt> {</powersteeringbelt></p>
<p>​              public PowerSteeringBelt create() { return new PowerSteeringBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredClasses14 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(Part.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredPetFactories15 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(PetFactory.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>class Coffee {</p>
<p>​       private static long counter = 0;</p>
<p>​       private final long id = counter++;</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName() + “ “ + id;</p>
<p>​       }</p>
<p>​       static List&lt;Factory&lt;? extends Coffee&gt;&gt; coffeeFactories =</p>
<p>​              new ArrayList&lt;Factory&lt;? extends Coffee&gt;&gt;();</p>
<p>​       static {</p>
<p>​              coffeeFactories.add(new Latte.Factory());</p>
<p>​              coffeeFactories.add(new Mocha.Factory());</p>
<p>​              coffeeFactories.add(new Cappuccino.Factory());</p>
<p>​              coffeeFactories.add(new Americano.Factory());</p>
<p>​              coffeeFactories.add(new Breve.Factory());</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Coffee createRandom() {</p>
<p>​              int n = rand.nextInt(coffeeFactories.size());</p>
<p>​              return coffeeFactories.get(n).create();</p>
<p>​       }</p>
<p>}</p>
<p>class Latte extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<latte> {</latte></p>
<p>​              public Latte create() { return new Latte(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Mocha extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<mocha> {</mocha></p>
<p>​              public Mocha create() { return new Mocha(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Cappuccino extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cappuccino> {</cappuccino></p>
<p>​              public Cappuccino create() { return new Cappuccino(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Americano extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<americano> {</americano></p>
<p>​              public Americano create() { return new Americano(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Breve extends Coffee {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<breve> {</breve></p>
<p>​              public Breve create() { return new Breve(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredCoffeeFactories16 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 15; i++)</p>
<p>​                     System.out.println(Coffee.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class ShowMethods17 {</p>
<p>​       private static String usage =</p>
<p>​              “usage:\n” +</p>
<p>​              “ShowMethods qualified.class.name\n” +</p>
<p>​              “To show all methods in class or:\n” +</p>
<p>​              “ShowMethods qualified.class.name word\n” +</p>
<p>​              “To search for methods involving ‘word’”;</p>
<p>​       private static Pattern p = Pattern.compile(“(\w+\.)|\s<em>final|\s</em>native”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     print(usage);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              int lines = 0;</p>
<p>​              try {</p>
<p>​                     Class&lt;?&gt; c = Class.forName(args[0]);</p>
<p>​                     Method[] methods = c.getMethods();</p>
<p>​                     Constructor[] ctors = c.getConstructors();</p>
<p>​                     if(args.length == 1) {</p>
<p>​                            for(Method method : methods) {</p>
<p>​                                   print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                            }</p>
<p>​                            for(Constructor ctor : ctors)</p>
<p>​                                   print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                            lines = methods.length + ctors.length;</p>
<p>​                     } else {</p>
<p>​                            for(Method method : methods)</p>
<p>​                                   if(method.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                                   }</p>
<p>​                            for(Constructor ctor : ctors) </p>
<p>​                                   if(ctor.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“No such class: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class ShowMethods18 {</p>
<p>​       private static String usage =</p>
<p>​              “usage:\n” +</p>
<p>​              “ShowMethods qualified.class.name\n” +</p>
<p>​              “To show all methods in class or:\n” +</p>
<p>​              “ShowMethods qualified.class.name word\n” +</p>
<p>​              “To search for methods involving ‘word’”;</p>
<p>​       private static Pattern p = Pattern.compile(“\w+\.”);</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     print(usage);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              int lines = 0;</p>
<p>​              try {</p>
<p>​                     Class&lt;?&gt; c = Class.forName(args[0]);</p>
<p>​                     Method[] methods = c.getMethods();</p>
<p>​                     Constructor[] ctors = c.getConstructors();</p>
<p>​                     if(args.length == 1) {</p>
<p>​                            for(Method method : methods) {</p>
<p>​                                   print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                            }</p>
<p>​                            for(Constructor ctor : ctors)</p>
<p>​                                   print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                            lines = methods.length + ctors.length;</p>
<p>​                     } else {</p>
<p>​                            for(Method method : methods)</p>
<p>​                                   if(method.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(method.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                                   }</p>
<p>​                            for(Constructor ctor : ctors) </p>
<p>​                                   if(ctor.toString().indexOf(args[1]) != -1) {</p>
<p>​                                          print(p.matcher(ctor.toString()).replaceAll(“”));</p>
<p>​                                          lines++;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     print(“No such class: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>interface HasBatteries {}</p>
<p>interface Waterproof {}</p>
<p>interface Shoots {}</p>
<p>class Toy {</p>
<p>​       Toy() {</p>
<p>​              print(“Creating Toy() object”);      </p>
<p>​       }</p>
<p>​       Toy(int i) {</p>
<p>​              print(“Creating Toy(“ + i + “) object”);</p>
<p>​       }</p>
<p>}</p>
<p>class FancyToy extends Toy </p>
<p>​       implements HasBatteries, Waterproof, Shoots {</p>
<p>​              FancyToy() { super(1); }</p>
<p>}</p>
<p>public class ToyTest19 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​                           try {</p>
<p>​                     Toy.class.getDeclaredConstructor(int.class).newInstance(1);</p>
<p>​                           } catch(NoSuchMethodException e) {</p>
<p>​                     print(“No such method: “ + e);</p>
<p>​              } catch(InstantiationException e) {</p>
<p>​                     print(“Unable make Toy: “ + e);</p>
<p>​              } catch(IllegalAccessException e) {</p>
<p>​                     print(“Unable access: “ + e);</p>
<p>​              } catch(InvocationTargetException e) {</p>
<p>​                     print(“Target invocation problem: “ + e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class ClassInfo {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     println(“Usage: name of class”);</p>
<p>​                     System.exit(0);</p>
<p>​              }</p>
<p>​              Class&lt;?&gt; c = null;</p>
<p>​              try {</p>
<p>​                     c = Class.forName(args[0]);</p>
<p>​              } catch(ClassNotFoundException e) {</p>
<p>​                     println(“No such class: “ + e);</p>
<p>​              }</p>
<p>​              println(“c: “ + c);</p>
<p>​              println(“c.getAnnotations(): “);</p>
<p>​              if(c.getAnnotations().length == 0) println(“none”);</p>
<p>​              for(Annotation a : c.getAnnotations())</p>
<p>​                     println(a);</p>
<p>​              println(“c.getCanonicalName(): “ + c.getCanonicalName());</p>
<p>​              println(“c.getClasses(): “);</p>
<p>​              if(c.getClasses().length == 0) println(“none”);</p>
<p>​              for(Class cl : c.getClasses())</p>
<p>​                     println(cl);</p>
<p>​              println(“c.getClassLoader(): “ + c.getClassLoader());</p>
<p>​              println(“c.getConstructors(): “);</p>
<p>​              if(c.getConstructors().length == 0) println(“none”);</p>
<p>​              for(Constructor ctor : c.getConstructors())</p>
<p>​                     println(ctor);</p>
<p>​              println(“c.getDeclaredAnnotations(): “);</p>
<p>​              if(c.getDeclaredAnnotations().length == 0) println(“none”);</p>
<p>​              for(Annotation a : c.getDeclaredAnnotations())</p>
<p>​                     println(a);</p>
<p>​              println(“c.getDeclaredClasses(): “);</p>
<p>​              if(c.getDeclaredClasses().length == 0) println(“none”);</p>
<p>​              for(Class cl : c.getDeclaredClasses())</p>
<p>​                     println(cl);</p>
<p>​              println(“c.getDeclaredConstructors(): “);</p>
<p>​              if(c.getDeclaredConstructors().length == 0) println(“none”);</p>
<p>​              for(Constructor ctor : c.getDeclaredConstructors())</p>
<p>​                     println(ctor);</p>
<p>​              println(“c.getDeclaredFields(): “);</p>
<p>​              if(c.getDeclaredFields().length == 0) println(“none”);</p>
<p>​              for(Field f : c.getDeclaredFields())</p>
<p>​                     println(f);</p>
<p>​              println(“c.getDeclaredMethods(): “);</p>
<p>​              if(c.getDeclaredMethods().length == 0) println(“none”);</p>
<p>​              for(Method m : c.getDeclaredMethods())</p>
<p>​                     println(m);</p>
<p>​              println(“c.getDeclaringClass(): “ + c.getDeclaringClass());</p>
<p>​              println(“c.getEnclosingConstructor(): “ + c.getEnclosingConstructor());</p>
<p>​              println(“c.getEnclosingMethod(): “ + c.getEnclosingMethod());</p>
<p>​              println(“c.getEnumConstants(): “ + c.getEnumConstants());</p>
<p>​              println(“c.getDeclaredFields(): “);</p>
<p>​              if(c.getFields().length == 0) println(“none”);</p>
<p>​              for(Field f : c.getFields())</p>
<p>​                     println(f);</p>
<p>​              println(“c.getGenericInterfaces(): “);</p>
<p>​              if(c.getGenericInterfaces().length == 0) println(“none”);</p>
<p>​              for(Type t : c.getGenericInterfaces())</p>
<p>​                     println(t);</p>
<p>​              println(“c.getGenericSuperclass(): “ + c.getGenericSuperclass());</p>
<p>​              println(“c.getInterfaces(): “);</p>
<p>​              if(c.getInterfaces().length == 0) println(“none”);</p>
<p>​              for(Class i : c.getInterfaces())</p>
<p>​                     println(i);</p>
<p>​              println(“c.getMethods(): “);</p>
<p>​              if(c.getMethods().length == 0) println(“none”);</p>
<p>​              for(Method m : c.getMethods())</p>
<p>​                     println(m);</p>
<p>​              println(“c.getModifiers(): “ + c.getModifiers());</p>
<p>​              println(“c.getName(): “ + c.getName());</p>
<p>​              println(“c.getPackage(): “ + c.getPackage());</p>
<p>​              println(“c.getProtectionDomain(): “ + c.getProtectionDomain());</p>
<p>​              print(“c.getSigners(): “);</p>
<p>​              if(c.getSigners() == null)</p>
<p>​                     println(c.getSigners());</p>
<p>​              if(c.getSigners() != null) {</p>
<p>​                     println();</p>
<p>​                     if(c.getSigners().length == 0) println(“none”);</p>
<p>​                     if(c.getSigners().length &gt; 0) {</p>
<p>​                            for(Object s : c.getSigners()) </p>
<p>​                                   println(s);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​              println(“c.getSimpleName(): “ + c.getSimpleName());</p>
<p>​              println(“c.getSuperclass(): “ + c.getSuperclass());</p>
<p>​              println(“c.getTypeParameters(): “ + c.getTypeParameters());</p>
<p>​              println(“c.isAnnotation(): “ + c.isAnnotation());</p>
<p>​              println(“c.isAnnotationPresent(Documented.class): “ + c.isAnnotationPresent(Documented.class));</p>
<p>​              println(“c.isAnonymousClass(): “ + c.isAnonymousClass());</p>
<p>​              println(“c.isArray(): “ + c.isArray());</p>
<p>​              println(“c.isAssignableFrom(ClassInfo.class): “ + c.isAssignableFrom(ClassInfo.class));</p>
<p>​              println(“c.isAssignableFrom(Object.class): “ + c.isAssignableFrom(Object.class));</p>
<p>​              println(“c.isEnum(): “ + c.isEnum());</p>
<p>​              println(“c.isInstance(Object.class): “ + c.isInstance(Object.class));</p>
<p>​              println(“c.isInterface(): “ + c.isInterface());</p>
<p>​              println(“c.isLocalClass(): “ + c.isLocalClass());</p>
<p>​              println(“c.isMemberClass(): “ + c.isMemberClass());</p>
<p>​              println(“c.isPrimitive(): “ + c.isPrimitive());</p>
<p>​              println(“c.isSynthetic(): “ + c.isSynthetic());         </p>
<p>​       }</p>
<p>}</p>
<p>interface Interface {</p>
<p>​       void doSomething();</p>
<p>​       void somethingElse(String arg);</p>
<p>}</p>
<p>class RealObject implements Interface {</p>
<p>​       public void doSomething() { print(“doSomething”); }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              print(“somethingElse “ + arg);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxy implements Interface {</p>
<p>​       private Interface proxied;</p>
<p>​       private static int doCount = 0;</p>
<p>​       private static int sECount = 0;</p>
<p>​       public SimpleProxy(Interface proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public void doSomething() { </p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called doSomething() “ + doCount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              doCount++;</p>
<p>​              proxied.doSomething();</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called somethingElse() “ + sECount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              sECount++;</p>
<p>​              proxied.somethingElse(arg);</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxyDemo21 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              consumer(new RealObject());</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));                                   </p>
<p>​       }</p>
<p>}</p>
<p>interface Interface {</p>
<p>​       void doSomething();</p>
<p>​       void somethingElse(String arg);</p>
<p>}</p>
<p>class RealObject implements Interface {</p>
<p>​       public void doSomething() { print(“doSomething”); }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              print(“somethingElse “ + arg);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxy implements Interface {</p>
<p>​       private Interface proxied;</p>
<p>​       private static int doCount = 0;</p>
<p>​       private static int sECount = 0;</p>
<p>​       public SimpleProxy(Interface proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public void doSomething() { </p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called doSomething() “ + doCount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              doCount++;</p>
<p>​              proxied.doSomething();</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>​       public void somethingElse(String arg) {</p>
<p>​              long timeIn = new Date().getTime();</p>
<p>​              print(“Time called somethingElse() “ + sECount + “: “ + timeIn + “ msecs”);</p>
<p>​              print(“on “ + new Date());</p>
<p>​              sECount++;</p>
<p>​              proxied.somethingElse(arg);</p>
<p>​              print(“Call-return time = “ + ((new Date().getTime()) - timeIn) + “ msecs”);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleProxyDemo21 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              consumer(new RealObject());</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));</p>
<p>​              print();</p>
<p>​              consumer(new SimpleProxy(new RealObject()));                                   </p>
<p>​       }</p>
<p>}</p>
<p>class DynamicProxyHandler implements InvocationHandler {</p>
<p>​       private Object proxied;</p>
<p>​       public DynamicProxyHandler(Object proxied) {</p>
<p>​              this.proxied = proxied;</p>
<p>​       }</p>
<p>​       public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</p>
<p>System.out.println(“**** proxy: “ + proxy.getClass() +</p>
<p>​                     “, method: “ + method + “, args: “ + args);</p>
<p>​              if(args != null)</p>
<p>​                     for(Object arg : args)</p>
<p>​                            System.out.println(“  “ + args);</p>
<p>​              return method.invoke(proxied, args);</p>
<p>​       }</p>
<p>}</p>
<p>class SimpleDynamicProxy23 {</p>
<p>​       public static void consumer(Interface iface) {</p>
<p>​              iface.doSomething();</p>
<p>​              iface.somethingElse(“bonobo”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              RealObject real = new RealObject();</p>
<p>​              consumer(real);</p>
<p>​                           Interface proxy = (Interface)Proxy.newProxyInstance(</p>
<p>​                     Interface.class.getClassLoader(),</p>
<p>​                     new Class[]{ Interface.class },</p>
<p>​                     new DynamicProxyHandler(real));</p>
<p>​              consumer(proxy);         </p>
<p>​       }</p>
<p>}</p>
<p>class Part {</p>
<p>​       public String toString() {</p>
<p>​              return getClass().getSimpleName();</p>
<p>​       }</p>
<p>​       static List&lt;Factory&lt;? extends Part&gt;&gt; partFactories = </p>
<p>​              new ArrayList&lt;Factory&lt;? extends Part&gt;&gt;();</p>
<p>​       static {</p>
<p>​                                        partFactories.add(new FuelFilter.Factory());</p>
<p>​              partFactories.add(new AirFilter.Factory());</p>
<p>​              partFactories.add(new CabinAirFilter.Factory());</p>
<p>​              partFactories.add(new OilFilter.Factory());</p>
<p>​              partFactories.add(new FanBelt.Factory());</p>
<p>​              partFactories.add(new PowerSteeringBelt.Factory());</p>
<p>​              partFactories.add(new GeneratorBelt.Factory());</p>
<p>​              partFactories.add(new NullPart.Factory());</p>
<p>​       }</p>
<p>​       private static Random rand = new Random();</p>
<p>​       public static Part createRandom() {</p>
<p>​              int n = rand.nextInt(partFactories.size());</p>
<p>​              return partFactories.get(n).create();            </p>
<p>​       } </p>
<p>​       </p>
<p>​       </p>
<p>}</p>
<p>class NullPart extends Part implements Null {</p>
<p>​       private NullPart() { super(); } </p>
<p>​       public static final Part NULL = new NullPart();</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<nullpart> {</nullpart></p>
<p>​              public NullPart create() { return (NullPart)NULL; }</p>
<p>​       }</p>
<p>​       public String toString() { return “NULL”; }</p>
<p>}</p>
<p>class Filter extends Part {}</p>
<p>class FuelFilter extends Filter {</p>
<p>​             public static class Factory implements typeinfo.factory.Factory<fuelfilter> {</fuelfilter></p>
<p>​              public FuelFilter create() { return new FuelFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class AirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<airfilter> {</airfilter></p>
<p>​              public AirFilter create() { return new AirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class CabinAirFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<cabinairfilter> {</cabinairfilter></p>
<p>​              public CabinAirFilter create() { return new CabinAirFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class OilFilter extends Filter {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<oilfilter> {</oilfilter></p>
<p>​              public OilFilter create() { return new OilFilter(); }</p>
<p>​       }</p>
<p>}</p>
<p>class Belt extends Part {}</p>
<p>class FanBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<fanbelt> {</fanbelt></p>
<p>​              public FanBelt create() { return new FanBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class GeneratorBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<generatorbelt> {</generatorbelt></p>
<p>​              public GeneratorBelt create() { return new GeneratorBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>class PowerSteeringBelt extends Belt {</p>
<p>​       public static class Factory implements typeinfo.factory.Factory<powersteeringbelt> {</powersteeringbelt></p>
<p>​              public PowerSteeringBelt create() { return new PowerSteeringBelt(); }</p>
<p>​       }</p>
<p>}</p>
<p>public class RegisteredFactories24 {</p>
<p>​       public static void main(String[] args) {</p>
<p>​              for(int i = 0; i &lt; 10; i++)</p>
<p>​                     System.out.println(Part.createRandom());</p>
<p>​       }</p>
<p>}</p>
<p>public class Finder25 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              A a = SecretMaker.makeSecret();</p>
<p>​              println(“a is of class type: “ + a.getClass().getName());</p>
<p>​              for(Method m : a.getClass().getDeclaredMethods()) {</p>
<p>​                     m.setAccessible(true);</p>
<p>​                     m.invoke(a);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>class Instrument {</p>
<p>​       void play(Note n) { print(“Instrument.play() “ + n); }</p>
<p>​       public String toString() { return “Instrument”; }</p>
<p>​       void adjust() { print(“Adjusting Instrument”); }</p>
<p>}</p>
<p>class Wind extends Instrument {</p>
<p>​       void play(Note n) { print(“Wind.play() “ + n); }</p>
<p>​       public String toString() { return “Wind”; }</p>
<p>​       void adjust() { print(“Adjusting Wind”); }</p>
<p>​       void clearSpitValve() { print(“Wind clearing spit valve”); }</p>
<p>}</p>
<p>class Percussion extends Instrument {</p>
<p>​       void play(Note n) { print(“Percussion.play() “ + n); }</p>
<p>​       public String toString() { return “Percussion”; }</p>
<p>​       void adjust() { print(“Adjusting Percussion”); } </p>
<p>}</p>
<p>class Stringed extends Instrument {</p>
<p>​       void play(Note n) { print(“Stringed.play() “ + n); }</p>
<p>​       public String toString() { return “Stringed”; }</p>
<p>​       void adjust() { print(“Adjusting Stringed”); } </p>
<p>}</p>
<p>class Keyboard extends Instrument {</p>
<p>​       void play(Note n) { print(“Keyboard.play() “ + n); }</p>
<p>​       public String toString() { return “Keyboard”; }</p>
<p>​       void adjust() { print(“Adjusting Keyboard”); } </p>
<p>}</p>
<p>class Brass extends Wind {</p>
<p>​       void play(Note n) { print(“Brass.play() “ + n); }</p>
<p>​       public String toString() { return “Brass”; }</p>
<p>​       void adjust() { print(“Adjusting Brass”); }</p>
<p>​       void clearSpitValve() { print(“Brass clearing spit valve”); }</p>
<p>}</p>
<p>class Woodwind extends Wind {</p>
<p>​       void play(Note n) { print(“Woodwind.play() “ + n); }</p>
<p>​       public String toString() { return “Woodwind”; }</p>
<p>​       void clearSpitValve() { print(“Woodwind clearing spit valve”); }</p>
<p>}</p>
<p>class Piano extends Keyboard {</p>
<p>​       void play(Note n) { print(“Piano.play() “ + n); }</p>
<p>​       public String toString() { return “Piano”; }</p>
<p>}</p>
<p>public class Music26 {</p>
<p>​                   public static void tune(Instrument i) {</p>
<p>​                           i.play(Note.MIDDLE_C);</p>
<p>​       }</p>
<p>​       public static void tuneAll(Instrument[] e) {</p>
<p>​              for(Instrument i : e)</p>
<p>​                     tune(i);</p>
<p>​       }</p>
<p>​       private static RandomInstrumentGenerator gen = new RandomInstrumentGenerator();    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           Instrument[] orchestra = new Instrument[20];</p>
<p>​                           for(int i = 0; i &lt; orchestra.length; i++)</p>
<p>​                     orchestra[i] = gen.next();</p>
<p>​              for(Instrument i : orchestra) {</p>
<p>​                     if(i instanceof Wind)                         ((Wind)i).clearSpitValve();</p>
<p>​                     i.adjust();</p>
<p>​              }</p>
<p>​              tuneAll(orchestra);</p>
<p>​       }</p>
<p>}</p>
<p>class Instrument {</p>
<p>​       void play(Note n) { print(“Instrument.play() “ + n); }</p>
<p>​       public String toString() { return “Instrument”; }</p>
<p>​       void adjust() { print(“Adjusting Instrument”); }</p>
<p>}</p>
<p>class Wind extends Instrument {</p>
<p>​       void play(Note n) { print(“Wind.play() “ + n); }</p>
<p>​       public String toString() { return “Wind”; }</p>
<p>​       void adjust() { print(“Adjusting Wind”); }</p>
<p>​       void clearSpitValve() { print(“Wind clearing spit valve”); }</p>
<p>}</p>
<p>class Percussion extends Instrument {</p>
<p>​       void play(Note n) { print(“Percussion.play() “ + n); }</p>
<p>​       public String toString() { return “Percussion”; }</p>
<p>​       void adjust() { print(“Adjusting Percussion”); } </p>
<p>}</p>
<p>class Stringed extends Instrument {</p>
<p>​       void play(Note n) { print(“Stringed.play() “ + n); }</p>
<p>​       public String toString() { return “Stringed”; }</p>
<p>​       void adjust() { print(“Adjusting Stringed”); } </p>
<p>}</p>
<p>class Keyboard extends Instrument {</p>
<p>​       void play(Note n) { print(“Keyboard.play() “ + n); }</p>
<p>​       public String toString() { return “Keyboard”; }</p>
<p>​       void adjust() { print(“Adjusting Keyboard”); } </p>
<p>}</p>
<p>class Brass extends Wind {</p>
<p>​       void play(Note n) { print(“Brass.play() “ + n); }</p>
<p>​       public String toString() { return “Brass”; }</p>
<p>​       void adjust() { print(“Adjusting Brass”); }</p>
<p>​       void clearSpitValve() { print(“Brass clearing spit valve”); }</p>
<p>}</p>
<p>class Woodwind extends Wind {</p>
<p>​       void play(Note n) { print(“Woodwind.play() “ + n); }</p>
<p>​       public String toString() { return “Woodwind”; }</p>
<p>​       void clearSpitValve() { print(“Woodwind clearing spit valve”); }</p>
<p>}</p>
<p>class Piano extends Keyboard {</p>
<p>​       void play(Note n) { print(“Piano.play() “ + n); }</p>
<p>​       public String toString() { return “Piano”; }</p>
<p>}</p>
<p>public class Music26 {</p>
<p>​                   public static void tune(Instrument i) {</p>
<p>​                           i.play(Note.MIDDLE_C);</p>
<p>​       }</p>
<p>​       public static void tuneAll(Instrument[] e) {</p>
<p>​              for(Instrument i : e)</p>
<p>​                     tune(i);</p>
<p>​       }</p>
<p>​       private static RandomInstrumentGenerator gen = new RandomInstrumentGenerator();    </p>
<p>​       public static void main(String[] args) {</p>
<p>​                           Instrument[] orchestra = new Instrument[20];</p>
<p>​                           for(int i = 0; i &lt; orchestra.length; i++)</p>
<p>​                     orchestra[i] = gen.next();</p>
<p>​              for(Instrument i : orchestra) {</p>
<p>​                     if(i instanceof Wind)                         ((Wind)i).clearSpitValve();</p>
<p>​                     i.adjust();</p>
<p>​              }</p>
<p>​              tuneAll(orchestra);</p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解问题/" itemprop="url">Java题解问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="2-1-1-练习"><a href="#2-1-1-练习" class="headerlink" title="2 . 1 1 练习"></a>2 . 1 1 练习</h2><p>(1) 参照本章的第一个例子，创建一个“Hello，World”程序，在屏幕上简单地显示这句话。注意在自己的类里只需一个方法（“main”方法会在程序启动时执行）。记住要把它设为static 形式，并置入自变量列表——即使根本不会用到这个列表。用javac 编译这个程序，再用java 运行它。</p>
<p>(2) 写一个程序，打印出从命令行获取的三个自变量。</p>
<p>(3) 找出Property.java 第二个版本的代码，这是一个简单的注释文档示例。请对文件执行javadoc，并在自己的Web 浏览器里观看结果。</p>
<p>(4) 以练习(1)的程序为基础，向其中加入注释文档。利用javadoc，将这个注释文档提取为一个HTML 文件，并用Web 浏览器观看。</p>
<h2 id="3-4-练习"><a href="#3-4-练习" class="headerlink" title="3 . 4 练习"></a>3 . 4 练习</h2><p>(1) 写一个程序，打印出1 到100 间的整数。</p>
<p>(2) 修改练习(1)，在值为47 时用一个break 退出程序。亦可换成return 试试。</p>
<p>(3) 创建一个switch 语句，为每一种case 都显示一条消息。并将switch 置入一个for 循环里，令其尝试每一种case。在每个case 后面都放置一个break，并对其进行测试。然后，删除break，看看会有什么情况出现。</p>
<h2 id="4-7-练习"><a href="#4-7-练习" class="headerlink" title="4 . 7 练习"></a>4 . 7 练习</h2><p>(1) 用默认构建器创建一个类（没有自变量），用它打印一条消息。创建属于这个类的一个对象。</p>
<p>(2) 在练习1 的基础上增加一个过载的构建器，令其采用一个String 自变量，并随同自己的消息打印出来。</p>
<p>(3) 以练习2 创建的类为基础上，创建属于它的对象句柄的一个数组，但不要实际创建对象并分配到数组里。运行程序时，注意是否打印出来自构建器调用的初始化消息。</p>
<p>(4) 创建同句柄数组联系起来的对象，最终完成练习3。</p>
<p>(5) 用自变量“before”，“after”和“none”运行程序，试验Garbage.java。重复这个操作，观察是否从输出中看出了一些固定的模式。改变代码，使System.runFinalization()在System.gc()之前调用，再观察结果。</p>
<h2 id="5-6-练习"><a href="#5-6-练习" class="headerlink" title="5 . 6 练习"></a>5 . 6 练习</h2><p>(1) 用public、private、protected 以及“友好的”数据成员及方法成员创建一个类。创建属于这个类的一个对象，并观察在试图访问所有类成员时会获得哪种类型的编译器错误提示。注意同一个目录内的类属于“默认”包的一部分。(2) 用protected 数据创建一个类。在相同的文件里创建第二个类，用一个方法操纵第一个类里的protected 数据。(3) 新建一个目录，并编辑自己的CLASSPATH，以便包括那个新目录。将P.class 文件复制到自己的新目录，然后改变文件名、P 类以及方法名（亦可考虑添加额外的输出，观察它的运行过程）。在一个不同的目录里创建另一个程序，令其使用自己的新类。</p>
<p>(4) 在c05 目录（假定在自己的CLASSPATH 里）创建下述文件：//: PackagedClass.javapackage c05;class PackagedClass {public PackagedClass() {System.out.println(“Creating a packaged class”);}} ///:<del>然后在c05 之外的另一个目录里创建下述文件：//: Foreign.javapackage c05.foreign;import c05.*;public class Foreign {public static void main (String[] args) {PackagedClass pc = new PackagedClass();}138} ///:</del>解释编译器为什么会产生一个错误。将Foreign（外部）类作为c05 包的一部分改变了什么东西吗？</p>
<h2 id="6-1-1-练习"><a href="#6-1-1-练习" class="headerlink" title="6 . 1 1 练习"></a>6 . 1 1 练习</h2><p>(1) 用默认构建器（空自变量列表）创建两个类：A 和B，令它们自己声明自己。从A 继承一个名为C 的新类，并在C 内创建一个成员B。不要为C 创建一个构建器。创建类C 的一个对象，并观察结果。</p>
<p>(2) 修改练习1，使A 和B 都有含有自变量的构建器，则不是采用默认构建器。为C 写一个构建器，并在C的构建器中执行所有初始化工作。</p>
<p>(3) 使用文件Cartoon.java ，将Cartoon 类的构建器代码变成注释内容标注出去。解释会发生什么事情。</p>
<p>(4) 使用文件Chess.java，将Chess 类的构建器代码作为注释标注出去。同样解释会发生什么。</p>
<h2 id="7-1-0-练习"><a href="#7-1-0-练习" class="headerlink" title="7 . 1 0 练习"></a>7 . 1 0 练习</h2><p>(1) 创建Rodent（啮齿动物）:Mouse（老鼠）,Gerbil（鼹鼠）,Hamster（大颊鼠）等的一个继承分级结构。在基础类中，提供适用于所有Rodent 的方法，并在衍生类中覆盖它们，从而根据不同类型的Rodent 采取不同的行动。创建一个Rodent 数组，在其中填充不同类型的Rodent，然后调用自己的基础类方法，看看会有什么情况发生。</p>
<p>(2) 修改练习1，使Rodent 成为一个接口。</p>
<p>(3) 改正WindError.java 中的问题。</p>
<p>(4) 在GreenhouseControls.java 中，添加Event 内部类，使其能打开和关闭风扇。</p>
<h2 id="8-9-练习"><a href="#8-9-练习" class="headerlink" title="8 . 9 练习"></a>8 . 9 练习</h2><p>(1) 新建一个名为Gerbil 的类，在构建器中初始化一个int gerbilNumber（类似本章的Mouse 例子）。为其写一个名为hop()的方法，用它打印出符合hop()条件的Gerbil 的编号。建一个Vector，并为Vector 添加一系列Gerbil 对象。现在，用elementAt()方法在Vector 中遍历，并为每个Gerbil 都调用hop()。</p>
<p>(2) 修改练习1，用Enumeration 在调用hop()的同时遍历Vector。</p>
<p>(3) 在AssocArray.java 中，修改这个例子，令其使用一个Hashtable，而不是AssocArray。</p>
<p>(4) 获取练习1 用到的Gerbil 类，改为把它置入一个Hashtable，然后将Gerbil 的名称作为一个String（键）与置入表格的每个Gerbil（值）都关联起来。获得用于keys()的一个Enumeration，并用它在Hashtable 里遍历，查找每个键的Gerbil，打印出键，然后将gerbil 告诉给hop()。</p>
<p>(5) 修改第7 章的练习1，用一个Vector 容纳Rodent（啮齿动物），并用Enumeration 在Rodent 序列中遍历。记住Vector 只能容纳对象，所以在访问单独的Rodent 时必须采用一个造型（如RTTI ）。</p>
<p>(6) 转到第7 章的中间位置，找到那个GreenhouseControls.java（温室控制）例子，该例应该由三个文件构成。在Controller.java 中，类EventSet 仅是一个集合。修改它的代码，用一个Stack 代替EventSet 。当然，这时可能并不仅仅用Stack 取代EventSet 这样简单；也需要用一个Enumeration 遍历事件集。可考虑在某些时候将集合当作Stack 对待，另一些时候则当作Vector 对待——这样或许能使事情变得更加简单。</p>
<p>(7) （有一定挑战性）在与所有Java 发行包配套提供的Java 源码库中找出用于Vector 的源码。复制这些代码，制作名为intVector 的一个特殊版本，只在其中包含int 数据。思考是否能为所有基本数据类型都制作Vector 的一个特殊版本。接下来，考虑假如制作一个链接列表类，令其能随同所有基本数据类型使用，那么会发生什么情况。若在Java 中提供了参数化类型，利用它们便可自动完成这一工作（还有其他许多好处）。</p>
<h2 id="9-1-0-练习"><a href="#9-1-0-练习" class="headerlink" title="9 . 1 0 练习"></a>9 . 1 0 练习</h2><p>(1) 用main()创建一个类，令其掷出try 块内的Exception 类的一个对象。为Exception 的构建器赋予一个字串参数。在catch 从句内捕获违例，并打印出字串参数。添加一个finally 从句，并打印一条消息，证明自己真正到达那里。</p>
<p>(2) 用extends 关键字创建自己的违例类。为这个类写一个构建器，令其采用String 参数，并随同String句柄把它保存到对象内。写一个方法，令其打印出保存下来的String。创建一个try-catch 从句，练习实际操作新违例。</p>
<p>(3) 写一个类，并令一个方法掷出在练习2 中创建的类型的一个违例。试着在没有违例规范的前提下编译它，观察编译器会报告什么。接着添加适当的违例规范。在一个try-catch 从句中尝试自己的类以及它的违例。</p>
<p>(4) 在第5 章，找到调用了Assert.java 的两个程序，并修改它们，令其掷出自己的违例类型，而不是打印到System.err。该违例应是扩展了RuntimeException 的一个内部类。</p>
<h2 id="1-0-1-1-练习"><a href="#1-0-1-1-练习" class="headerlink" title="1 0 . 1 1 练习"></a>1 0 . 1 1 练习</h2><p>(1) 打开一个文本文件，每次读取一行内容。将每行作为一个String 读入，并将那个String 对象置入一个Vector 里。按相反的顺序打印出Vector 中的所有行。</p>
<p>(2) 修改练习1，使读取那个文件的名字作为一个命令行参数提供。</p>
<p>(3) 修改练习2，又打开一个文本文件，以便将文字写入其中。将Vector 中的行随同行号一起写入文件。</p>
<p>(4) 修改练习2，强迫Vector 中的所有行都变成大写形式，将结果发给System.out。</p>
<p>(5) 修改练习2，在文件中查找指定的单词。打印出包含了欲找单词的所有文本行。</p>
<p>(6) 在Blips.java 中复制文件，将其重命名为BlipCheck.java。然后将类Blip2 重命名为BlipCheck（在进程中将其标记为public）。删除文件中的//!记号，并执行程序。接下来，将BlipCheck 的默认构建器变成注释信息。运行它，并解释为什么仍然能够工作。</p>
<p>(7) 在Blip3.java 中，将接在“You must do this:”字样后的两行变成注释，然后运行程序。解释得到的结果为什么会与执行了那两行代码不同。</p>
<p>(8) 转换SortedWordCount.java 程序，以便使用Java 1.1 IO 流。</p>
<p>(9) 根据本章正文的说明修改程序CADState.java。</p>
<p>(10) 在第7 章（中间部分）找到GreenhouseControls.java 示例，它应该由三个文件构成。在GreenhouseControls.java 中，Restart()内部类有一个硬编码的事件集。请修改这个程序，使其能从一个文本文件里动态读取事件以及它们的相关时间。</p>
<h2 id="1-1-5-练习"><a href="#1-1-5-练习" class="headerlink" title="1 1 . 5 练习"></a>1 1 . 5 练习</h2><p>(1) 写一个方法，向它传递一个对象，循环打印出对象层次结构中的所有类。</p>
<p>(2) 在ToyTest.java 中，将Toy 的默认构建器标记成注释信息，解释随之发生的事情。</p>
<p>(3) 新建一种类型的集合，令其使用一个Vector。捕获置入其中的第一个对象的类型，然后从那时起只允许用户插入那种类型的对象。</p>
<p>(4) 写一个程序，判断一个Char 数组属于基本数据类型，还是一个真正的对象。</p>
<p>(5) 根据本章的说明，实现clearSpitValve()。</p>
<p>(6) 实现本章介绍的rotate(Shape)方法，令其检查是否已经旋转了一个圆（若已旋转，就不再执行旋转操作）。</p>
<h2 id="1-2-6-练习"><a href="#1-2-6-练习" class="headerlink" title="1 2 . 6 练习"></a>1 2 . 6 练习</h2><p>(1) 创建一个myString 类，在其中包含了一个String 对象，以便用在构建器中用构建器的自变量对其进行初始化。添加一个toString()方法以及一个concatenate()方法，令其将一个String 对象追加到我们的内部字串。在myString 中实现clone()。创建两个static 方法，每个都取得一个myString x 句柄作为自己的自变量，并调用x.concatenate(“test”)。但在第二个方法中，请首先调用clone()。测试这两个方法，观察它们不同的结果。</p>
<p>(2) 创建一个名为Battery（电池）的类，在其中包含一个int，用它表示电池的编号（采用独一无二的标识符的形式）。接下来，创建一个名为Toy 的类，其中包含了一个Battery 数组以及一个toString，用于打印出所有电池。为Toy 写一个clone()方法，令其自动关闭所有Battery 对象。克隆Toy 并打印出结果，完成对它的测试。</p>
<p>(3) 修改CheckCloneable.java，使所有clone()方法都能捕获CloneNotSupportException 违例，而不是把它直接传递给调用者</p>
<p>(4) 修改Compete.java，为Thing2 和Thing4 类添加更多的成员对象，看看自己是否能判断计时随复杂性变化的规律——是一种简单的线性关系，还是看起来更加复杂。(5) 从Snake.java 开始，创建Snake 的一个深层复制版本。 </p>
<h2 id="1-3-2-1-练习"><a href="#1-3-2-1-练习" class="headerlink" title="1 3 . 2 1 练习"></a>1 3 . 2 1 练习</h2><p>(1)创建一个有文字字段和三个按钮的程序片。当我们按下每个按钮时，使不同的文字显示在文字段中。</p>
<p>(2)增加一个复选框到练习1 创建的程序中，捕捉事件，并插入不同的文字到文字字段中。</p>
<p>(3)创建一个程序片并增加所有导致action() 被调用的组件，然后捕捉他们的事件并在文字字段中为每个组件显示一个特定的消息。</p>
<p>(4)增加可以被handleEvent()方法测试事件的组件到练习3 中。过载handleEvent()并在文字字段中为每个组件显示特定的消息。</p>
<p>(5)创建一个有一个按钮和一个TextField 的程序片。编写一个handleEvent()，以便如果按钮有焦点，输入字符到将显示的TextField 中。</p>
<p>(6)创建一个应用程序并将本章所有的组件增加主要的帧，包括菜单和对话框。</p>
<p>(7)修改TextNew.java，以便字母在t2 中保持输入时的样子，取代自动变成大写。</p>
<p>(8)修改CardLayout1.java 以便它使用Java 1.1 的事件模型。</p>
<p>(9)增加Frog.class 到本章出现的清单文件中并运行jar 以创建一个包括Frog 和BangBean 的JAR 文件。现在从SUN 公司处下载并安装BDK 或者使用我们自己的可激活Bean 的程序构建工具并增加JAR 文件到我们的环境中，因此我们可以测试两个Bean 。</p>
<p>(10)创建我们自己的包括两个属性：一个布尔值为“on”，另一个为整型“level”，称为Valve 的JavaBean。创建一个清单文件，利用jar 打包我们的Bean，然后读入它到beanbox 或到我们自己的激活程序构建工具里，因此我们可以测试它。</p>
<p>(11)修改Menus.java，以便它处理多级菜单。这要假设读者已经熟悉了HTML 的基础知识。但那些东西并不难理解，而且有一些书和资料可供参考。    </p>
<h2 id="1-4-7-练习"><a href="#1-4-7-练习" class="headerlink" title="1 4 . 7 练习"></a>1 4 . 7 练习</h2><p>(1) 从Thread 继承一个类，并（过载）覆盖run()方法。在run()内，打印出一条消息，然后调用sleep()。重复三遍这些操作，然后从run()返回。在构建器中放置一条启动消息，并覆盖finalize()，打印一条关闭消息。创建一个独立的线程类，使它在run()内调用System.gc()和System.runFinalization()，并打印一条消息，表明调用成功。创建这两种类型的几个线程，然后运行它们，看看会发生什么。</p>
<p>(2) 修改Counter2.java，使线程成为一个内部类，而且不需要明确保存指向Counter2 的一个。</p>
<p>(3) 修改Sharing2.java，在TwoCounter 的run()方法内部添加一个synchronized（同步）块，而不是同步整个run()方法。</p>
<h2 id="1-5-1-0-练习"><a href="#1-5-1-0-练习" class="headerlink" title="1 5 . 1 0 练习"></a>1 5 . 1 0 练习</h2><p>(1) 编译和运行本章中的JabberServer 和JabberClient 程序。接着编辑一下程序，删去为输入和输出设计的所有缓冲机制，然后再次编译和运行，观察一下结果。</p>
<p>(2) 创建一个服务器，用它请求用户输入密码，然后打开一个文件，并将文件通过网络连接传送出去。创建一个同该服务器连接的客户，为其分配适当的密码，然后捕获和保存文件。在自己的机器上用localhost（通过调用InetAddress.getByName(null)生成本地IP 地址127.0.0.1）测试这两个程序。</p>
<p>(3) 修改练习2 中的程序，令其用多线程机制对多个客户进行控制。</p>
<p>(4) 修改JabberClient，禁止输出刷新，并观察结果。</p>
<p>(5) 以ShowHTML.java 为基础，创建一个程序片，令其成为对自己Web 站点的特定部分进行密码保护的大587门。</p>
<p>(6) （可能有些难度）创建一对客户／服务器程序，利用数据报（Datagram）将一个文件从一台机器传到另一台（参见本章数据报小节末尾的叙述）。</p>
<p>(7) （可能有些难度）对VLookup.java 程序作一番修改，使我们能点击得到的结果名字，然后程序会自动取得那个名字，并把它复制到剪贴板（以便我们方便地粘贴到自己的E-mail ）。可能要回过头去研究一下IO数据流的那一章，回忆该如何使用Java 1.1 剪贴板。</p>
<h2 id="1-6-1-0-练习"><a href="#1-6-1-0-练习" class="headerlink" title="1 6 . 1 0 练习"></a>1 6 . 1 0 练习</h2><p>(1) 将SingletonPattern.java 作为起点，创建一个类，用它管理自己固定数量的对象。</p>
<p>(2) 为TrashVisitor.java 添加一个名为Plastic（塑料）的类。</p>
<p>(3) 为DynaTrash.java 同样添加一个Plastic（塑料）类。 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/06/2019-10-06-Java题解注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/06/2019-10-06-Java题解注释/" itemprop="url">Java题解注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-06T10:00:00+08:00">
                2019-10-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第二十章-注释"><a href="#第二十章-注释" class="headerlink" title="第二十章 注释"></a>第二十章 注释</h2><p>public class TableCreator1 {</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              if(args.length &lt; 1) {</p>
<p>​                     System.out.println(“arguments: annotated classes”);</p>
<p>​                     System.exit(0);</p>
<p>​              }      </p>
<p>​              for(String className : args) {</p>
<p>​                     Class&lt;?&gt; cl = Class.forName(className);</p>
<p>​                     DBTable dbTable = cl.getAnnotation(DBTable.class);</p>
<p>​                     if(dbTable == null) {</p>
<p>​                            System.out.println(“No DBTable annotations in class “ +</p>
<p>​                                   className);</p>
<p>​                            continue;</p>
<p>​                     }</p>
<p>​                     String tableName = dbTable.name();</p>
<p>​                                         if(tableName.length() &lt; 1)</p>
<p>​                            tableName = cl.getName().toUpperCase();</p>
<p>​                     List<string> columnDefs = new ArrayList<string>();</string></string></p>
<p>​                     for(Field field : cl.getDeclaredFields()) {</p>
<p>​                            String columnName = null;</p>
<p>​                            Annotation[] anns = field.getDeclaredAnnotations();</p>
<p>​                            if(anns.length &lt; 1) continue;                          if(anns[0] instanceof SQLInteger) {</p>
<p>​                                   SQLInteger sInt = (SQLInteger) anns[0];</p>
<p>​                                                                     if(sInt.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sInt.name();</p>
<p>​                                   columnDefs.add(columnName + “ INT” +</p>
<p>​                                          getConstraints(sInt.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLString) {</p>
<p>​                                   SQLString sString = (SQLString)anns[0];</p>
<p>​                                                                     if(sString.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                           columnName = sString.name();</p>
<p>​                                   columnDefs.add(columnName + “ VARCHAR(“ + </p>
<p>​                                          sString.value() + “)” +</p>
<p>​                                          getConstraints(sString.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLBoolean) {</p>
<p>​                                   SQLBoolean sBool = (SQLBoolean) anns[0];</p>
<p>​                                                                     if(sBool.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBool.name();</p>
<p>​                                   columnDefs.add(columnName + “ BOOLEAN(“ +</p>
<p>​                                          getConstraints(sBool.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLDateTime) { </p>
<p>​                                   SQLDateTime sDateTime = (SQLDateTime)anns[0];</p>
<p>​                                                                     if(sDateTime.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sDateTime.name();</p>
<p>​                                   columnDefs.add(columnName + “ DATETIME(“ +</p>
<p>​                                          getConstraints(sDateTime.constraints()));  </p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLVarChar) {</p>
<p>​                                   SQLVarChar sVarChar = (SQLVarChar)anns[0];</p>
<p>​                                   if(sVarChar.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sVarChar.name();</p>
<p>​                                   columnDefs.add(columnName + “ VARCHAR(“ +</p>
<p>​                                          getConstraints(sVarChar.constraints()));</p>
<p>​                            }</p>
<p>​                            if(anns[0] instanceof SQLBlob) {</p>
<p>​                                   SQLBlob sBlob = (SQLBlob)anns[0];</p>
<p>​                                                                     if(sBlob.name().length() &lt; 1)</p>
<p>​                                          columnName = field.getName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBlob.name();</p>
<p>​                                   columnDefs.add(columnName + “ BLOB(“ +</p>
<p>​                                          getConstraints(sBlob.constraints()));</p>
<p>​                            }</p>
<p>​                            StringBuilder createCommand = new StringBuilder(</p>
<p>​                                   “CREATE TABLE “ + tableName + “(“);</p>
<p>​                            for(String columnDef : columnDefs)</p>
<p>​                                   createCommand.append(“\n     “ + columnDef + “,”);</p>
<p>​                                                       String tableCreate = createCommand.substring(</p>
<p>​                                   0, createCommand.length() - 1) +”);”;</p>
<p>​                            System.out.println(“Table Creation SQL for “ + </p>
<p>​                                   className + “ is :\n” + tableCreate);</p>
<p>​                     }</p>
<p>​              }</p>
<p>​       }</p>
<p>​       private static String getConstraints(Constraints con) {</p>
<p>​              String  constraints = “”;</p>
<p>​              if(!con.allowNull()) constraints += “ NOT NULL”;</p>
<p>​              if(con.primaryKey()) constraints += “ PRIMARY KEY”;</p>
<p>​              if(con.unique()) constraints += “ UNIQUE”;</p>
<p>​              return constraints;</p>
<p>​       }</p>
<p>}      </p>
<p>@ExtractInterface(“IDivider”)</p>
<p>public class Divider {</p>
<p>​       public int divide(int x, int y) throws ArithmeticException {</p>
<p>​              if(y == 0) throw new ArithmeticException(“Divide by zero”);</p>
<p>​              int diff = subtract(x, y);</p>
<p>​              if(diff &lt; 0) return 0;</p>
<p>​              if(diff == 0) return 1;</p>
<p>​              int result = 0;</p>
<p>​              while(diff &gt;= 0) {</p>
<p>​                     result++;</p>
<p>​                     diff = subtract(diff, y);                        </p>
<p>​              }</p>
<p>​              return result;</p>
<p>​       }</p>
<p>​       private int subtract(int x, int y) { return x - y; }</p>
<p>​       public static void main(String[] args) {</p>
<p>​              try {</p>
<p>​              Divider d = new Divider();</p>
<p>​              print(“11              print(“10              print(“10              print(“10              print(“10              print(“10              } catch(Exception e)  {</p>
<p>​                     print(e);</p>
<p>​              }</p>
<p>​       }</p>
<p>}</p>
<p>public class TableCreationProcessorFactory3 implements AnnotationProcessorFactory {</p>
<p>​       public AnnotationProcessor getProcessorFor(</p>
<p>​              Set<annotationtypedeclaration> atds, AnnotationProcessorEnvironment env) {</annotationtypedeclaration></p>
<p>​              return new TableCreationProcessor(env);</p>
<p>​       }</p>
<p>​       public Collection<string> supportedAnnotationTypes() {</string></p>
<p>​              return Arrays.asList(</p>
<p>​                     “annotations.database.DBTable”,</p>
<p>​                     “annotations.database.Constraints”,</p>
<p>​                     “annotations.database.SQLString”,</p>
<p>​                     “annotations.database.SQLInteger”,</p>
<p>​                     “annotations.database.SQLBoolean”,</p>
<p>​                     “annotations.database.SQLVarChar”,</p>
<p>​                     “annotations.database.SQLDateTime”,</p>
<p>​                     “annotations.database.SQLBlob”);</p>
<p>​       }</p>
<p>​       public Collection<string> supportedOptions() {</string></p>
<p>​              return Collections.emptySet();</p>
<p>​       }</p>
<p>​       private static class TableCreationProcessor implements AnnotationProcessor {</p>
<p>​              private final AnnotationProcessorEnvironment env;</p>
<p>​              private String sql = “”;</p>
<p>​              public TableCreationProcessor(AnnotationProcessorEnvironment env) {</p>
<p>​                     this.env = env;</p>
<p>​              } </p>
<p>​              public void process() {</p>
<p>​                     for(TypeDeclaration typeDecl : env.getSpecifiedTypeDeclarations()) {</p>
<p>​                            typeDecl.accept(getDeclarationScanner(new TableCreationVisitor(), NO_OP));</p>
<p>​                            sql = sql.substring(0, sql.length() - 1) + “);”;</p>
<p>​                            System.out.println(“creation SQL is :\n” + sql);</p>
<p>​                            sql = “”;</p>
<p>​                     }</p>
<p>​              }      </p>
<p>​              private class TableCreationVisitor extends SimpleDeclarationVisitor {</p>
<p>​                     public void visitClassDeclaration(ClassDeclaration d) {</p>
<p>​                            DBTable dbTable = d.getAnnotation(DBTable. class);</p>
<p>​                            if(dbTable != null) {</p>
<p>​                                   sql += “CREATE TABLE “;</p>
<p>​                                   sql += (dbTable.name().length() &lt; 1) ? </p>
<p>​                                          d.getSimpleName().toUpperCase() : dbTable.name();</p>
<p>​                                   sql += “ (“;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​                     public void visitFieldDeclaration(FieldDeclaration d) {</p>
<p>​                            String columnName = “”;</p>
<p>​                            if(d.getAnnotation(SQLInteger.class) != null) {</p>
<p>​                                   SQLInteger sInt = d.getAnnotation(SQLInteger.class);</p>
<p>​                                                                     if(sInt.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sInt.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ INT” + </p>
<p>​                                          getConstraints(sInt.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLString.class) != null) {</p>
<p>​                                   SQLString sString = d.getAnnotation(SQLString.class);</p>
<p>​                                                                     if(sString.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sString.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ VARCHAR(“ + </p>
<p>​                                          sString.value() + “)” +</p>
<p>​                                          getConstraints(sString.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLBoolean.class) != null) {</p>
<p>​                                   SQLBoolean sBoolean = d.getAnnotation(SQLBoolean.class);</p>
<p>​                                                                     if(sBoolean.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBoolean.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ BOOLEAN(“ +</p>
<p>​                                          getConstraints(sBoolean.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLVarChar.class) != null) {</p>
<p>​                                   SQLVarChar sVarChar = d.getAnnotation(SQLVarChar.class);</p>
<p>​                                                                     if(sVarChar.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sVarChar.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ VARCHAR(“ +</p>
<p>​                                          getConstraints(sVarChar.constraints()) + “,”;     </p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLDateTime.class) != null) {</p>
<p>​                                   SQLDateTime sDateTime = d.getAnnotation(SQLDateTime.class);</p>
<p>​                                   if(sDateTime.name().length() &lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sDateTime.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ DATETIME(“ +</p>
<p>​                                          getConstraints(sDateTime.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                            if(d.getAnnotation(SQLBlob.class) != null) {</p>
<p>​                                   SQLBlob sBlob = d.getAnnotation(SQLBlob.class);</p>
<p>​                                   if(sBlob.name().length()&lt; 1)</p>
<p>​                                          columnName = d.getSimpleName().toUpperCase();</p>
<p>​                                   else</p>
<p>​                                          columnName = sBlob.name();</p>
<p>​                                   sql += “\n   “ + columnName + “ BLOB(“ +</p>
<p>​                                          getConstraints(sBlob.constraints()) + “,”;</p>
<p>​                            }</p>
<p>​                     }</p>
<p>​                     private String getConstraints(Constraints con) {</p>
<p>​                            String constraints = “”;</p>
<p>​                            if(!con.allowNull())  constraints += “ NOT NULL”;</p>
<p>​                            if(con.primaryKey())  constraints += “ PRIMARY KEY”;</p>
<p>​                            if(con.unique()) constraints += “ UNIQUE”;</p>
<p>​                            return constraints;</p>
<p>​                     }</p>
<p>​              }      </p>
<p>​       }</p>
<p>}</p>
<p>public class AtUnitComposition4 {</p>
<p>​       AtUnitExampleEx4 testObject = new AtUnitExampleEx4();</p>
<p>​       @Test boolean _methodOne() { </p>
<p>​              return testObject.methodOne().equals(“This is methodOne”);</p>
<p>​       }</p>
<p>​       @Test boolean _methodTwo() {</p>
<p>​              return testObject.methodTwo() == 2;</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit AtUnitComposition4”);</p>
<p>​       }</p>
<p>}</p>
<p>public class HashSetTest5 extends HashSet<string> {   @Test void initialization() {</string></p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              this.add(“one”);</p>
<p>​              assert this.contains(“one”);</p>
<p>​       }      </p>
<p>​       @Test void _remove() {</p>
<p>​              this.add(“one”);</p>
<p>​              this.remove(“one”);</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit HashSetTest5”);</p>
<p>​       }</p>
<p>}</p>
<p>public class LinkedListTest6 {</p>
<p>​       LinkedList<string> testObject = new LinkedList<string>();</string></string></p>
<p>​       @Test void initialization() {</p>
<p>​              assert testObject.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              testObject.add(“one”);</p>
<p>​              assert testObject.contains(“one”);</p>
<p>​       }</p>
<p>​       @Test void _remove() {</p>
<p>​              testObject.add(“one”);</p>
<p>​              testObject.remove(“one”);</p>
<p>​              assert testObject.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit LinkedListTest6”);</p>
<p>​       }</p>
<p>}</p>
<p>public class LinkedListTest7 extends LinkedList<string> {</string></p>
<p>​       @Test void initialization() {</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       @Test void _contains() {</p>
<p>​              this.add(“one”);</p>
<p>​              assert this.contains(“one”);</p>
<p>​       }</p>
<p>​       @Test void _remove() {</p>
<p>​              this.add(“one”);</p>
<p>​              this.remove(“one”);</p>
<p>​              assert this.isEmpty();</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit LinkedListTest7”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Ex8Test extends Ex8 {</p>
<p>​       @Test boolean _methodOneCall() { </p>
<p>​              return methodOneCall().equals(“methodOne”);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit Ex8Test”);</p>
<p>​       }</p>
<p>}</p>
<p>public class HashMapTest9 extends HashMap&lt;Integer,String&gt; {</p>
<p>​       @Test void _put() {</p>
<p>​              put(1, “Hi”);</p>
<p>​              assert get(1).equals(“Hi”);</p>
<p>​       }</p>
<p>​       @Test void _containsKey() {</p>
<p>​              put(2, “Bye”);</p>
<p>​              assert containsKey(2);</p>
<p>​       }</p>
<p>​       @Test void _containsValue() {</p>
<p>​              put(3, “yes”);</p>
<p>​              assert containsValue(“yes”);</p>
<p>​       }</p>
<p>​       @Test void _get() {</p>
<p>​              put(4, “hello”);</p>
<p>​              assert get(4).equals(“hello”);</p>
<p>​       }</p>
<p>​       @Test void _size() {</p>
<p>​              assert size() == 0;</p>
<p>​       }</p>
<p>​       @Test void _clear() {</p>
<p>​              put(5, “so long”);</p>
<p>​              clear();</p>
<p>​              assert size() == 0;</p>
<p>​       }             </p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit HashMapTest9”);</p>
<p>​       }</p>
<p>}</p>
<p>public class Element10 {</p>
<p>​       private String ident;</p>
<p>​       public Element10(String id) { ident = id; }</p>
<p>​       public String toString() { return ident; }</p>
<p>​       public int hashCode() { return ident.hashCode(); }</p>
<p>​       public boolean equals(Object r) {</p>
<p>​              return r instanceof Element10 &amp;&amp;</p>
<p>​                     ident.equals(((Element10)r).ident);</p>
<p>​       }</p>
<p>​       protected void finalize() {</p>
<p>​              System.out.println(“Finalizing “ + </p>
<p>​              getClass().getSimpleName() + “ “ + ident);</p>
<p>​       }</p>
<p>​       @TestObjectCreate static Element10 create() {</p>
<p>​              return new Element10(“hi”);</p>
<p>​       }</p>
<p>​       @Test void _hashCode() {</p>
<p>​              String s = “hi”;</p>
<p>​              assert hashCode() == s.hashCode(); </p>
<p>​       }</p>
<p>​       @Test void _equals() {</p>
<p>​              Element10 e = new Element10(“hi”);</p>
<p>​              assert this.equals(e);</p>
<p>​       }</p>
<p>​       public static void main(String[] args) throws Exception {</p>
<p>​              OSExecute.command(</p>
<p>​                     “java net.mindview.atunit.AtUnit Element10”);</p>
<p>​       }</p>
<p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Cluster-NodeJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Cluster-NodeJS/" itemprop="url">Cluster-NodeJS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h1><!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

<ul>
<li><a href="#cluster">Cluster</a><ul>
<li><a href="#worker对象">worker对象</a></li>
</ul>
</li>
</ul>
<!-- /code_chunk_output -->

<p>nodejs是单进程单线程，在多核机器上无法充分利用性能。nodejs引入cluster模块，可以提供多进程编程力能。</p>
<p><code>cluster</code>模块通过<code>cluster.fork()</code>方法创建多个进程实例，而<code>cluster.fork()</code>内部又是通过<code>child_process.fork()</code>来创建子进程的。</p>
<pre><code class="js">cluster.fork() --&gt; child_process.for()</code></pre>
<p>示例：</p>
<pre><code class="js">var cluster = require(&#39;cluster&#39;);
var cpuNums = require(&#39;os&#39;).cpus().length;
var http = require(&#39;http&#39;);

if(cluster.isMaster){
  for(var i = 0; i &lt; cpuNums; i++){
    cluster.fork();
  }
}else{
  http.createServer(function(req, res){
    res.end(&#39;ok&#39;);
  }).listen(3000);
}</code></pre>
<h2 id="worker对象"><a href="#worker对象" class="headerlink" title="worker对象"></a>worker对象</h2><p>worker对象是<code>cluster.fork()</code>的返回值，代表一个worker进程。</p>
<p>属性和方法如下:</p>
<ul>
<li>worker.id</li>
</ul>
<p>worker.id返回当前worker的独一无二的进程编号。这个编号也是<code>cluster.workers</code>中指向当前进程的索引值。</p>
<ul>
<li>worker.process</li>
</ul>
<p>所有的工作进程都是通过<code>child_process.fork()</code>来创建的，这个方法返回的对象被存储为<code>worker.process</code>。在工作进程中， process属于全局对象。</p>
<ul>
<li>worker.send(message[, sendHandle][, callback])</li>
</ul>
<p>发送一个消息给工作进程或主进程，也可以附带发送一个handle。</p>
<p><strong>主进程</strong>调用这个方法会发送消息给具体的<strong>工作进程</strong>。还有一个等价的方法是<code>ChildProcess.send()</code>。</p>
<p><strong>工作进程</strong>调用这个方法会发送消息给<strong>主进程</strong>。还有一个等价方法是<code>process.send()</code>。</p>
<pre><code class="js">const cluster = require(&#39;cluster&#39;);
const http = require(&#39;http&#39;);

if (cluster.isMaster) {
    console.log(&#39;Master&#39;);
    const worker = cluster.fork();
    worker.send(&#39;hi, 我是主进程。&#39;);
    cluster.on(&#39;message&#39;, function(worker, message, handle){
        console.log(&#39;cluster msg:&#39;, message);
    });
} else if (cluster.isWorker) {
    process.on(&#39;message&#39;, (msg) =&gt; {
        console.log(&#39;process msg:&#39;, msg);
        process.send(msg);
    });
    console.log(&#39;Worker&#39;);
    process.send(&#39;hi, 我是工作进程。&#39;);
}</code></pre>
<p>输出：</p>
<pre><code class="bash">Master
Worker
cluster msg: hi, 我是工作进程。
process msg: hi, 我是主进程。
cluster msg: hi, 我是主进程。</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Counting-Bits-[M]/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Counting-Bits-[M]/" itemprop="url">Counting Bits [M]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="338-Counting-Bits-M"><a href="#338-Counting-Bits-M" class="headerlink" title="338. Counting Bits [M]"></a>338. Counting Bits [M]</h2><hr>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p>Given a non negative integer number num. For every numbers i in the range 0 ≤ i ≤ num calculate the number of 1’s in their binary representation and return them as an array.</p>
<blockquote>
<p>Example:<br>For num = 5 you should return [0,1,1,2,1,2].</p>
</blockquote>
<p>Follow up:</p>
<ol>
<li>It is very easy to come up with a solution with run time O(n*sizeof(integer)). But can you do it in linear time O(n) /possibly in a single pass</li>
<li>Space complexity should be O(n).</li>
<li>Can you do it like a boss? Do it without using any builtin function like __builtin_popcount in c++ or in any other language.</li>
</ol>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>这是一个比较简单的动规题目，就是统计二进制数的1个个数，通过观察可以发现二进制数有很多规律在里面</p>
<table>
<thead>
<tr>
<th>十进制</th>
<th>二进制</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>11</td>
</tr>
<tr>
<td>4</td>
<td>100</td>
</tr>
<tr>
<td>8</td>
<td>1000</td>
</tr>
<tr>
<td>9</td>
<td>10001</td>
</tr>
</tbody></table>
<p>可以看见，当二进制位数多1位的时候，高位为1，剩下的和之前的是一样的。</p>
<blockquote>
<p>list[i] = list[i%n]+1  //n = floor(log(i))</p>
</blockquote>
<blockquote>
<p>list[2] = list[2%2]+1</p>
<p>list[5] = list[5%4]+1</p>
<p>list[12] =list[12%8]+1</p>
</blockquote>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code class="c++">class Solution {
public:
    vector&lt;int&gt; countBits(int num) {
        vector&lt;int&gt; ones(num+1,0);
        int base = 1;
        for(int i = 1; i &lt;= num; i++)
        {
            if(i &lt; base * 2)
                ones[i] = ones[i%base]+1;
            else{
                base *= 2;
                ones[i] = ones[i%base]+1;
            }
        }
        return ones;
    }
};</code></pre>
<h1 id="更巧妙的代码"><a href="#更巧妙的代码" class="headerlink" title="更巧妙的代码"></a>更巧妙的代码</h1><p>最高分代码：f[i] = f[i/2] + i%2</p>
<p>思想：和我的差不多，我是不看最高位，<font color="#ff2299">这个巧妙巧妙在不看最低位，直接右移1位</font>，这个数在数组中肯定已经存在了，然后加上移走那位是0还是1（i%2 或者 i &amp; 1）</p>
<p><strong>其实整体思想都是把新的二进制模式映射到之前出现的二进制模式上去。</strong></p>
<pre><code class="java">public int[] countBits(int num) {
    int[] f = new int[num + 1];
    for (int i=1; i&lt;=num; i++) f[i] = f[i &gt;&gt; 1] + (i &amp; 1);
    return f;
}</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zqfmcl</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">190</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zqfmcl</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>

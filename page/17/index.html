<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Fey's blog" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="Fey&#39;s blog">
<meta property="og:url" content="https://zqfmcl.github.io/dialy/page/17/index.html">
<meta property="og:site_name" content="Fey&#39;s blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fey&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zqfmcl.github.io/dialy/page/17/">





  <title>Fey's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fey's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-2-3树介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-2-3树介绍/" itemprop="url">2-3树介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本系列文章主要介绍常用的算法和数据结构的知识，记录的是《Algorithms I/II》课程的内容，采用的是“算法（第4版）”这本红宝书作为学习教材的，语言是java。这本书的名气我不用多说吧？豆瓣评分9.4，我自己也认为是极好的学习算法的书籍。 通过这系列文章，可以加深对数据结构和基本算法的理解（个人认为比学校讲的清晰多了），并加深对java的理解。</p>
</blockquote>
<hr>
<h1 id="2-3树介绍"><a href="#2-3树介绍" class="headerlink" title="2-3树介绍"></a>2-3树介绍</h1><blockquote>
<p>我们上回说到二叉查找树已经很接近我们的目标了，在很多情况下性能都很不错，但是唯独在删除上不行，一旦删除操作做多了就会失去平衡，那么，这回，我们来说说如何做一个平衡查找树，首先介绍一下2-3查找树</p>
</blockquote>
<p>2-3树是一种特殊的二叉树，它允许一个节点中出现2个key。</p>
<ul>
<li>2节点：1个key，2个孩子</li>
<li>3节点，2个key，3个孩子</li>
</ul>
<p><img src="http://img.hksite.cn/1464060026525" alt></p>
<p>它有几个特性：</p>
<ol>
<li>符合中序遍历的顺序：左孩小于最左key，中间孩子在左右key之间，右孩子大于最右key</li>
<li>绝对平衡：从根节点到所有null节点的路径一样长（我们后面会讲如何维护）</li>
</ol>
<h1 id="2-3树查找"><a href="#2-3树查找" class="headerlink" title="2-3树查找"></a>2-3树查找</h1><p>根据它的特性，我们可以很容易知道如何查找，和二叉树的查找差不多，只是多了一个节点。</p>
<ul>
<li>如果小于左孩子：go left</li>
<li>如果小于右孩子：go mid</li>
<li>如果大于右孩子：go right</li>
<li>如果等于key，返回value</li>
<li>如果为null，返回null</li>
</ul>
<p>看动画：</p>
<p><img src="http://img.hksite.cn/1464061120949" alt></p>
<h1 id="2-3树的插入"><a href="#2-3树的插入" class="headerlink" title="2-3树的插入"></a>2-3树的插入</h1><p>插入分几种情况：</p>
<ul>
<li>如果插入的节点是一个2-节点：直接把2节点变成3节点</li>
</ul>
<p><img src="http://img.hksite.cn/1464061523618" alt></p>
<ul>
<li>如果插入的是一个3-节点：<ul>
<li>把key加入3-节点变成一个临时4-节点</li>
<li>把4节点的中间key上移到父亲节点</li>
<li>重复操作。</li>
<li>如果到达了root，形成了一个临时4节点，则root节点分裂成3个节点，树高增加1层</li>
</ul>
</li>
</ul>
<p><img src="http://img.hksite.cn/1464061806411" alt></p>
<p><img src="http://img.hksite.cn/1464083473454" alt></p>
<p>看动画：</p>
<p><img src="http://img.hksite.cn/1464061420156" alt></p>
<h1 id="构造动画"><a href="#构造动画" class="headerlink" title="构造动画"></a>构造动画</h1><p>讲了这么多，我们就来看看如何构造一棵2-3树吧。</p>
<p><img src="http://img.hksite.cn/1464083893653" alt></p>
<h1 id="实现方案"><a href="#实现方案" class="headerlink" title="实现方案"></a>实现方案</h1><p>这里就先卖个关子，这里不写代码实现，大家先了解下，后面会用红黑树的方案实现2-3树</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Search-for-a-Range[M]/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Search-for-a-Range[M]/" itemprop="url">Search for a Range[M]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> Search for a Range[M]</p>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>Given a sorted array of integers, find the starting and ending position of a given target value.<br>Your algorithm’s runtime complexity must be in the order of O(log n).<br>If the target is not found in the array, return [-1, -1].</p>
<blockquote>
<p>For example,<br>Given [5, 7, 7, 8, 8, 10] and target value 8,<br>return [3, 4].</p>
</blockquote>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>题目里给了提示要求时间上必须是O(logN)，那么暗示了这要用二分去做。<br>范围搜索也就是要确定一个上确界，一个下确界。</p>
<p>分别都可以用二分去找。</p>
<h2 id="左边界"><a href="#左边界" class="headerlink" title="左边界"></a>左边界</h2><p>二分的话主要有以下几种情况，我们定义成3个基本规则：</p>
<blockquote>
<p>Rule 1. A[mid] &lt; target  ，这时候说明还可以向右，st = mid+1<br>Rule 2. A[mid] &gt; target ， 这时候说明应该在左边，ed = mid-1<br>Rule 3. A[mid] == target ，这时候既可以左移，也可以不移动，ed = mid</p>
</blockquote>
<p>因为作为二分，最后肯定是在2个数中选一个然后停止循环（while(st &lt; ed)）。<br>考虑下面几种情况，假设 target=5：（在两个数的情况下mid = st）</p>
<pre><code>case 1: [3 5] (A[st] = target &gt; A[ed])
case 2: [5 7] (A[st] = target &lt; A[ed])
case 3: [5 5] (A[st] = target = A[ed])
case 4: [3 7] (A[st] &lt; target &lt; A[ed])
case 5: [3 4] (A[st] &lt; A[ed] &lt; target)
case 6: [6 7] (target &lt; A[st] &lt; A[ed])</code></pre><p>情况3就是Rule1的情况，<code>st = mid + 1</code>就行。<br>对于情况2-3这时候，我们只要 <code>ed = mid</code>就行了，其实也就是把Rule 2 和Rule 3合并成了</p>
<blockquote>
<p>Rule 2*. A[mid] &gt;= target， ed = mid</p>
</blockquote>
<p>所以case 1-3 最后停止条件都是A[st] = A[ed] = target</p>
<p>对于case 4-6 都是A[st] != target，可以直接退出</p>
<h2 id="右边界"><a href="#右边界" class="headerlink" title="右边界"></a>右边界</h2><p>找到了左边的边界后就好办了，右边的边界只用同理操作就行了。<br>而且因为找到了左边的边界，实际上就不存在比target小的数了。</p>
<p>这里，我们让mid偏向右边</p>
<pre><code>mid = (st + ed)/2 + 1; </code></pre><p>然后主要控制ed移动就可以了。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code class="java">public class Solution {
    public int[] searchRange(int[] nums, int target) {
        int [] result = new int [2];
        result[0] = result[1] = -1;
        if(nums.length == 0)
            return result;

        int st = 0, ed = nums.length-1,mid;
        while(st &lt; ed) {
            // 寻找左边界
            mid = (st + ed) / 2;
            if (nums[mid] &lt; target)  //保证st不会越过任何等于target的数
            {
                st = mid+1;  //如果当前的数小于我们需要查的数，继续逼近
            } else {       //如果大于等于
                ed = mid;
            }
        }
        if(nums[st] != target)
            return result;
        result[0] = st;
        // 寻找右边界
        ed = nums.length-1;
        while(st &lt; ed)
        {
            mid = (st + ed)/2 + 1; //这里用+1是为了让mid偏向右边
            if(nums[mid] &gt; target)
            {
                ed = mid-1;
            }
            else{   //因为st已经确定了，所以这里实际上不会出现比target小的数了，这里实际就是A[mid] == target
                st = mid;
            }
        }
        result[1] = ed;
        return result;
    }
}</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Set/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Set/" itemprop="url">Set</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

<ul>
<li><a href="#set">Set</a><ul>
<li><a href="#set实例的属性和方法">Set实例的属性和方法</a></li>
</ul>
</li>
<li><a href="#map">Map</a><ul>
<li><a href="#实例的属性和操作方法">实例的属性和操作方法</a></li>
<li><a href="#遍历方法">遍历方法</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h1><p>ES6 提供了新的数据结构 Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。</p>
<p>Set 本身是一个构造函数，用来生成 Set 数据结构。</p>
<pre><code class="js">const s = new Set();

[2, 3, 5, 4, 5, 2, 2].forEach(x =&gt; s.add(x));
//add方法向 Set 结构加入成员

for (let i of s) {
  console.log(i);
}
// 2 3 5 4</code></pre>
<p>想Set数据结构中加入值时，不会发生类型转换，但<code>NaN</code>等于自身。<br>但是相同的对象，会被当成两个不一样的值。</p>
<pre><code class="js">let set = new Set();

set.add({a:12});
set.size
//1

set.add({a:12});
set.size
//2</code></pre>
<h2 id="Set实例的属性和方法"><a href="#Set实例的属性和方法" class="headerlink" title="Set实例的属性和方法"></a>Set实例的属性和方法</h2><p>Set结构的实例有以下属性。</p>
<ul>
<li>Set.prototype.constructor：构造函数，默认就是Set函数。</li>
<li>Set.prototype.size：返回Set实例的成员总数。</li>
</ul>
<p>Set实例的方法分为两大类：操作方法（用于操作数据）和遍历方法（用于遍历成员）。下面先介绍四个操作方法。</p>
<ul>
<li>add(value)：添加某个值，返回Set结构本身。</li>
<li>delete(value)：删除某个值，返回一个布尔值，表示删除是否成功。</li>
<li>has(value)：返回一个布尔值，表示该值是否为Set的成员。</li>
</ul>
<pre><code class="js">if (properties.has(someName)) {
  // do something
}</code></pre>
<ul>
<li>clear()：清除所有成员，没有返回值。</li>
</ul>
<p><code>Array.from</code>方法可以将Set结构转为数组。</p>
<pre><code class="js">var items = new Set([1, 2, 3, 4, 5]);
var array = Array.from(items);</code></pre>
<p>Set结构的实例有四个遍历方法，可以用于遍历成员。</p>
<ul>
<li>keys()：返回键名的遍历器</li>
<li>values()：返回键值的遍历器</li>
<li>entries()：返回键值对的遍历器</li>
<li>forEach()：使用回调函数遍历每个成员</li>
</ul>
<h1 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h1><p>ES6提供了Map数据结构，它类似于对象，也是键值对的集合，但是“<strong>键</strong>”的范围不限于字符串，各种类型的值（包括对象）都可以当作键。</p>
<pre><code class="js">var m = new Map();
var o = {p: &#39;Hello World&#39;};

m.set(o, &#39;content&#39;)
m.get(o) // &quot;content&quot;

m.has(o) // true
m.delete(o) // true
m.has(o) // false</code></pre>
<pre><code class="js">var map = new Map();

var k1 = [&#39;a&#39;];
var k2 = [&#39;a&#39;];

map
.set(k1, 111)
.set(k2, 222);

map.get(k1) // 111
map.get(k2) // 222</code></pre>
<p>Map的键实际上是跟内存地址绑定的，只要内存地址不一样，就视为两个键。<br>如果Map的键是一个简单类型的值（数字、字符串、布尔值），则只要两个值严格相等，Map将其视为一个键，包括<code>0</code>和<code>-0</code>，<code>NaN</code>与<code>NaN</code>。</p>
<h2 id="实例的属性和操作方法"><a href="#实例的属性和操作方法" class="headerlink" title="实例的属性和操作方法"></a>实例的属性和操作方法</h2><ul>
<li>size()</li>
</ul>
<p><code>size</code>属性返回Map结构的成员总数。</p>
<ul>
<li>set(key, value)</li>
</ul>
<p><code>set</code>方法设置key所对应的键值，然后返回整个Map结构。</p>
<ul>
<li>get(key)</li>
</ul>
<p><code>get</code>方法读取key对应的键值，如果找不到key，返回undefined。</p>
<ul>
<li><p>has</p>
<p><code>has</code>方法返回一个布尔值，表示某个键是否在Map数据结构中。</p>
</li>
<li><p>delete(key)</p>
</li>
</ul>
<p><code>delete</code>方法删除某个键，返回true。如果删除失败，返回false。</p>
<ul>
<li>clear()</li>
</ul>
<p><code>clear</code>方法清除所有成员，没有返回值。</p>
<h2 id="遍历方法"><a href="#遍历方法" class="headerlink" title="遍历方法"></a>遍历方法</h2><p>Map原生提供三个遍历器生成函数和一个遍历方法。</p>
<ul>
<li>keys()：返回键名的遍历器。</li>
<li>values()：返回键值的遍历器。</li>
<li>entries()：返回所有成员的遍历器。</li>
<li>forEach()：遍历Map的所有成员。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Stream-NodeJs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Stream-NodeJs/" itemprop="url">Stream-NodeJs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
<!-- code_chunk_output -->

<ul>
<li><a href="#stream">Stream</a><ul>
<li><a href="#简介">简介</a></li>
<li><a href="#从流中读取">从流中读取</a></li>
<li><a href="#写入流">写入流</a><ul>
<li><a href="#cork与uncork">cork()与uncork()</a></li>
</ul>
</li>
<li><a href="#管道流">管道流</a><ul>
<li><a href="#unpipe">unpipe()</a></li>
</ul>
</li>
<li><a href="#链式流">链式流</a></li>
</ul>
</li>
</ul>
<!-- /code_chunk_output -->

<h1 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Stream 有四种流类型：</p>
<ul>
<li>Readable - 可读操作。</li>
<li>Writable - 可写操作。</li>
<li>Duplex - 可读可写操作.</li>
<li>Transform - 操作被写入数据，然后读出结果。</li>
</ul>
<p>所有的 Stream 对象都是 EventEmitter 的实例。常用的事件有：</p>
<ul>
<li>data - 当有数据可读时触发。</li>
<li>end - 没有更多的数据可读时触发。</li>
<li>error - 在接收和写入过程中发生错误时触发。</li>
<li>finish - 所有数据已被写入到底层系统时触发。</li>
</ul>
<h2 id="从流中读取"><a href="#从流中读取" class="headerlink" title="从流中读取"></a>从流中读取</h2><pre><code class="js">var fs = require(&quot;fs&quot;);
var data = &#39;&#39;;

// 创建可读流
var readerStream = fs.createReadStream(&#39;input.txt&#39;);

// 设置编码为 utf8。
readerStream.setEncoding(&#39;UTF8&#39;);

// 处理流事件 --&gt; data, end, and error
readerStream.on(&#39;data&#39;, function(chunk) {
   data += chunk;
});

readerStream.on(&#39;error&#39;, function(err){
   console.log(err.stack);
});

//&#39;readable&#39; 事件将在流中有数据可供读取时触发
//当到达流数据尾部时， &#39;readable&#39; 事件也会触发。触发顺序在 &#39;end&#39; 事件之前。
readerStream.on(&#39;readable&#39;, () =&gt; {
  // 有一些数据可读了
});

readerStream.on(&#39;end&#39;,function(){
    console.log(data);
});

console.log(&quot;程序执行完毕&quot;);</code></pre>
<h3 id="readable-pause-与readable-resume"><a href="#readable-pause-与readable-resume" class="headerlink" title="readable.pause()与readable.resume()"></a>readable.pause()与readable.resume()</h3><p><strong>readable.pause()</strong>:暂停读取流操作</p>
<p><strong>readable.resume()</strong>:继续读取流操作</p>
<pre><code class="js">// 新建一个readable数据流
var readable = getReadableStreamSomehow();
readable.on(&#39;data&#39;, function(chunk) {
  console.log(&#39;读取%d字节的数据&#39;, chunk.length);
  readable.pause();
  console.log(&#39;接下来的1秒内不读取数据&#39;);

  setTimeout(function() {
    console.log(&#39;数据恢复读取&#39;);
    readable.resume();
  }, 1000);
});</code></pre>
<h2 id="写入流"><a href="#写入流" class="headerlink" title="写入流"></a>写入流</h2><p>可用概念：</p>
<ul>
<li><code>objectMode</code> 默认是 false， 设置成 true 后 writable.write() 方法除了写入 string 和 buffer 外，还可以写入任意 JavaScript 对象。很有用的一个选项，后面介绍 transform 流的时候详细介绍</li>
<li><code>highWaterMark</code> 每次最多写入的数据量， Buffer 的时候默认值 16kb， objectMode 时默认值 16</li>
<li><code>decodeStrings</code> 是否把传入的数据转成 Buffer，默认是 true</li>
</ul>
<pre><code class="js">var fs = require(&quot;fs&quot;);
var data = &#39;hello world&#39;;

// 创建一个可以写入的流，写入到文件 output.txt 中
var writerStream = fs.createWriteStream(&#39;output.txt&#39;);

// 使用 utf8 编码写入数据
writerStream.write(data,&#39;UTF8&#39;);

// 标记文件末尾
// 如有callback，在finish前调用
writerStream.end(&#39;&#39;,function(){});

// 处理流事件 --&gt; data, end, and error
writerStream.on(&#39;finish&#39;, function() {
    console.log(&quot;写入完成。&quot;);
});

writerStream.on(&#39;error&#39;, function(err){
   console.log(err.stack);
});

console.log(&quot;程序执行完毕&quot;);</code></pre>
<h3 id="cork-与uncork"><a href="#cork-与uncork" class="headerlink" title="cork()与uncork()"></a>cork()与uncork()</h3><p>调用<code>writable.cork()</code>，写入的数据将会被存放在内存的缓冲区里，只要再调用<code>writable.uncork()</code>跟<code>writable.end()</code>,被缓冲的数据才会被输出。</p>
<h2 id="管道流"><a href="#管道流" class="headerlink" title="管道流"></a>管道流</h2><pre><code class="js">// 创建一个可读流
// new stream.Readable([options])
var readerStream = fs.createReadStream(&#39;input.txt&#39;);

// 创建一个可写流
var writerStream = fs.createWriteStream(&#39;output.txt&#39;);

// 当writerStream.write()返回false时，便会在合适的时机触发drain事件。
writerStream.on(&#39;drain&#39;,function(){
    readerStream.resume(); // 数据已经写完，继续读取
    console.log(&#39;drain&#39;);
});
// 管道读写操作

readerStream.on(&#39;data&#39;, function(chunk){
  if(writerStream.write(chunk) === false){ // 尚未写完，停止读取
    readerStream.pause();
  }
});
// 读取 input.txt 文件内容，并将内容写入到 output.txt 文件中
readerStream.pipe(writerStream);</code></pre>
<p><strong>pipe 的过程:</strong></p>
<ol>
<li>首先执行 <code>readbable.pipe(writable)</code>，将 readable 与 writable 对接上</li>
<li>当 readable 中有数据时，<code>readable.emit(&#39;data&#39;)</code>，将数据写入 writable</li>
<li>如果 <code>writable.write(chunk)</code> 返回 false，则进入 pause 模式，等待 drain 事件触发</li>
<li>drain 事件全部触发后，再次进入 flow 模式，写入数据</li>
<li>不管数据写入完成或发生中断，最后都会调用 <code>unpipe()</code></li>
<li><code>unpipe()</code> 调用 <code>Readable.prototype.unpipe()</code>，触发 dest 的 unpipe 事件，清理相关数据</li>
</ol>
<h3 id="unpipe"><a href="#unpipe" class="headerlink" title="unpipe()"></a>unpipe()</h3><p>该方法移除pipe方法指定的数据流目的地，目的地数据会被清空。</p>
<pre><code class="js">readable.pipe(writable);
setTimeout(function() {
    console.log(&#39;停止写入file.txt&#39;);
    readable.unpipe(writable);
    console.log(&#39;手动关闭file.txt的写入数据流&#39;);
    writable.end();
}, 1000);

readable.on(&#39;unpipe&#39;, function(src) {
    //do ...
});</code></pre>
<h2 id="链式流"><a href="#链式流" class="headerlink" title="链式流"></a>链式流</h2><pre><code class="js">// 压缩 input.txt 文件为 input.txt.gz
fs.createReadStream(&#39;input.txt&#39;)
  .pipe(zlib.createGzip())
  .pipe(fs.createWriteStream(&#39;input.txt.gz&#39;));


// 解压 input.txt.gz 文件为 input.txt
fs.createReadStream(&#39;input.txt.gz&#39;)
  .pipe(zlib.createGunzip())
  .pipe(fs.createWriteStream(&#39;input.txt&#39;));</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-String-to-Integer-(atoi)-[E]/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-String-to-Integer-(atoi)-[E]/" itemprop="url">String to Integer (atoi) [E]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="008-String-to-Integer-atoi-E"><a href="#008-String-to-Integer-atoi-E" class="headerlink" title="008. String to Integer (atoi) [E]"></a>008. String to Integer (atoi) [E]</h1><hr>
<p>[TOC]</p>
<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a><strong>题目</strong></h2><p>Implement atoi to convert a string to an integer.</p>
<p>Hint: Carefully consider all possible input cases. If you want a challenge, please do not see below and ask yourself what are the possible input cases.</p>
<p>Notes: It is intended for this problem to be specified vaguely (ie, no given input specs). You are responsible to gather all the input requirements up front.</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a><strong>思路</strong></h2><p>这题也比较好做，关键是要考虑挺多东西，我也是提交了好多次才发现有这么多要考虑的地方。</p>
<ul>
<li>开头的空格</li>
<li>正负符号的处理</li>
<li>溢出处理</li>
<li>非法输入</li>
</ul>
<p>开头空格处理：</p>
<pre><code>while(str[i] == &quot; &quot;) i++;</code></pre><p>正负号的处理：我觉得yuruofeifei这个解决方案简直赞</p>
<pre><code>if (str[i] == &#39;-&#39; || str[i] == &#39;+&#39;) {
      sign = 1 - 2 * (str[i++] == &#39;-&#39;); 
 }
 ……
 return base * sign;</code></pre><p>溢出处理（可以参考上一道题）：</p>
<pre><code>if (base &gt;  INT_MAX / 10 || (base == INT_MAX / 10 &amp;&amp; str[i] - &#39;0&#39; &gt; INT_MAX%10)) {
            if (sign == 1) return INT_MAX;
            else return INT_MIN;
        }</code></pre><p>非法输入：其实只用过滤就行了</p>
<pre><code> while (str[i] &gt;= &#39;0&#39; &amp;&amp; str[i] &lt;= &#39;9&#39;) {
 ……
 }</code></pre><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a><strong>代码</strong></h2><p>我的代码，不够简洁，可以参考yuruofeifei的代码，在下面</p>
<pre><code class="c++">class Solution {
public:
    int myAtoi(string str) {
        long tmp=0;
        bool neg;
        int i = 0;
        while(str[i] == &#39; &#39;) i++; //读掉空格
        neg = str[i] == &#39;-&#39;?1:0;
        for(i = i+ (neg || str[i] == &#39;+&#39;);i &lt; str.length();i++)  //如果是- 或 + i+1跳过符号
        {
            if(str[i] - &#39;0&#39; &gt;= 0 &amp;&amp; str[i] - &#39;0&#39; &lt; 10)   //过滤非法输入
            {
               tmp *= 10;
               tmp += (str[i] - &#39;0&#39;); 
               if(tmp &gt;= INT_MAX &amp;&amp; !neg)    //溢出判断
               {
                   tmp =  INT_MAX;
                   break;
               }
               if(tmp -1  &gt;= INT_MAX &amp;&amp; neg)  //除了符号，INT_MAX和INT_MIN只差1
               {
                   tmp = INT_MIN;
                   break;
               }
            }
            else break;
        }
        if(neg) return -tmp;
        return tmp;
    }
};</code></pre>
<p>yuruofeifei的代码</p>
<pre><code class="c++">int myAtoi(string str) {
    int sign = 1, base = 0, i = 0;
    while (str[i] == &#39; &#39;) { i++; }
    if (str[i] == &#39;-&#39; || str[i] == &#39;+&#39;) {
        sign = 1 - 2 * (str[i++] == &#39;-&#39;); 
    }
    while (str[i] &gt;= &#39;0&#39; &amp;&amp; str[i] &lt;= &#39;9&#39;) {
        if (base &gt;  INT_MAX / 10 || (base == INT_MAX / 10 &amp;&amp; str[i] - &#39;0&#39; &gt; 7)) {
            if (sign == 1) return INT_MAX;
            else return INT_MIN;
        }
        base  = 10 * base + (str[i++] - &#39;0&#39;);
    }
    return base * sign;
}</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zqfmcl.github.io/dialy/2019/10/04/2019-10-04-Symbol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zqfmcl">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fey's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/04/2019-10-04-Symbol/" itemprop="url">Symbol</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-04T10:00:00+08:00">
                2019-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- toc orderedList:0 depthFrom:1 depthTo:6 -->

<ul>
<li><a href="#symbol">Symbol</a><ul>
<li><a href="#概述">概述</a></li>
<li><a href="#作为属性名的symbol">作为属性名的Symbol</a></li>
<li><a href="#属性名遍历">属性名遍历</a></li>
<li><a href="#symbolforsymbolkeyfor">Symbol.for()，Symbol.keyFor()</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h1 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>ES6引入了一种新的原始数据类型<code>Symbol</code>，表示独一无二的值。</p>
<p><strong>Symbol</strong> 值通过<code>Symbol</code>函数生成，可以加上参数，表示对实例的描述。</p>
<pre><code class="js">let s = Symbol();
let s1 = Symbol(&#39;foo&#39;);

console.log(s);
console.log(s1);
//Symbol()
//Symbol(ew)

typeof s
typeof s1
// &quot;symbol&quot;
// &quot;symbol&quot;</code></pre>
<p><code>Symbol</code>函数不能使用<code>new</code>命令，这是一种数据类型，不是对象。</p>
<p>如果<code>Symbol</code>参数是一个对象，就会调用<code>toString</code>方法。</p>
<pre><code class="js">let obj1={a:&#39;aa&#39;}
let obj2={a:&#39;aa&#39;,toString:function(){console.log(&quot;hei&quot;)}}

let sym=Symbol(obj);
let sym1=Symbol(obj1);

//hei</code></pre>
<p><code>Symbol</code>不能与其他数据类型运行，可以转换成字符串以及布尔值。</p>
<pre><code class="js">var sym = Symbol(&#39;My symbol&#39;);

String(sym) // &#39;Symbol(My symbol)&#39;
sym.toString() // &#39;Symbol(My symbol)&#39;
Boolean(sym) //true</code></pre>
<h2 id="作为属性名的Symbol"><a href="#作为属性名的Symbol" class="headerlink" title="作为属性名的Symbol"></a>作为属性名的Symbol</h2><p>每个Symbol值都是不相等的，作为对象属性名不会给覆盖，但不能用点运算。</p>
<pre><code class="js">var mySymbol = Symbol();
var a = {};

a.mySymbol = &#39;Hello!&#39;;
a[mySymbol] // undefined
a[&#39;mySymbol&#39;] // &quot;Hello!&quot;</code></pre>
<h2 id="属性名遍历"><a href="#属性名遍历" class="headerlink" title="属性名遍历"></a>属性名遍历</h2><p>对象的<code>Symbol</code>属性只能通过<code>Object.getOwnPropertySymbols</code>方法获得。</p>
<pre><code class="js">var obj = {};
var a = Symbol(&#39;a&#39;);
var b = Symbol(&#39;b&#39;);

obj[a] = &#39;Hello&#39;;
obj[b] = &#39;World&#39;;

var objectSymbols = Object.getOwnPropertySymbols(obj);

objectSymbols
// [Symbol(a), Symbol(b)]</code></pre>
<p>一个新的API，<code>Reflect.ownKeys</code>方法可以返回所有类型的键名，包括常规键名和 Symbol 键名。</p>
<pre><code class="js">let obj = {
  [Symbol(&#39;my_key&#39;)]: 1,
  enum: 2,
  nonEnum: 3
};

Reflect.ownKeys(obj)
//  [&quot;enum&quot;, &quot;nonEnum&quot;, Symbol(my_key)]</code></pre>
<h2 id="Symbol-for-，Symbol-keyFor"><a href="#Symbol-for-，Symbol-keyFor" class="headerlink" title="Symbol.for()，Symbol.keyFor()"></a>Symbol.for()，Symbol.keyFor()</h2><p><code>Symbol.for()</code>方法会搜索有没有这个参数作为名称的<code>Symbol</code>值，有就返回，没有就新建。</p>
<pre><code class="js">var s1 = Symbol.for(&#39;foo&#39;);
var s2 = Symbol.for(&#39;foo&#39;);

s1 === s2 // true
s1
//Symbol(foo)
s2
//Symbol(foo)</code></pre>
<p><code>Symbol.keyFor</code>方法返回一个已登记的 <code>Symbol</code> 类型值的<code>key</code>。</p>
<pre><code class="js">var s1 = Symbol.for(&quot;foo&quot;);
Symbol.keyFor(s1) // &quot;foo&quot;
</code></pre>
<blockquote>
<p>参考：<a href="http://es6.ruanyifeng.com/#docs/symbol" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/symbol</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/16/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/18/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zqfmcl</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">193</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zqfmcl</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
